{
  "parentEntity": "RiverArea",
  "relationships": [
    {
      "relatedEntity": "RiverAreaSegment",
      "relationshipType": "OneToMany",
      "parentProperty": "RiverAreaSegments",
      "childProperty": "RiverArea",
      "foreignKey": "RiverAreaID",
      "cascadeDelete": true,
      "gridName": "grdList",
      "gridColumns": [
        {
          "key": "River",
          "header": "River",
          "type": "String",
          "width": 50,
          "alignment": "Left"
        },
        {
          "key": "StartMile",
          "header": "Start Mile",
          "type": "Decimal",
          "width": 55,
          "alignment": "Right"
        },
        {
          "key": "EndMile",
          "header": "End Mile",
          "type": "Decimal",
          "width": 55,
          "alignment": "Right"
        }
      ],
      "operations": {
        "add": "ItemAdd",
        "edit": "ItemModify",
        "delete": "ItemRemove"
      },
      "notes": "River segments define the geographic boundaries of a river area using start and end mile markers on specific rivers."
    }
  ],
  "lookupRelationships": [
    {
      "property": "CustomerID",
      "lookupEntity": "Customer",
      "displayProperty": "CustomerName",
      "required": false,
      "conditionallyRequired": true,
      "requiredWhen": "IsHighWaterArea = true",
      "listSource": "Lists.CustomerList.GetList",
      "notes": "High water customer is only applicable when IsHighWaterArea is checked. Field is conditionally enabled based on IsHighWaterArea or IsFuelTaxArea flags."
    }
  ],
  "serviceLayerPattern": {
    "note": "Modern implementation uses Dapper with repository pattern - child collections are NOT loaded as entity properties but retrieved via separate repository methods",
    "entityDefinition": "RiverArea entity class contains scalar properties only (no collection properties for child entities)",
    "repositoryMethods": [
      "Task<RiverArea> GetByIdAsync(int id)",
      "Task<IEnumerable<RiverAreaSegment>> GetSegmentsAsync(int riverAreaId)"
    ],
    "serviceLayerComposition": "Service layer composes parent and child data by calling multiple repository methods and combining results into DTOs"
  },
  "businessRules": [
    {
      "rule": "Mutually exclusive area types",
      "description": "Only one of IsPriceZone, IsPortalArea, or IsHighWaterArea may be checked at a time",
      "affectedProperties": ["IsPriceZone", "IsPortalArea", "IsHighWaterArea"]
    },
    {
      "rule": "CustomerID conditional requirement",
      "description": "CustomerID must be blank if IsHighWaterArea is not checked",
      "affectedProperties": ["CustomerID", "IsHighWaterArea"]
    },
    {
      "rule": "Overlapping pricing zones validation",
      "description": "If IsPriceZone is true, validates that river segments do not overlap with other pricing zones on the same river",
      "affectedProperties": ["IsPriceZone", "RiverAreaSegments"]
    },
    {
      "rule": "River segment mile range validation",
      "description": "Start and end miles for each segment must be within the valid mile range for the selected river",
      "childEntity": "RiverAreaSegment"
    },
    {
      "rule": "Start mile less than end mile",
      "description": "Start mile must be less than or equal to end mile for each segment",
      "childEntity": "RiverAreaSegment"
    }
  ],
  "cacheInvalidation": [
    "Lists.RiverAreaList.GetList.MarkCacheDirty()",
    "Lists.RiverAreaSegmentList.GetList.MarkCacheDirty()"
  ],
  "securityContext": {
    "functionalArea": "General",
    "formAccess": "frmRiverAreaSearch",
    "detailForm": "frmRiverAreaDetail"
  },
  "extractionMetadata": {
    "sourceFiles": [
      "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore.BusinessLogic/Business Objects/RiverArea.vb",
      "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore.BusinessLogic/Business Objects/Base Classes/RiverAreaBase.vb",
      "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore.BusinessLogic/Business Objects/RiverAreaSegment.vb",
      "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore.BusinessLogic/Business Objects/Base Classes/RiverAreaSegmentBase.vb",
      "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore/Forms/frmRiverAreaDetail.vb",
      "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore/Forms/frmRiverAreaDetail.Designer.vb"
    ],
    "extractionDate": "2025-12-17",
    "analyzer": "Related Entity Analyzer"
  }
}
