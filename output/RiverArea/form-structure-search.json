{
  "formName": "frmRiverAreaSearch",
  "formTitle": "River Areas",
  "formType": "Search",
  "inherits": "frmBaseSearch",
  "implements": ["IBaseSearch"],
  "uniqueIdentifier": "RiverAreaID",
  "subsystem": "frmRiverAreaSearch",
  "controls": [
    {
      "name": "txtName",
      "type": "UltraTextEditor",
      "category": "SearchCriteria",
      "label": "River area name",
      "labelControl": "lblName",
      "dataBinding": null,
      "tabIndex": 1,
      "location": { "x": 120, "y": 6 },
      "size": { "width": 169, "height": 21 },
      "defaultValue": "",
      "validation": [],
      "events": [],
      "modernEquivalent": {
        "type": "text",
        "class": "form-control",
        "placeholder": "Enter river area name"
      },
      "businessLogic": "Used in search filter: txtName.Text.Trim passed to RiverAreaSearch.GetList"
    },
    {
      "name": "cboCustomerID",
      "type": "UltraCombo",
      "category": "SearchCriteria",
      "label": "High water customer",
      "labelControl": "lblCustomerID",
      "dataBinding": null,
      "tabIndex": 6,
      "location": { "x": 120, "y": 32 },
      "size": { "width": 169, "height": 22 },
      "defaultValue": "",
      "populationMethod": "Main.PopulateListCombo(Lists.CustomerList.GetList, cboCustomerID, True, False)",
      "dataSource": "Lists.CustomerList",
      "valueField": "CustomerID",
      "displayField": "CustomerName",
      "includeBlank": true,
      "validation": [],
      "events": [],
      "visibility": {
        "condition": "Lists.GlobalSettingList.EnableRiverSegmentHighWaterModel",
        "default": "Hidden"
      },
      "modernEquivalent": {
        "type": "select",
        "class": "form-select",
        "plugin": "Select2",
        "allowClear": true
      },
      "businessLogic": "Filters by high water customer when EnableRiverSegmentHighWaterModel is enabled"
    },
    {
      "name": "chkPricingZonesOnly",
      "type": "UltraCheckEditor",
      "category": "SearchCriteria",
      "label": "Pricing zones only",
      "dataBinding": null,
      "tabIndex": 2,
      "location": { "x": 311, "y": 6 },
      "size": { "width": 120, "height": 20 },
      "defaultValue": false,
      "validation": [],
      "events": [],
      "modernEquivalent": {
        "type": "checkbox",
        "class": "form-check-input"
      },
      "businessLogic": "Filter parameter: chkPricingZonesOnly.Checked passed to RiverAreaSearch.GetList"
    },
    {
      "name": "chkActiveOnly",
      "type": "UltraCheckEditor",
      "category": "SearchCriteria",
      "label": "Active only",
      "dataBinding": null,
      "tabIndex": 3,
      "location": { "x": 444, "y": 6 },
      "size": { "width": 92, "height": 20 },
      "defaultValue": true,
      "checked": true,
      "validation": [],
      "events": [],
      "modernEquivalent": {
        "type": "checkbox",
        "class": "form-check-input"
      },
      "businessLogic": "Filter parameter: chkActiveOnly.Checked passed to RiverAreaSearch.GetList"
    },
    {
      "name": "chkPortalAreasOnly",
      "type": "UltraCheckEditor",
      "category": "SearchCriteria",
      "label": "Portal areas only",
      "dataBinding": null,
      "tabIndex": 4,
      "location": { "x": 542, "y": 6 },
      "size": { "width": 120, "height": 20 },
      "defaultValue": false,
      "validation": [],
      "events": [],
      "visibility": {
        "condition": "LicenseList(Licenses.LicenseComponent.Portal).Active",
        "default": "Hidden"
      },
      "modernEquivalent": {
        "type": "checkbox",
        "class": "form-check-input"
      },
      "businessLogic": "Filter parameter: chkPortalAreasOnly.Checked passed to RiverAreaSearch.GetList. Visible only if Portal license is active."
    },
    {
      "name": "chkHighWaterAreasOnly",
      "type": "UltraCheckEditor",
      "category": "SearchCriteria",
      "label": "High water areas only",
      "dataBinding": null,
      "tabIndex": 7,
      "location": { "x": 311, "y": 32 },
      "size": { "width": 139, "height": 20 },
      "defaultValue": false,
      "validation": [],
      "events": [],
      "visibility": {
        "condition": "Lists.GlobalSettingList.EnableRiverSegmentHighWaterModel",
        "default": "Hidden"
      },
      "modernEquivalent": {
        "type": "checkbox",
        "class": "form-check-input"
      },
      "businessLogic": "Filter parameter: chkHighWaterAreasOnly.Checked passed to RiverAreaSearch.GetList"
    }
  ],
  "grids": [
    {
      "name": "grdSearch",
      "type": "UltraGrid",
      "uniqueIdentifier": "RiverAreaID",
      "tabIndex": 64,
      "location": { "x": 0, "y": 82 },
      "size": { "width": 779, "height": 380 },
      "dock": "Fill",
      "defaultSort": {
        "column": "Name",
        "direction": "Ascending"
      },
      "dataSource": "BusinessLogic.Lists.RiverAreaSearch.GetList(...).List",
      "columns": [
        {
          "key": "RiverAreaID",
          "header": "RiverAreaID",
          "dataType": "Integer",
          "width": 0,
          "visible": false,
          "sortable": false,
          "filterable": false,
          "purpose": "Unique identifier (hidden)"
        },
        {
          "key": "Name",
          "header": "River Area",
          "dataType": "String",
          "width": 300,
          "alignment": "Left",
          "sortable": true,
          "filterable": true,
          "defaultSort": "Ascending"
        },
        {
          "key": "IsPriceZone",
          "header": "Pricing Zone",
          "dataType": "Boolean",
          "width": 95,
          "alignment": "Center",
          "sortable": true,
          "filterable": true,
          "displayFormat": "Checkbox or Yes/No"
        },
        {
          "key": "IsActive",
          "header": "Active",
          "dataType": "Boolean",
          "width": 50,
          "alignment": "Center",
          "sortable": true,
          "filterable": true,
          "displayFormat": "Checkbox or Yes/No"
        },
        {
          "key": "IsPortalArea",
          "header": "Portal Area",
          "dataType": "Boolean",
          "width": 95,
          "alignment": "Center",
          "sortable": true,
          "filterable": true,
          "displayFormat": "Checkbox or Yes/No",
          "visibility": {
            "condition": "LicenseList(Licenses.LicenseComponent.Portal).Active",
            "default": "Hidden"
          }
        },
        {
          "key": "IsHighWaterArea",
          "header": "High Water Area",
          "dataType": "Boolean",
          "width": 95,
          "alignment": "Center",
          "sortable": true,
          "filterable": true,
          "displayFormat": "Checkbox or Yes/No",
          "visibility": {
            "condition": "Lists.GlobalSettingList.EnableRiverSegmentHighWaterModel",
            "default": "Hidden"
          }
        },
        {
          "key": "CustomerName",
          "header": "High Water Customer",
          "dataType": "String",
          "width": 200,
          "alignment": "Left",
          "sortable": true,
          "filterable": true,
          "visibility": {
            "condition": "Lists.GlobalSettingList.EnableRiverSegmentHighWaterModel",
            "default": "Hidden"
          }
        },
        {
          "key": "IsFuelTaxArea",
          "header": "Fuel Tax Area",
          "dataType": "Boolean",
          "width": 95,
          "alignment": "Center",
          "sortable": true,
          "filterable": true,
          "displayFormat": "Checkbox or Yes/No"
        },
        {
          "key": "IsLiquidRateArea",
          "header": "Liquid Rate Area",
          "dataType": "Boolean",
          "width": 95,
          "alignment": "Center",
          "sortable": true,
          "filterable": true,
          "displayFormat": "Checkbox or Yes/No",
          "visibility": {
            "condition": "LicenseList(BusinessLogic.Licenses.LicenseComponent.UnitTow).Active",
            "default": "Hidden"
          }
        }
      ],
      "events": [
        {
          "event": "DoubleClick",
          "handler": "Opens detail form via ItemModify()",
          "implementation": "Base search form handles double-click to open frmRiverAreaDetail"
        },
        {
          "event": "AfterSelectChange",
          "handler": "Base form selection tracking",
          "implementation": "Updates selected row state, enables/disables action buttons"
        }
      ],
      "modernEquivalent": {
        "type": "DataTable",
        "serverSide": true,
        "ajax": {
          "url": "/RiverArea/Search",
          "type": "POST",
          "data": "Search criteria from form"
        },
        "features": [
          "sorting",
          "filtering",
          "paging",
          "rowSelection"
        ]
      },
      "businessLogic": "Populated by calling: BusinessLogic.Lists.RiverAreaSearch.GetList(txtName.Text.Trim, chkActiveOnly.Checked, chkPricingZonesOnly.Checked, chkPortalAreasOnly.Checked, CStr(cboCustomerID.Value), chkHighWaterAreasOnly.Checked).List"
    }
  ],
  "buttons": [
    {
      "name": "btnFind",
      "text": "Find",
      "type": "Search",
      "enabled": true,
      "visible": true,
      "tabIndex": 8,
      "location": { "x": 699, "y": 6 },
      "size": { "width": 75, "height": 23 },
      "anchor": "Top, Right",
      "acceptButton": true,
      "handler": "btnFind_Click",
      "buttonType": "ButtonType.Open",
      "modernEquivalent": {
        "type": "submit",
        "class": "btn btn-primary"
      },
      "businessLogic": "Executes RefreshList(True) to populate grid with search results. Selects first row."
    },
    {
      "name": "btnReset",
      "text": "Reset",
      "type": "Reset",
      "enabled": true,
      "visible": true,
      "tabIndex": 9,
      "location": { "x": 699, "y": 30 },
      "size": { "width": 75, "height": 23 },
      "anchor": "Top, Right",
      "causesValidation": false,
      "handler": "btnReset_Click",
      "buttonType": "ButtonType.Open",
      "modernEquivalent": {
        "type": "button",
        "class": "btn btn-secondary"
      },
      "businessLogic": "Calls ResetFields() to clear all search criteria and set defaults: txtName = empty, chkActiveOnly = true, all other checkboxes = false, cboCustomerID = empty, focus txtName"
    }
  ],
  "panels": [
    {
      "name": "pnlSearch",
      "type": "UltraPanel",
      "dock": "Fill",
      "location": { "x": 0, "y": 0 },
      "size": { "width": 779, "height": 462 },
      "tabIndex": 0,
      "controls": ["lblContextTitle", "pnlCriteria", "grdSearch"],
      "purpose": "Root panel for entire search form"
    },
    {
      "name": "pnlCriteria",
      "type": "UltraPanel",
      "dock": "Top",
      "location": { "x": 0, "y": 24 },
      "size": { "width": 779, "height": 58 },
      "tabIndex": 65,
      "controls": [
        "lblName",
        "txtName",
        "chkPricingZonesOnly",
        "chkActiveOnly",
        "chkPortalAreasOnly",
        "lblCustomerID",
        "cboCustomerID",
        "chkHighWaterAreasOnly",
        "btnFind",
        "btnReset"
      ],
      "purpose": "Search criteria panel containing all search filters and action buttons"
    }
  ],
  "labels": [
    {
      "name": "lblContextTitle",
      "text": "River Areas",
      "type": "UltraLabel",
      "dock": "Top",
      "location": { "x": 0, "y": 0 },
      "size": { "width": 779, "height": 24 },
      "tabIndex": 61,
      "font": "Arial, 12pt, Bold",
      "appearance": {
        "backColor": "SystemColors.Highlight",
        "foreColor": "SystemColors.HighlightText",
        "textVAlign": "Middle"
      },
      "styleSetName": "SearchCaption",
      "purpose": "Form title header"
    },
    {
      "name": "lblName",
      "text": "River area name:",
      "type": "UltraLabel",
      "location": { "x": 4, "y": 6 },
      "size": { "width": 110, "height": 21 },
      "tabIndex": 0,
      "appearance": {
        "textVAlign": "Middle"
      },
      "associatedControl": "txtName"
    },
    {
      "name": "lblCustomerID",
      "text": "High water customer:",
      "type": "UltraLabel",
      "location": { "x": 4, "y": 32 },
      "size": { "width": 115, "height": 21 },
      "tabIndex": 5,
      "appearance": {
        "textVAlign": "Middle"
      },
      "visibility": {
        "condition": "Lists.GlobalSettingList.EnableRiverSegmentHighWaterModel",
        "default": "Hidden"
      },
      "associatedControl": "cboCustomerID"
    }
  ],
  "validation": {
    "method": "None",
    "rules": [],
    "notes": "No explicit validation - search form accepts any combination of criteria"
  },
  "eventHandlers": {
    "pnlSearch_HandleCreated": "Form initialization: calls FormatControls() to set up grid identifier, populate dropdowns, set visibility based on licenses/global settings, configure initial sort order",
    "pnlSearch_HandleDestroyed": "Cleanup: saves grid settings via MyAppSettingHelper.SaveGrid",
    "btnFind_Click": "Executes RefreshList(True) to search and populate grid with results, selecting first row",
    "btnReset_Click": "Calls ResetFields() to clear all search criteria and restore defaults",
    "FocusFirstField": "IBaseSearch implementation: sets focus to txtName",
    "RefreshList": "IBaseSearch implementation: calls RiverAreaSearch.GetList with current search criteria, populates grid via RefreshListBase",
    "ItemAdd": "IBaseSearch implementation: opens frmRiverAreaDetail with new RiverArea entity",
    "ItemModify": "IBaseSearch implementation: opens frmRiverAreaDetail with selected RiverArea entity (ID from GridControlIndex)",
    "ItemRemove": "IBaseSearch implementation: confirms deletion, calls RiverArea.DeleteRiverArea, refreshes list",
    "FormatGridColumns": "Defines visible grid columns with headers, widths, alignments. Conditional columns based on licenses (Portal, UnitTow) and global settings (EnableRiverSegmentHighWaterModel)"
  },
  "businessLogicCalls": {
    "search": {
      "method": "BusinessLogic.Lists.RiverAreaSearch.GetList",
      "parameters": [
        "txtName.Text.Trim (String)",
        "chkActiveOnly.Checked (Boolean)",
        "chkPricingZonesOnly.Checked (Boolean)",
        "chkPortalAreasOnly.Checked (Boolean)",
        "CStr(cboCustomerID.Value) (String)",
        "chkHighWaterAreasOnly.Checked (Boolean)"
      ],
      "returns": "List of RiverArea records matching criteria"
    },
    "add": {
      "method": "BusinessLogic.RiverArea.NewRiverArea",
      "parameters": [],
      "returns": "New RiverArea entity"
    },
    "get": {
      "method": "BusinessLogic.RiverArea.GetRiverArea",
      "parameters": ["RiverAreaID (Integer)"],
      "returns": "RiverArea entity"
    },
    "delete": {
      "method": "BusinessLogic.RiverArea.DeleteRiverArea",
      "parameters": ["RiverAreaID (Integer)"],
      "returns": "void"
    },
    "populateCustomers": {
      "method": "Main.PopulateListCombo",
      "parameters": [
        "Lists.CustomerList.GetList",
        "cboCustomerID",
        "True (includeBlank)",
        "False"
      ],
      "condition": "Lists.GlobalSettingList.EnableRiverSegmentHighWaterModel"
    }
  },
  "securityConfiguration": {
    "subsystem": "SubSystem.frmRiverAreaSearch",
    "buttonPermissions": {
      "btnFind": "ButtonType.Open",
      "btnReset": "ButtonType.Open"
    },
    "implicitActions": {
      "ItemAdd": "Requires permission to add new river areas",
      "ItemModify": "Requires permission to edit river areas",
      "ItemRemove": "Requires permission to delete river areas"
    },
    "notes": "Security controlled via ControlAuthorization object set in InitializeBase. Base form manages Add/Edit/Delete button visibility based on permissions."
  },
  "layoutStructure": {
    "hierarchy": [
      {
        "level": 0,
        "control": "pnlSearch",
        "type": "RootPanel",
        "children": ["lblContextTitle", "pnlCriteria", "grdSearch"]
      },
      {
        "level": 1,
        "control": "lblContextTitle",
        "type": "Header",
        "children": []
      },
      {
        "level": 1,
        "control": "pnlCriteria",
        "type": "SearchPanel",
        "children": [
          "lblName",
          "txtName",
          "chkPricingZonesOnly",
          "chkActiveOnly",
          "chkPortalAreasOnly",
          "lblCustomerID",
          "cboCustomerID",
          "chkHighWaterAreasOnly",
          "btnFind",
          "btnReset"
        ]
      },
      {
        "level": 1,
        "control": "grdSearch",
        "type": "ResultsGrid",
        "children": []
      }
    ],
    "flow": "Top-to-bottom: Title header -> Search criteria panel -> Results grid"
  },
  "modernConversionNotes": {
    "controllerPattern": "RiverAreaSearchController with Index action returning RiverAreaSearchViewModel",
    "viewModelStructure": {
      "name": "RiverAreaSearchViewModel",
      "properties": [
        "string Name (search filter)",
        "bool ActiveOnly (default: true)",
        "bool PricingZonesOnly (default: false)",
        "bool PortalAreasOnly (default: false)",
        "int? CustomerID (nullable)",
        "bool HighWaterAreasOnly (default: false)",
        "bool ShowPortalAreas (feature flag)",
        "bool ShowHighWaterFilters (feature flag)",
        "bool ShowLiquidRateColumn (feature flag)",
        "SelectList Customers (for dropdown)"
      ]
    },
    "apiEndpoint": {
      "route": "/RiverArea/Search",
      "method": "POST",
      "returns": "JSON DataTables response with RiverAreaDto records"
    },
    "featureFlags": [
      {
        "name": "Portal",
        "affects": ["chkPortalAreasOnly visibility", "IsPortalArea column visibility"]
      },
      {
        "name": "EnableRiverSegmentHighWaterModel",
        "affects": [
          "lblCustomerID visibility",
          "cboCustomerID visibility",
          "chkHighWaterAreasOnly visibility",
          "IsHighWaterArea column visibility",
          "CustomerName column visibility"
        ]
      },
      {
        "name": "UnitTow",
        "affects": ["IsLiquidRateArea column visibility"]
      }
    ],
    "searchBehavior": {
      "defaultLoad": "Should grid be populated on initial page load?",
      "recommendation": "Load with ActiveOnly = true by default, or require explicit search",
      "resetBehavior": "Clears all filters except ActiveOnly (sets to true)"
    },
    "gridImplementation": {
      "plugin": "DataTables",
      "serverSide": true,
      "sortable": true,
      "filterable": true,
      "pageable": true,
      "doubleClick": "Navigates to edit page or opens modal for selected river area",
      "persistSettings": "Save grid state (sort, column widths) in user preferences"
    }
  },
  "relatedForms": {
    "detail": "frmRiverAreaDetail",
    "detailPurpose": "Add/Edit individual river area"
  },
  "interfaces": {
    "IBaseSearch": {
      "implementation": "Full implementation",
      "methods": [
        "FocusFirstField()",
        "GridControlIndex",
        "Initialize()",
        "ItemAdd()",
        "ItemModify()",
        "ItemRemove()",
        "ItemRun() - not used",
        "ItemView() - not used",
        "LocalPanel",
        "OnChangeOfFleet() - not used",
        "RefreshList()",
        "SetButtonTypes()",
        "UltraGridControl"
      ]
    }
  },
  "extractionMetadata": {
    "extractedFrom": [
      "C:\\Dev\\BargeOps.Admin.Mono\\OnShore\\apps\\Onshore/Forms/frmRiverAreaSearch.vb",
      "C:\\Dev\\BargeOps.Admin.Mono\\OnShore\\apps\\Onshore/Forms/frmRiverAreaSearch.Designer.vb"
    ],
    "extractionDate": "2025-12-11",
    "completeness": "100%",
    "notes": "All controls, grids, buttons, events, and business logic fully documented. Conditional visibility logic captured for license-based and global setting-based features."
  }
}
