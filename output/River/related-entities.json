{
  "parentEntity": "River",
  "relationships": [
    {
      "relatedEntity": "RiverSegmentDraft",
      "relationshipType": "OneToMany",
      "parentProperty": null,
      "childProperty": "River",
      "foreignKey": "RiverID",
      "foreignKeyType": "Int32",
      "cascadeDelete": false,
      "gridName": null,
      "gridColumns": [],
      "operations": {
        "add": null,
        "edit": null,
        "delete": null
      },
      "notes": "RiverSegmentDraft has RiverID (Int32) foreign key but River does not maintain a collection of draft segments. This is managed through separate search/list forms."
    }
  ],
  "lookupRelationships": [
    {
      "property": "River",
      "lookupEntity": "River",
      "displayProperty": "Code",
      "foreignKeyType": "char(3)",
      "required": false,
      "referencingEntities": [
        "Location",
        "RiverAreaSegment",
        "BoatPositionHistory",
        "DeckLogActivity",
        "DeletedDeckLogActivity",
        "ManualBill",
        "PartsServiceBillItem",
        "VendorBusinessUnit",
        "VesselRecordActivity",
        "BargeExVendorDocumentInbox",
        "TicketEventHighWater",
        "TowDiagramOutbound"
      ],
      "notes": "Many entities reference River by Code (char(3)) rather than RiverID. This is a lookup relationship where River.Code is used as the foreign key."
    }
  ],
  "modernImplementationNotes": {
    "pattern": "Simple reference entity with no child collections",
    "entityDesign": "River is a pure entity class with NO navigation properties or child collections. It serves as a master data/lookup table.",
    "repositoryMethods": [
      "Task<River> GetByIdAsync(int riverID)",
      "Task<River> GetByCodeAsync(string code)",
      "Task<IEnumerable<River>> GetAllAsync()",
      "Task<IEnumerable<River>> GetActiveAsync()",
      "Task<River> CreateAsync(River river)",
      "Task<River> UpdateAsync(River river)",
      "Task DeleteAsync(int riverID)"
    ],
    "serviceLayer": "No related entity loading needed - River is a standalone master data entity. Other entities query River for lookup purposes.",
    "relatedEntityQueries": "Many entities reference River.Code (char(3)) for lookup purposes. Consider indexing Code for performance.",
    "cascadeBehavior": "Database-level foreign key constraints handle referential integrity. Deletion should validate no active references exist.",
    "dapperPattern": "Standard CRUD operations without JOIN queries for child entities. Provide both GetById (using RiverID) and GetByCode (using Code) methods."
  },
  "analysisDetails": {
    "formType": "Single panel detail form",
    "hasChildGrids": false,
    "childCollectionsInCode": false,
    "entityPattern": "Master data / lookup entity",
    "businessObjectPath": "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore.BusinessLogic/Business Objects/River.vb",
    "baseClassPath": "C:/Dev/BargeOps.Admin.Mono/OnShore/apps/Onshore.BusinessLogic/Business Objects/Base Classes/RiverBase.vb",
    "childCollectionsFound": "None - Only p_Alert property for audit alerts (not a domain child entity)",
    "referencedBy": {
      "byRiverID": [
        "RiverSegmentDraft"
      ],
      "byRiverCode": [
        "Location",
        "RiverAreaSegment",
        "BoatPositionHistory",
        "DeckLogActivity",
        "DeletedDeckLogActivity",
        "ManualBill",
        "PartsServiceBillItem",
        "VendorBusinessUnit",
        "VesselRecordActivity",
        "BargeExVendorDocumentInbox",
        "TicketEventHighWater",
        "TowDiagramOutbound"
      ]
    }
  },
  "databaseSchema": {
    "tableName": "River",
    "primaryKey": "RiverID (Int32)",
    "uniqueConstraints": [
      "Code (char(3)) - 3-character waterway code (should be unique)"
    ],
    "indexes": [
      {
        "name": "IX_River_Code",
        "columns": ["Code"],
        "isUnique": true,
        "notes": "Recommended index since many entities reference River by Code"
      }
    ],
    "properties": {
      "RiverID": {
        "type": "Int32",
        "isPrimaryKey": true,
        "isRequired": true,
        "description": "Primary key"
      },
      "Name": {
        "type": "String",
        "maxLength": 40,
        "isRequired": true,
        "description": "Waterway name"
      },
      "Code": {
        "type": "String",
        "maxLength": 3,
        "isRequired": true,
        "isFixedLength": true,
        "validation": "Must be exactly 3 characters",
        "description": "3-character waterway code used for lookups"
      },
      "BargeExCode": {
        "type": "String",
        "maxLength": 10,
        "isRequired": false,
        "description": "BargeEx system code"
      },
      "StartMile": {
        "type": "Decimal",
        "precision": "2 decimal places",
        "isRequired": false,
        "validation": "Must be >= 0 and <= 5000",
        "description": "Starting mile marker for the waterway"
      },
      "EndMile": {
        "type": "Decimal",
        "precision": "2 decimal places",
        "isRequired": false,
        "validation": "Must be >= StartMile and <= 5000",
        "description": "Ending mile marker for the waterway"
      },
      "IsLowToHighDirection": {
        "type": "Boolean",
        "isRequired": true,
        "defaultValue": true,
        "description": "Direction flag for mile markers"
      },
      "IsActive": {
        "type": "Boolean",
        "isRequired": true,
        "defaultValue": true,
        "description": "Indicates if river is active"
      },
      "ConvFmsRiverID": {
        "type": "String",
        "maxLength": null,
        "isRequired": false,
        "description": "Legacy FMS conversion ID"
      },
      "UpLabel": {
        "type": "String",
        "maxLength": 20,
        "isRequired": true,
        "description": "Custom label for upstream direction"
      },
      "DownLabel": {
        "type": "String",
        "maxLength": 20,
        "isRequired": true,
        "description": "Custom label for downstream direction"
      }
    },
    "auditFields": [
      "CreateDateTime",
      "CreateUser",
      "ModifyDateTime",
      "ModifyUser"
    ],
    "storedProcedures": {
      "select": "RiverSelect",
      "selectAll": "RiversSelect",
      "insert": "RiverInsert",
      "update": "RiverUpdate",
      "delete": "RiverDelete"
    }
  },
  "businessRules": [
    {
      "rule": "Code must be exactly 3 characters",
      "severity": "Error",
      "location": "River.vb:199"
    },
    {
      "rule": "StartMile must be >= 0",
      "severity": "Error",
      "location": "River.vb:180"
    },
    {
      "rule": "StartMile must be <= 5000",
      "severity": "Error",
      "location": "River.vb:185"
    },
    {
      "rule": "EndMile must be <= 5000",
      "severity": "Error",
      "location": "River.vb:192"
    },
    {
      "rule": "StartMile must be <= EndMile",
      "severity": "Error",
      "location": "River.vb:174"
    },
    {
      "rule": "Name is required",
      "severity": "Error",
      "location": "RiverBase.vb:351"
    },
    {
      "rule": "Code is required",
      "severity": "Error",
      "location": "RiverBase.vb:359"
    },
    {
      "rule": "UpLabel is required",
      "severity": "Error",
      "location": "RiverBase.vb:373"
    },
    {
      "rule": "DownLabel is required",
      "severity": "Error",
      "location": "RiverBase.vb:381"
    }
  ],
  "cacheManagement": {
    "listCache": "RiverList.GetList",
    "invalidateOn": ["Save", "SaveNoRefresh", "DeleteRiver"],
    "notes": "River maintains a cached list that is marked dirty on any save or delete operation"
  }
}
