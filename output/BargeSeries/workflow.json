{
  "entityName": "BargeSeries",
  "analysisDate": "2025-12-17",
  "forms": [
    {
      "formName": "frmBargeSeriesSearch",
      "formType": "Search",
      "description": "Search and list barge series with filtering capabilities",
      "baseClass": "frmBaseSearch",
      "interface": "IBaseSearch"
    },
    {
      "formName": "frmBargeSeriesDetail",
      "formType": "DetailEdit",
      "description": "Edit barge series details and draft tonnage data",
      "baseClass": "frmBaseDetailEditList",
      "interface": "IBaseDetailEdit"
    }
  ],
  "primaryWorkflows": [
    {
      "name": "SearchAndView",
      "description": "User searches for barge series using filter criteria and views results",
      "steps": [
        {
          "step": 1,
          "action": "EnterSearchCriteria",
          "controls": ["txtBargeSeries", "cboCustomerID", "cboHullType", "cboCoverType", "chkActiveOnly"],
          "details": "User can filter by series name, customer/owner, hull type, cover type, and active status"
        },
        {
          "step": 2,
          "action": "ClickSearch",
          "button": "btnFind",
          "trigger": "btnFind_Click",
          "source": "frmBargeSeriesSearch.vb:163-179",
          "dataFlow": "Calls BargeSeriesSearch.GetList with filter parameters",
          "result": "Grid populated with search results"
        },
        {
          "step": 3,
          "action": "ReviewResults",
          "control": "grdSearch",
          "displayedColumns": ["Name", "Customer", "HullType", "CoverType", "Dimensions", "DraftLight", "TonsPerInch", "IsActive"],
          "sortOrder": "Name (Ascending by default)"
        }
      ]
    },
    {
      "name": "CreateNewBargeSeries",
      "description": "User creates a new barge series record",
      "steps": [
        {
          "step": 1,
          "action": "ClickNew",
          "trigger": "ItemAdd() via IBaseSearch interface",
          "source": "frmBargeSeriesSearch.vb:37-43"
        },
        {
          "step": 2,
          "action": "OpenDetailForm",
          "navigation": "Opens frmBargeSeriesDetail as modal dialog",
          "mode": "New",
          "formTitle": "New - Barge Series Detail"
        },
        {
          "step": 3,
          "action": "EnterBasicInfo",
          "fields": ["txtName", "cboCustomerID", "cboHullType", "cboCoverType", "txtLength", "txtWidth", "txtDepth", "txtTonsPerInch", "txtDraftLightFeet", "txtDraftLightInches", "chkIsActive"]
        },
        {
          "step": 4,
          "action": "EnterDraftTonnageData",
          "section": "grdBargeSeriesDraft",
          "description": "User enters tonnage data for drafts 0-13 feet at inch increments (0-11 inches)",
          "gridStructure": {
            "rows": 14,
            "draftRange": "0-13 feet",
            "columns": ["DraftFeet (read-only)", "Tons00-Tons11 (12 editable columns)"]
          }
        },
        {
          "step": 5,
          "action": "SubmitForm",
          "button": "btnSubmit",
          "processing": ["ProcessBargeSeriesDraft() - creates child records", "SubmitNoRefreshClick() - validates and saves"]
        }
      ]
    },
    {
      "name": "EditExistingBargeSeries",
      "description": "User edits an existing barge series record",
      "steps": [
        {
          "step": 1,
          "action": "SelectRecord",
          "control": "grdSearch"
        },
        {
          "step": 2,
          "action": "ClickEdit",
          "trigger": "ItemModify() via IBaseSearch interface",
          "source": "frmBargeSeriesSearch.vb:46-52"
        },
        {
          "step": 3,
          "action": "OpenDetailForm",
          "mode": "Edit",
          "formTitle": "{Name} - Barge Series Detail"
        },
        {
          "step": 4,
          "action": "LoadExistingData",
          "methods": ["LoadControlsForBargeSeries()", "RefreshList() - builds draft grid from BargeSeriesDrafts collection"]
        },
        {
          "step": 5,
          "action": "ModifyFields",
          "description": "User modifies fields or draft tonnage values"
        },
        {
          "step": 6,
          "action": "SubmitChanges",
          "processing": ["ProcessBargeSeriesDraft() - updates existing children", "SubmitNoRefreshClick() - saves changes"]
        }
      ]
    },
    {
      "name": "DeleteBargeSeries",
      "description": "User deletes a barge series record",
      "steps": [
        {
          "step": 1,
          "action": "SelectRecord"
        },
        {
          "step": 2,
          "action": "ClickDelete",
          "trigger": "ItemRemove()",
          "source": "frmBargeSeriesSearch.vb:55-63"
        },
        {
          "step": 3,
          "action": "ConfirmDelete",
          "dialog": "Main.ItemRemoveDialog('Barge Series')"
        },
        {
          "step": 4,
          "action": "ExecuteDelete",
          "method": "BargeSeries.DeleteBargeSeries(GridControlIndex)",
          "cascade": "Deletes associated BargeSeriesDraft records"
        },
        {
          "step": 5,
          "action": "RefreshList"
        }
      ]
    },
    {
      "name": "PasteDraftData",
      "description": "User pastes draft tonnage data from clipboard (Excel/CSV)",
      "steps": [
        {
          "step": 1,
          "action": "CopyDataToClipboard",
          "description": "User copies tonnage data from Excel or other source"
        },
        {
          "step": 2,
          "action": "ClickPaste",
          "button": "Paste from Clipboard (toolbar)",
          "source": "frmBargeSeriesDetail.vb:172-173"
        },
        {
          "step": 3,
          "action": "ProcessClipboard",
          "method": "PasteFromClipboard()",
          "source": "789-850",
          "supportedFormats": ["CSV", "Tab-delimited"]
        }
      ]
    },
    {
      "name": "ExportDraftTonnage",
      "description": "User exports draft tonnage grid data to Excel",
      "steps": [
        {
          "step": 1,
          "action": "ClickExport",
          "button": "Export (toolbar)",
          "source": "frmBargeSeriesDetail.vb:174-175"
        },
        {
          "step": 2,
          "action": "ExportGrid",
          "method": "Main.ExportGrid(grdBargeSeriesDraft, staStatus, Me.Text)"
        }
      ]
    },
    {
      "name": "CancelEdit",
      "description": "User cancels changes and closes detail form",
      "steps": [
        {
          "step": 1,
          "action": "ClickCancel",
          "button": "btnCancel",
          "source": "frmBargeSeriesDetail.vb:149-163"
        },
        {
          "step": 2,
          "action": "RollbackChanges",
          "method": "CancelClick() - calls BargeSeries.CancelEdit()"
        }
      ]
    }
  ],
  "formStates": [
    {
      "formName": "frmBargeSeriesSearch",
      "state": "Initial",
      "trigger": "pnlSearch_HandleCreated",
      "gridState": "Empty",
      "defaultFocus": "txtBargeSeries"
    },
    {
      "formName": "frmBargeSeriesSearch",
      "state": "ResultsDisplayed",
      "trigger": "RefreshList(True)",
      "gridState": "Populated",
      "sortOrder": "Name ascending"
    },
    {
      "formName": "frmBargeSeriesDetail",
      "state": "NewMode",
      "trigger": "Initialize(BargeSeries.NewBargeSeries())",
      "businessObject": "IsNew = True",
      "formTitle": "New - Barge Series Detail",
      "gridState": "14 rows with 'xxx' placeholders"
    },
    {
      "formName": "frmBargeSeriesDetail",
      "state": "EditMode",
      "trigger": "Initialize(BargeSeries.GetBargeSeries(ID))",
      "businessObject": "IsNew = False",
      "formTitle": "{Name} - Barge Series Detail",
      "gridState": "14 rows populated from BargeSeriesDrafts"
    },
    {
      "formName": "frmBargeSeriesDetail",
      "state": "GridEditActive",
      "description": "User editing draft tonnage grid cell",
      "keyboardNavigation": "Arrow keys with custom handler maintaining edit mode"
    }
  ],
  "navigationPatterns": [
    {
      "from": "frmBargeSeriesSearch",
      "to": "frmBargeSeriesDetail",
      "trigger": "ItemAdd (New) or ItemModify (Edit)",
      "method": "ShowDialog(LocalPanel.Parent)",
      "modalDialog": true,
      "disposal": "Using statement auto-disposes"
    },
    {
      "from": "frmBargeSeriesDetail",
      "to": "frmBargeSeriesSearch",
      "trigger": "btnSubmit or btnCancel",
      "dialogResult": "OK or Cancel"
    }
  ],
  "stateTransitions": [
    {
      "from": "Initial",
      "to": "ResultsDisplayed",
      "trigger": "btnFind.Click"
    },
    {
      "from": "ResultsDisplayed",
      "to": "NewMode (Detail)",
      "trigger": "Add button"
    },
    {
      "from": "ResultsDisplayed",
      "to": "EditMode (Detail)",
      "trigger": "Edit button"
    },
    {
      "from": "NewMode/EditMode",
      "to": "GridEditActive",
      "trigger": "Click grid cell"
    },
    {
      "from": "NewMode/EditMode",
      "to": "Validating",
      "trigger": "btnSubmit"
    },
    {
      "from": "Validating",
      "to": "Saving",
      "trigger": "Validation passes"
    },
    {
      "from": "Saving",
      "to": "Closed",
      "trigger": "Save succeeds"
    }
  ],
  "sessionManagement": {
    "gridSettings": {
      "persistence": "MyAppSettingHelper (database-backed)",
      "saveOn": "pnlSearch_HandleDestroyed",
      "restoreOn": "pnlSearch_HandleCreated"
    },
    "businessObjectLifecycle": {
      "pattern": "IEditableObject (BeginEdit, ApplyEdit, CancelEdit)",
      "transactional": true
    }
  },
  "eventHandlerChains": [
    {
      "trigger": "btnFind.Click",
      "chain": ["btnFind_Click", "RefreshList(True)", "RefreshListBase", "BargeSeriesSearch.GetList", "Populate grid"]
    },
    {
      "trigger": "btnSubmit.Click (New)",
      "chain": ["btnSubmit_Click", "ProcessBargeSeriesDraft()", "Clear collection", "Create 14 children", "SubmitNoRefreshClick", "ApplyEdit", "Database Insert"]
    },
    {
      "trigger": "btnSubmit.Click (Edit)",
      "chain": ["btnSubmit_Click", "ProcessBargeSeriesDraft()", "Update children by ID", "SubmitNoRefreshClick", "ApplyEdit", "Database Update"]
    },
    {
      "trigger": "grdBargeSeriesDraft.AfterCellUpdate",
      "chain": ["Check _ManualCellUpdate flag", "Validate value", "Convert to Integer or 'xxx'", "Set cell value"]
    },
    {
      "trigger": "Toolbar Paste",
      "chain": ["ToolbarsManager_ToolClick", "PasteFromClipboard", "Detect CSV/Tab format", "Parse data", "Populate grid"]
    }
  ],
  "modalDialogPatterns": {
    "searchToDetail": {
      "pattern": "Using frm As New frmBargeSeriesDetail",
      "initialization": "frm.Initialize(businessObject)",
      "display": "frm.ShowDialog(LocalPanel.Parent)",
      "disposal": "Automatic via Using"
    }
  },
  "refreshTriggers": [
    {
      "trigger": "btnFind.Click",
      "method": "RefreshList(True)",
      "selectFirstRow": true
    },
    {
      "trigger": "After Delete",
      "method": "RefreshList(False)",
      "selectFirstRow": false
    },
    {
      "trigger": "frmDetailEdit_Load",
      "method": "RefreshList()",
      "description": "Populates draft grid"
    }
  ],
  "userExperience": {
    "searchForm": {
      "defaultFocus": "txtBargeSeries",
      "enterKeyBehavior": "Triggers search",
      "gridSorting": "User-configurable, defaults to Name ascending"
    },
    "detailForm": {
      "windowMode": "Modal, fixed size, centered",
      "validationFeedback": "Real-time via ValidatorExtender in status bar",
      "gridNavigation": {
        "arrowKeys": "Navigate with auto-enter edit mode",
        "tabKey": "Next cell (snaking), exits grid on last cell"
      },
      "toolbarActions": [
        {
          "button": "Paste from Clipboard",
          "function": "Import CSV/tab-delimited tonnage data"
        },
        {
          "button": "Export",
          "function": "Export draft grid to Excel/CSV"
        }
      ]
    }
  },
  "dataFlow": {
    "search": {
      "input": "Filter criteria",
      "businessLogic": "BargeSeriesSearch.GetList",
      "storedProc": "dbo.BargeSeriesSearch",
      "output": "BargeSeriesList"
    },
    "load": {
      "input": "BargeSeriesID",
      "businessLogic": "BargeSeries.GetBargeSeries",
      "storedProc": "dbo.BargeSeriesSelect",
      "output": "BargeSeries with BargeSeriesDrafts collection"
    },
    "save": {
      "new": {
        "businessLogic": "BargeSeries.ApplyEdit",
        "storedProcs": ["dbo.BargeSeriesInsert", "dbo.BargeSeriesDraftInsert (×14)"]
      },
      "edit": {
        "businessLogic": "BargeSeries.ApplyEdit",
        "storedProcs": ["dbo.BargeSeriesUpdate", "dbo.BargeSeriesDraftUpdate (×14)"]
      }
    },
    "delete": {
      "businessLogic": "BargeSeries.DeleteBargeSeries",
      "storedProc": "dbo.BargeSeriesDelete",
      "cascade": "Deletes BargeSeriesDrafts"
    }
  },
  "specialBehaviors": {
    "draftTonnageGrid": {
      "description": "Editable grid with 14 fixed rows (0-13 feet) and 12 editable columns (0-11 inches)",
      "rowsFixed": 14,
      "draftFeetReadOnly": true,
      "nullRepresentation": "'xxx' placeholder",
      "validation": "AfterCellUpdate converts to Integer or 'xxx'",
      "sortingDisabled": true,
      "addNewDisabled": true
    },
    "clipboardPaste": {
      "description": "Paste tonnage data from Excel/CSV into grid",
      "formats": ["CSV", "Tab-delimited"],
      "columnStart": "Tons00",
      "validation": "Decimal values rounded to integer"
    },
    "childCollectionManagement": {
      "newMode": "Clear collection, create all 14 from grid",
      "editMode": "Update existing by BargeSeriesDraftID"
    }
  },
  "relatedEntities": [
    {
      "entityName": "BargeSeriesDraft",
      "relationship": "One-to-Many",
      "cardinality": "1:0-14",
      "managedInGrid": "grdBargeSeriesDraft",
      "cascadeDelete": true
    },
    {
      "entityName": "Customer",
      "relationship": "Many-to-One",
      "control": "cboCustomerID",
      "label": "Owner"
    },
    {
      "entityName": "ValidationList (HullType)",
      "relationship": "Lookup",
      "control": "cboHullType"
    },
    {
      "entityName": "ValidationList (CoverType)",
      "relationship": "Lookup",
      "control": "cboCoverType"
    }
  ]
}
