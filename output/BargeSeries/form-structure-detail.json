{
  "formName": "frmBargeSeriesDetail",
  "inheritsFrom": "frmBaseDetailEditList",
  "implements": ["IBaseDetailEdit"],
  "businessObject": "BargeSeries",
  "childCollection": "BargeSeriesDrafts",
  "formTitle": {
    "new": "New - Barge Series Detail",
    "edit": "{Name} - Barge Series Detail"
  },
  "controls": [
    {
      "name": "txtName",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Series:",
      "dataBinding": "BargeSeries.Name",
      "validation": {
        "type": "String",
        "required": false,
        "maxLength": "BargeSeries.MaxLength.Name"
      },
      "events": ["Validated"],
      "tabIndex": 1,
      "location": "pnlDetailEdit"
    },
    {
      "name": "cboCustomerID",
      "type": "UltraCombo",
      "category": "DataEntry",
      "label": "Owner:",
      "dataBinding": "BargeSeries.CustomerID",
      "populationMethod": "Lists.CustomerList.GetList",
      "validation": {
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 3,
      "location": "pnlDetailEdit"
    },
    {
      "name": "cboHullType",
      "type": "UltraCombo",
      "category": "DataEntry",
      "label": "Hull type:",
      "dataBinding": "BargeSeries.HullType",
      "populationMethod": "PopulateValidationListCombo(Lists.ValidationList.ValidationTypes.HullType)",
      "validation": {
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 2,
      "location": "pnlDetailEdit"
    },
    {
      "name": "cboCoverType",
      "type": "UltraCombo",
      "category": "DataEntry",
      "label": "Cover type:",
      "dataBinding": "BargeSeries.CoverType",
      "populationMethod": "PopulateValidationListCombo(Lists.ValidationList.ValidationTypes.CoverType)",
      "validation": {
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 4,
      "location": "pnlDetailEdit"
    },
    {
      "name": "txtLength",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Length:",
      "dataBinding": "BargeSeries.Length",
      "validation": {
        "type": "Decimal",
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 5,
      "location": "pnlDetailEdit"
    },
    {
      "name": "txtWidth",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Width:",
      "dataBinding": "BargeSeries.Width",
      "validation": {
        "type": "Decimal",
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 6,
      "location": "pnlDetailEdit"
    },
    {
      "name": "txtDepth",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Depth:",
      "dataBinding": "BargeSeries.Depth",
      "validation": {
        "type": "Decimal",
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 7,
      "location": "pnlDetailEdit"
    },
    {
      "name": "txtTonsPerInch",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Tons/inch:",
      "dataBinding": "BargeSeries.TonsPerInch",
      "validation": {
        "type": "Decimal",
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 8,
      "location": "pnlDetailEdit"
    },
    {
      "name": "txtDraftLightFeet",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Light draft (ft/in):",
      "labelNote": "Feet portion",
      "dataBinding": "BargeSeries.DraftLightFeet",
      "validation": {
        "type": "Int32",
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 9,
      "location": "pnlDetailEdit",
      "relatedControl": "txtDraftLightInches"
    },
    {
      "name": "txtDraftLightInches",
      "type": "UltraTextEditor",
      "category": "DataEntry",
      "label": "Light draft (ft/in):",
      "labelNote": "Inches portion",
      "dataBinding": "BargeSeries.DraftLightInches",
      "validation": {
        "type": "Int32",
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 10,
      "location": "pnlDetailEdit",
      "relatedControl": "txtDraftLightFeet"
    },
    {
      "name": "chkIsActive",
      "type": "UltraCheckEditor",
      "category": "DataEntry",
      "label": "Active",
      "dataBinding": "BargeSeries.IsActive",
      "defaultValue": true,
      "validation": {
        "required": false
      },
      "events": ["Validated"],
      "tabIndex": 12,
      "location": "grpSubmitCancel"
    }
  ],
  "grids": [
    {
      "name": "grdBargeSeriesDraft",
      "type": "UltraGrid",
      "uniqueIdentifier": "BargeSeriesDraftID",
      "category": "ChildEditGrid",
      "label": "Draft tonnage",
      "dataSource": "BuildBargeSeriesDraftTable()",
      "updateMode": "OnCellChangeOrLostFocus",
      "allowAddNew": false,
      "allowUpdate": true,
      "allowDelete": false,
      "sortable": false,
      "sortOrder": [
        {
          "column": "DraftFeet",
          "direction": "Ascending"
        }
      ],
      "gridSettings": {
        "allowColMoving": false,
        "allowColSizing": false,
        "cellClickAction": "EditAndSelectText",
        "selectTypeCell": "Single",
        "selectTypeRow": "None",
        "selectTypeCol": "None",
        "tabNavigation": "NextControlOnLastCell",
        "invalidValueBehavior": "RetainValueAndFocus",
        "nullText": "xxx",
        "columnChooserEnabled": false
      },
      "columns": [
        {
          "key": "BargeSeriesDraftID",
          "header": "ID",
          "dataType": "Int32",
          "visible": false,
          "editable": false,
          "description": "Primary key for grid row"
        },
        {
          "key": "DraftFeet",
          "header": "Feet",
          "dataType": "Int32",
          "width": 50,
          "alignment": "Right",
          "editable": false,
          "sortable": false,
          "description": "Draft in feet (0-13)"
        },
        {
          "key": "Tons00",
          "header": "0\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 0 inches"
        },
        {
          "key": "Tons01",
          "header": "1\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 1 inch"
        },
        {
          "key": "Tons02",
          "header": "2\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 2 inches"
        },
        {
          "key": "Tons03",
          "header": "3\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 3 inches"
        },
        {
          "key": "Tons04",
          "header": "4\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 4 inches"
        },
        {
          "key": "Tons05",
          "header": "5\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 5 inches"
        },
        {
          "key": "Tons06",
          "header": "6\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 6 inches"
        },
        {
          "key": "Tons07",
          "header": "7\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 7 inches"
        },
        {
          "key": "Tons08",
          "header": "8\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 8 inches"
        },
        {
          "key": "Tons09",
          "header": "9\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 9 inches"
        },
        {
          "key": "Tons10",
          "header": "10\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 10 inches"
        },
        {
          "key": "Tons11",
          "header": "11\"",
          "dataType": "String",
          "width": 44,
          "alignment": "Right",
          "editable": true,
          "sortable": false,
          "nullText": "xxx",
          "description": "Tonnage at 11 inches"
        }
      ],
      "events": [
        {
          "name": "AfterCellUpdate",
          "handler": "grdBargeSeriesDraft_AfterCellUpdate",
          "description": "Validates cell input, ensures numeric values or 'xxx' placeholder"
        },
        {
          "name": "BeforeSortChange",
          "handler": "grdBargeSeriesDraftEditList_BeforeSortChange",
          "description": "Prevents user from changing sort order"
        },
        {
          "name": "KeyDown",
          "handler": "grdBargeSeriesDraftEditList_KeyDown",
          "description": "Custom keyboard navigation (Up/Down/Left/Right arrows)"
        }
      ],
      "location": "grpDetailEditList",
      "tabIndex": 11,
      "modernEquivalent": {
        "component": "DataTable with inline editing",
        "features": [
          "Fixed column layout (prevent reordering/resizing)",
          "Inline cell editing with validation",
          "Custom keyboard navigation",
          "Null value handling with placeholder text",
          "Paste from clipboard support",
          "Export functionality"
        ]
      }
    }
  ],
  "buttons": [
    {
      "name": "btnSubmit",
      "text": "&Submit",
      "type": "Submit",
      "category": "FormAction",
      "enabled": true,
      "visible": true,
      "tabIndex": 13,
      "handler": "btnSubmit_Click",
      "description": "Validates and saves BargeSeries and child BargeSeriesDraft records",
      "location": "grpSubmitCancel",
      "dialogResult": "OK",
      "securityButtonType": "Submit"
    },
    {
      "name": "btnCancel",
      "text": "&Cancel",
      "type": "Cancel",
      "category": "FormAction",
      "enabled": true,
      "visible": true,
      "tabIndex": 14,
      "handler": "btnCancel_Click",
      "description": "Cancels changes and closes form",
      "location": "grpSubmitCancel",
      "dialogResult": "Cancel",
      "causesValidation": false,
      "securityButtonType": "Cancel"
    }
  ],
  "toolbarButtons": [
    {
      "key": "Paste",
      "caption": "&Paste from Clipboard",
      "displayStyle": "ImageAndText",
      "image": "Resources.Paste",
      "type": "Action",
      "handler": "ToolbarsManager_ToolClick",
      "description": "Pastes CSV or tab-delimited data from clipboard into draft tonnage grid",
      "securityButtonType": "Action"
    },
    {
      "key": "Export",
      "caption": "Export",
      "displayStyle": "ImageAndText",
      "image": "Resources.ExportResults",
      "type": "Open",
      "handler": "ToolbarsManager_ToolClick",
      "description": "Exports draft tonnage grid to external format",
      "securityButtonType": "Open"
    }
  ],
  "panels": [
    {
      "name": "pnlBargeSeriesDetail",
      "type": "UltraPanel",
      "dock": "Fill",
      "description": "Main container panel for entire form"
    },
    {
      "name": "pnlDetailEdit",
      "type": "UltraPanel",
      "dock": "Top",
      "height": 114,
      "description": "Container for BargeSeries data entry fields",
      "controls": [
        "txtName",
        "cboCustomerID",
        "cboHullType",
        "cboCoverType",
        "txtLength",
        "txtWidth",
        "txtDepth",
        "txtTonsPerInch",
        "txtDraftLightFeet",
        "txtDraftLightInches"
      ]
    },
    {
      "name": "grpDetailEditList",
      "type": "UltraGroupBox",
      "text": "Draft tonnage",
      "dock": "Fill",
      "borderStyle": "Header3D",
      "description": "Container for draft tonnage grid",
      "controls": ["pnlDetailEditList"]
    },
    {
      "name": "pnlDetailEditList",
      "type": "UltraPanel",
      "dock": "Fill",
      "description": "Container for grid and toolbar",
      "controls": ["grdBargeSeriesDraft", "ToolbarsManager"]
    },
    {
      "name": "grpSubmitCancel",
      "type": "UltraGroupBox",
      "dock": "Bottom",
      "height": 36,
      "borderStyle": "None",
      "causesValidation": false,
      "description": "Container for form action buttons",
      "controls": ["chkIsActive", "btnSubmit", "btnCancel"]
    }
  ],
  "statusBar": {
    "name": "staStatus",
    "type": "UltraStatusBar",
    "description": "Displays validation messages from ValidatorExtender"
  },
  "validation": {
    "extender": "ValidatorExtender",
    "displayControl": "staStatus",
    "rules": [
      {
        "control": "txtName",
        "validationType": "String",
        "required": false,
        "maxLength": "BargeSeries.MaxLength.Name"
      },
      {
        "control": "txtLength",
        "validationType": "Decimal",
        "required": false
      },
      {
        "control": "txtWidth",
        "validationType": "Decimal",
        "required": false
      },
      {
        "control": "txtDepth",
        "validationType": "Decimal",
        "required": false
      },
      {
        "control": "txtTonsPerInch",
        "validationType": "Decimal",
        "required": false
      },
      {
        "control": "txtDraftLightFeet",
        "validationType": "Int32",
        "required": false
      },
      {
        "control": "txtDraftLightInches",
        "validationType": "Int32",
        "required": false
      }
    ],
    "gridCellValidation": {
      "grid": "grdBargeSeriesDraft",
      "description": "Cells must be numeric integer or 'xxx' placeholder",
      "handler": "grdBargeSeriesDraft_AfterCellUpdate",
      "invalidValueBehavior": "RetainValueAndFocus",
      "nullText": "xxx"
    }
  },
  "eventHandlers": {
    "Form_Load": "Formats controls, loads BargeSeries data, refreshes draft grid",
    "Form_FormClosed": "Cleanup operations",
    "btnSubmit_Click": "Processes grid data into BargeSeriesDraft collection, calls SubmitNoRefreshClick()",
    "btnCancel_Click": "Calls CancelClick() to abandon changes",
    "ToolbarsManager_ToolClick": "Routes toolbar button clicks to PasteFromClipboard() or ExportGrid()",
    "grdBargeSeriesDraft_AfterCellUpdate": "Validates cell input as integer or 'xxx', prevents invalid values",
    "grdBargeSeriesDraft_BeforeSortChange": "Prevents user from changing grid sort order",
    "grdBargeSeriesDraft_KeyDown": "Custom arrow key navigation with auto-edit mode"
  },
  "businessLogic": {
    "initialization": {
      "method": "Initialize",
      "parameters": ["BusinessLogic.BusinessLogicBase"],
      "description": "Receives BargeSeries object, calls BeginEdit(), sets form title, calls InitializeBase()"
    },
    "dataBinding": {
      "parentObject": "BargeSeries",
      "childCollection": "BargeSeries.BargeSeriesDrafts",
      "loadMethod": "LoadControlsForBargeSeries",
      "saveMethod": "ProcessBargeSeriesDraft"
    },
    "gridDataSource": {
      "method": "BuildBargeSeriesDraftTable",
      "returns": "DataTable with 14 rows (feet 0-13) and 14 columns (ID, DraftFeet, Tons00-Tons11)",
      "description": "Creates fixed 14-row grid structure, populates from BargeSeriesDrafts collection"
    },
    "saveProcess": {
      "method": "ProcessBargeSeriesDraft",
      "description": "Iterates grid rows, creates/updates BargeSeriesDraft child objects, converts 'xxx' to empty string",
      "helperMethods": ["GetTonsFromGridCell", "GetTonsOrDefault"]
    },
    "pasteFromClipboard": {
      "method": "PasteFromClipboard",
      "supportedFormats": ["CommaSeparatedValue", "Text (tab-delimited)"],
      "description": "Parses clipboard data, validates as decimal, rounds to integer, populates grid cells",
      "helperMethod": "GetFieldValue"
    }
  },
  "security": {
    "interface": "IBaseDetailEdit",
    "method": "SetButtonTypes",
    "formButtons": [
      {
        "control": "btnSubmit",
        "buttonType": "Submit"
      },
      {
        "control": "btnCancel",
        "buttonType": "Cancel"
      }
    ],
    "toolbarButtons": [
      {
        "key": "Paste",
        "buttonType": "Action"
      },
      {
        "key": "Export",
        "buttonType": "Open"
      }
    ],
    "description": "Uses ControlAuthorization to set access levels based on button types"
  },
  "formBehavior": {
    "formBorderStyle": "FixedSingle",
    "maximizeBox": false,
    "minimizeBox": false,
    "showInTaskbar": false,
    "startPosition": "CenterParent",
    "baseForm": "frmBaseDetailEditList",
    "editMode": "BeginEdit/CancelEdit pattern",
    "submitBehavior": "NoRefresh (SubmitNoRefreshClick)"
  },
  "specialFeatures": [
    {
      "feature": "Draft Tonnage Grid",
      "description": "Fixed 14-row x 13-column grid for tonnage lookup table, allows inline editing with validation"
    },
    {
      "feature": "Paste from Clipboard",
      "description": "Supports CSV and tab-delimited data paste into tonnage grid, validates and rounds to integers"
    },
    {
      "feature": "Null Value Handling",
      "description": "Uses 'xxx' placeholder for empty/null tonnage values, converts back to empty string on save"
    },
    {
      "feature": "Custom Grid Navigation",
      "description": "Arrow keys navigate between cells with automatic edit mode entry/exit"
    },
    {
      "feature": "Validation List Combos",
      "description": "HullType and CoverType populated from validation lists, CustomerID from customer list"
    },
    {
      "feature": "Split Draft Input",
      "description": "Light draft split into separate feet and inches inputs"
    }
  ],
  "modernizationNotes": {
    "gridPattern": "DataTables with inline editing plugin (jeditable or similar)",
    "pasteFeature": "Consider using PapaParse.js for CSV parsing, maintain paste-from-Excel functionality",
    "validationPattern": "Client-side: jQuery Validation or HTML5 validation; Server-side: FluentValidation",
    "dropdownPattern": "Select2 for HullType, CoverType, CustomerID with AJAX loading",
    "formLayout": "Bootstrap 5 card-based layout with form-control styling",
    "nullValueHandling": "Use placeholder text and optional empty values instead of 'xxx' string",
    "gridEditing": "Consider modern spreadsheet libraries (Handsontable, AG Grid) for Excel-like editing",
    "toolbarActions": "Move Paste/Export to dedicated buttons above grid",
    "securityIntegration": "ASP.NET Core Authorization with role-based button visibility"
  }
}
