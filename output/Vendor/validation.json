{
  "entity": "Vendor",
  "formValidation": {
    "method": "SetValidatorExtenderForVendor",
    "location": "frmVendorDetail.vb:1524-1540",
    "rules": [
      {
        "field": "txtName",
        "validationType": "String",
        "maxLength": 20,
        "severity": "Error"
      },
      {
        "field": "txtLongName",
        "validationType": "String",
        "maxLength": 50,
        "severity": "Error"
      },
      {
        "field": "txtAccountingCode",
        "validationType": "String",
        "maxLength": 20,
        "severity": "Error"
      },
      {
        "field": "txtAddress",
        "validationType": "String",
        "maxLength": 80,
        "severity": "Error"
      },
      {
        "field": "txtCity",
        "validationType": "String",
        "maxLength": 30,
        "severity": "Error"
      },
      {
        "field": "txtZip",
        "validationType": "ZipCodeOptionalExtention",
        "maxLength": 10,
        "severity": "Error"
      },
      {
        "field": "txtPhoneNumber",
        "validationType": "Phone10",
        "maxLength": 10,
        "format": "10-digit phone",
        "severity": "Error"
      },
      {
        "field": "txtFaxNumber",
        "validationType": "Phone10",
        "maxLength": 10,
        "format": "10-digit phone",
        "severity": "Error"
      },
      {
        "field": "txtEmailAddress",
        "validationType": "Email",
        "maxLength": 100,
        "severity": "Error"
      }
    ]
  },
  "businessValidation": {
    "method": "CheckBusinessRules",
    "location": "VendorBase.vb:566-648, Vendor.vb:77-93",
    "rules": [
      {
        "ruleName": "NameRequired",
        "property": "Name",
        "condition": "String.IsNullOrEmpty(p_Name)",
        "message": "Name is required",
        "severity": "Error",
        "alwaysApplies": true,
        "location": "VendorBase.vb:571-573"
      },
      {
        "ruleName": "NameMaxLength",
        "property": "Name",
        "condition": "(p_Name.Length > MaxLength.Name)",
        "message": "Name exceeds maximum length of 20.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 20,
        "location": "VendorBase.vb:574-576"
      },
      {
        "ruleName": "LongNameRequired",
        "property": "LongName",
        "condition": "String.IsNullOrEmpty(p_LongName)",
        "message": "Long name is required",
        "severity": "Error",
        "alwaysApplies": true,
        "location": "VendorBase.vb:580-582"
      },
      {
        "ruleName": "LongNameMaxLength",
        "property": "LongName",
        "condition": "(p_LongName.Length > MaxLength.LongName)",
        "message": "Long name exceeds maximum length of 50.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 50,
        "location": "VendorBase.vb:583-585"
      },
      {
        "ruleName": "AccountingCodeMaxLength",
        "property": "AccountingCode",
        "condition": "(p_AccountingCode.Length > MaxLength.AccountingCode)",
        "message": "AccountingCode exceeds maximum length of 20.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 20,
        "location": "VendorBase.vb:588-590"
      },
      {
        "ruleName": "AddressMaxLength",
        "property": "Address",
        "condition": "(p_Address.Length > MaxLength.Address)",
        "message": "Address exceeds maximum length of 80.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 80,
        "location": "VendorBase.vb:594-596"
      },
      {
        "ruleName": "CityMaxLength",
        "property": "City",
        "condition": "(p_City.Length > MaxLength.City)",
        "message": "City exceeds maximum length of 30.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 30,
        "location": "VendorBase.vb:600-602"
      },
      {
        "ruleName": "StateMaxLength",
        "property": "State",
        "condition": "(p_State.Length > MaxLength.State)",
        "message": "State exceeds maximum length of 2.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 2,
        "location": "VendorBase.vb:606-608"
      },
      {
        "ruleName": "ZipMaxLength",
        "property": "Zip",
        "condition": "(p_Zip.Length > MaxLength.Zip)",
        "message": "Zip exceeds maximum length of 10.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 10,
        "location": "VendorBase.vb:612-614"
      },
      {
        "ruleName": "PhoneNumberMaxLength",
        "property": "PhoneNumber",
        "condition": "(p_PhoneNumber.Length > MaxLength.PhoneNumber)",
        "message": "Phone number exceeds maximum length of 10.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 10,
        "location": "VendorBase.vb:618-620"
      },
      {
        "ruleName": "FaxNumberMaxLength",
        "property": "FaxNumber",
        "condition": "(p_FaxNumber.Length > MaxLength.FaxNumber)",
        "message": "Fax number exceeds maximum length of 10.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 10,
        "location": "VendorBase.vb:624-626"
      },
      {
        "ruleName": "EmailAddressMaxLength",
        "property": "EmailAddress",
        "condition": "(p_EmailAddress.Length > MaxLength.EmailAddress)",
        "message": "Email address exceeds maximum length of 100.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 100,
        "location": "VendorBase.vb:630-632"
      },
      {
        "ruleName": "BargeExTradingPartnerNumMaxLength",
        "property": "BargeExTradingPartnerNum",
        "condition": "(p_BargeExTradingPartnerNum.Length > MaxLength.BargeExTradingPartnerNum)",
        "message": "Trading partner number exceeds maximum length of 8.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 8,
        "location": "VendorBase.vb:636-638"
      },
      {
        "ruleName": "TermsCodeMaxLength",
        "property": "TermsCode",
        "condition": "(p_TermsCode.Length > MaxLength.TermsCode)",
        "message": "TermsCode exceeds maximum length of 8.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 8,
        "location": "VendorBase.vb:642-644"
      },
      {
        "ruleName": "BargeExEnabledTwoRequiredFields",
        "property": "IsBargeExEnabled",
        "condition": "(p_IsBargeExEnabled AndAlso (String.IsNullOrEmpty(p_BargeExTradingPartnerNum.Trim) OrElse String.IsNullOrEmpty(p_BargeExConfigID.Trim)))",
        "message": "Both Trading partner number & Configuration required for BargeEx enabled.",
        "severity": "Error",
        "alwaysApplies": false,
        "appliesWhen": "IsBargeExEnabled is True",
        "location": "Vendor.vb:87-90"
      }
    ]
  },
  "childEntities": {
    "VendorContact": {
      "formValidation": {
        "method": "SetValidatorExtenderForVendorContact",
        "location": "frmVendorDetail.vb:1766-1778",
        "rules": [
          {
            "field": "txtContactName",
            "validationType": "String",
            "maxLength": 80,
            "severity": "Error"
          },
          {
            "field": "txtContactPhoneNumber",
            "validationType": "Phone10",
            "maxLength": 10,
            "format": "10-digit phone",
            "severity": "Error"
          },
          {
            "field": "txtContactPhoneExt",
            "validationType": "String",
            "maxLength": 7,
            "severity": "Error"
          },
          {
            "field": "txtContactEmailAddress",
            "validationType": "Email",
            "maxLength": 100,
            "severity": "Error"
          },
          {
            "field": "txtContactFaxNumber",
            "validationType": "Phone10",
            "maxLength": 10,
            "format": "10-digit phone",
            "severity": "Error"
          }
        ]
      },
      "businessValidation": {
        "method": "CheckBusinessRules",
        "location": "VendorContactBase.vb:320-358",
        "rules": [
          {
            "ruleName": "NameRequired",
            "property": "Name",
            "condition": "String.IsNullOrEmpty(p_Name)",
            "message": "Name is required",
            "severity": "Error",
            "alwaysApplies": true,
            "location": "VendorContactBase.vb:326-327"
          },
          {
            "ruleName": "NameMaxLength",
            "property": "Name",
            "condition": "(p_Name.Length > MaxLength.Name)",
            "message": "Name exceeds maximum length of 80.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 80,
            "location": "VendorContactBase.vb:328-330"
          },
          {
            "ruleName": "PhoneNumberMaxLength",
            "property": "PhoneNumber",
            "condition": "(p_PhoneNumber.Length > MaxLength.PhoneNumber)",
            "message": "PhoneNumber exceeds maximum length of 10.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 10,
            "location": "VendorContactBase.vb:334-336"
          },
          {
            "ruleName": "PhoneExtMaxLength",
            "property": "PhoneExt",
            "condition": "(p_PhoneExt.Length > MaxLength.PhoneExt)",
            "message": "PhoneExt exceeds maximum length of 7.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 7,
            "location": "VendorContactBase.vb:340-342"
          },
          {
            "ruleName": "EmailAddressMaxLength",
            "property": "EmailAddress",
            "condition": "(p_EmailAddress.Length > MaxLength.EmailAddress)",
            "message": "EmailAddress exceeds maximum length of 100.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 100,
            "location": "VendorContactBase.vb:346-348"
          },
          {
            "ruleName": "FaxNumberMaxLength",
            "property": "FaxNumber",
            "condition": "(p_FaxNumber.Length > MaxLength.FaxNumber)",
            "message": "FaxNumber exceeds maximum length of 10.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 10,
            "location": "VendorContactBase.vb:352-354"
          }
        ]
      },
      "customValidation": {
        "rules": [
          {
            "ruleName": "EmailClearingDeletesPortalAccount",
            "trigger": "btnSet_Click",
            "condition": "(String.IsNullOrEmpty(_VendorContact.EmailAddress)) AndAlso (Not String.IsNullOrEmpty(_VendorContact.PortalUserID))",
            "message": "Clearing the email address will delete the contact's portal account including saved searches and column preferences. Are you sure you want to do that?",
            "severity": "Warning",
            "requiresConfirmation": true,
            "location": "frmVendorDetail.vb:175-180"
          },
          {
            "ruleName": "IsPrimaryUnique",
            "trigger": "SetClickListAndDetail",
            "condition": "_VendorContact.IsPrimary",
            "action": "Clears IsPrimary on all other contacts in collection",
            "severity": "Info",
            "location": "frmVendorDetail.vb:417-426"
          }
        ]
      }
    },
    "VendorBusinessUnit": {
      "formValidation": {
        "method": "SetValidatorExtenderForVendorBusinessUnit",
        "location": "frmVendorDetail.vb:2104-2112",
        "rules": [
          {
            "field": "txtMile",
            "validationType": "Decimal",
            "severity": "Error"
          }
        ]
      },
      "businessValidation": {
        "method": "CheckBusinessRules",
        "location": "VendorBusinessUnitBase.vb:358-396",
        "rules": [
          {
            "ruleName": "NameRequired",
            "property": "Name",
            "condition": "String.IsNullOrEmpty(p_Name)",
            "message": "Name is required",
            "severity": "Error",
            "alwaysApplies": true,
            "location": "VendorBusinessUnitBase.vb:364-365"
          },
          {
            "ruleName": "NameMaxLength",
            "property": "Name",
            "condition": "(p_Name.Length > MaxLength.Name)",
            "message": "Name exceeds maximum length of 50.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 50,
            "location": "VendorBusinessUnitBase.vb:366-368"
          },
          {
            "ruleName": "AccountingCodeMaxLength",
            "property": "AccountingCode",
            "condition": "(p_AccountingCode.Length > MaxLength.AccountingCode)",
            "message": "AccountingCode exceeds maximum length of 50.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 50,
            "location": "VendorBusinessUnitBase.vb:372-374"
          },
          {
            "ruleName": "RiverMaxLength",
            "property": "River",
            "condition": "(p_River.Length > MaxLength.River)",
            "message": "River exceeds maximum length of 3.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 3,
            "location": "VendorBusinessUnitBase.vb:378-380"
          },
          {
            "ruleName": "BankMaxLength",
            "property": "Bank",
            "condition": "(p_Bank.Length > MaxLength.Bank)",
            "message": "Bank exceeds maximum length of 50.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 50,
            "location": "VendorBusinessUnitBase.vb:384-386"
          },
          {
            "ruleName": "MinDiscountFrequencyMaxLength",
            "property": "MinDiscountFrequency",
            "condition": "(p_MinDiscountFrequency.Length > MaxLength.MinDiscountFrequency)",
            "message": "MinDiscountFrequency exceeds maximum length of 20.",
            "severity": "Error",
            "alwaysApplies": true,
            "maxLength": 20,
            "location": "VendorBusinessUnitBase.vb:390-392"
          }
        ]
      },
      "customValidation": {
        "rules": [
          {
            "ruleName": "FuelSupplierDependentFields",
            "trigger": "btnVbuSet_Click",
            "condition": "(Not _VendorBusinessUnit.IsFuelSupplier)",
            "action": "Clears IsDefaultFuelSupplier, MinDiscountQty, MinDiscountFrequency",
            "severity": "Info",
            "location": "frmVendorDetail.vb:216-220"
          },
          {
            "ruleName": "IsDefaultFuelSupplierUnique",
            "trigger": "CheckDefaultFuelSuppliers",
            "condition": "_VendorBusinessUnit.IsDefaultFuelSupplier",
            "action": "Clears IsDefaultFuelSupplier on all other VendorBusinessUnits",
            "severity": "Info",
            "location": "frmVendorDetail.vb:1102-1116"
          },
          {
            "ruleName": "IsDefaultFuelSupplierNotification",
            "trigger": "chkIsDefaultFuelSupplier_CheckedChanged",
            "condition": "chkIsDefaultFuelSupplier.Checked",
            "message": "This fuel supplier will replace the existing default fuel supplier when you submit the change.",
            "severity": "Info",
            "requiresConfirmation": false,
            "location": "frmVendorDetail.vb:1962-1963"
          },
          {
            "ruleName": "IsDefaultFuelSupplierUncheckedWarning",
            "trigger": "chkIsDefaultFuelSupplier_CheckedChanged",
            "condition": "Not chkIsDefaultFuelSupplier.Checked",
            "message": "You have unchecked this fuel supplier as the default fuel supplier. Please remember to choose a new default fuel supplier.",
            "severity": "Info",
            "requiresConfirmation": false,
            "location": "frmVendorDetail.vb:1965"
          }
        ]
      }
    }
  },
  "conditionalFieldsClearing": {
    "rules": [
      {
        "ruleName": "ClearBargeExFieldsWhenDisabled",
        "trigger": "ClearUnusedFields",
        "condition": "(Not chkIsBargeExEnabled.Checked)",
        "action": "Clears BargeExTradingPartnerNum and BargeExConfigID",
        "location": "frmVendorDetail.vb:920-929"
      }
    ]
  },
  "modernEquivalents": {
    "dataAnnotations": [
      "[Required(ErrorMessage = \"Name is required\")]",
      "[StringLength(20, ErrorMessage = \"Name exceeds maximum length of 20.\")]",
      "public string Name { get; set; }",
      "",
      "[Required(ErrorMessage = \"Long name is required\")]",
      "[StringLength(50, ErrorMessage = \"Long name exceeds maximum length of 50.\")]",
      "public string LongName { get; set; }",
      "",
      "[StringLength(20)]",
      "public string AccountingCode { get; set; }",
      "",
      "[StringLength(80)]",
      "public string Address { get; set; }",
      "",
      "[StringLength(30)]",
      "public string City { get; set; }",
      "",
      "[StringLength(2)]",
      "public string State { get; set; }",
      "",
      "[RegularExpression(@\"^\\d{5}(-\\d{4})?$\", ErrorMessage = \"Invalid ZIP code format\")]",
      "[StringLength(10)]",
      "public string Zip { get; set; }",
      "",
      "[Phone]",
      "[StringLength(10)]",
      "public string PhoneNumber { get; set; }",
      "",
      "[Phone]",
      "[StringLength(10)]",
      "public string FaxNumber { get; set; }",
      "",
      "[EmailAddress(ErrorMessage = \"Invalid email address\")]",
      "[StringLength(100)]",
      "public string EmailAddress { get; set; }",
      "",
      "[StringLength(8)]",
      "public string BargeExTradingPartnerNum { get; set; }",
      "",
      "public string BargeExConfigID { get; set; }",
      "",
      "[StringLength(8)]",
      "public string TermsCode { get; set; }"
    ],
    "fluentValidation": [
      "RuleFor(x => x.Name)",
      "    .NotEmpty().WithMessage(\"Name is required\")",
      "    .MaximumLength(20).WithMessage(\"Name exceeds maximum length of 20.\");",
      "",
      "RuleFor(x => x.LongName)",
      "    .NotEmpty().WithMessage(\"Long name is required\")",
      "    .MaximumLength(50).WithMessage(\"Long name exceeds maximum length of 50.\");",
      "",
      "RuleFor(x => x.AccountingCode)",
      "    .MaximumLength(20);",
      "",
      "RuleFor(x => x.Address)",
      "    .MaximumLength(80);",
      "",
      "RuleFor(x => x.City)",
      "    .MaximumLength(30);",
      "",
      "RuleFor(x => x.State)",
      "    .MaximumLength(2);",
      "",
      "RuleFor(x => x.Zip)",
      "    .MaximumLength(10)",
      "    .Matches(@\"^\\d{5}(-\\d{4})?$\").When(x => !string.IsNullOrEmpty(x.Zip))",
      "    .WithMessage(\"Invalid ZIP code format\");",
      "",
      "RuleFor(x => x.PhoneNumber)",
      "    .MaximumLength(10)",
      "    .Matches(@\"^\\d{10}$\").When(x => !string.IsNullOrEmpty(x.PhoneNumber))",
      "    .WithMessage(\"Phone number must be 10 digits\");",
      "",
      "RuleFor(x => x.FaxNumber)",
      "    .MaximumLength(10)",
      "    .Matches(@\"^\\d{10}$\").When(x => !string.IsNullOrEmpty(x.FaxNumber))",
      "    .WithMessage(\"Fax number must be 10 digits\");",
      "",
      "RuleFor(x => x.EmailAddress)",
      "    .MaximumLength(100)",
      "    .EmailAddress().When(x => !string.IsNullOrEmpty(x.EmailAddress))",
      "    .WithMessage(\"Invalid email address\");",
      "",
      "RuleFor(x => x.BargeExTradingPartnerNum)",
      "    .NotEmpty()",
      "    .When(x => x.IsBargeExEnabled)",
      "    .WithMessage(\"Both Trading partner number & Configuration required for BargeEx enabled.\");",
      "",
      "RuleFor(x => x.BargeExConfigID)",
      "    .NotEmpty()",
      "    .When(x => x.IsBargeExEnabled)",
      "    .WithMessage(\"Both Trading partner number & Configuration required for BargeEx enabled.\");",
      "",
      "RuleFor(x => x.TermsCode)",
      "    .MaximumLength(8);"
    ],
    "jqueryValidate": [
      "$(\"#txtName\").rules(\"add\", {",
      "    required: true,",
      "    maxlength: 20,",
      "    messages: {",
      "        required: \"Name is required\",",
      "        maxlength: \"Name exceeds maximum length of 20.\"",
      "    }",
      "});",
      "",
      "$(\"#txtLongName\").rules(\"add\", {",
      "    required: true,",
      "    maxlength: 50,",
      "    messages: {",
      "        required: \"Long name is required\",",
      "        maxlength: \"Long name exceeds maximum length of 50.\"",
      "    }",
      "});",
      "",
      "$(\"#txtEmailAddress\").rules(\"add\", {",
      "    email: true,",
      "    maxlength: 100,",
      "    messages: {",
      "        email: \"Invalid email address\",",
      "        maxlength: \"Email address exceeds maximum length of 100.\"",
      "    }",
      "});",
      "",
      "$(\"#txtPhoneNumber\").rules(\"add\", {",
      "    pattern: /^\\d{10}$/,",
      "    maxlength: 10,",
      "    messages: {",
      "        pattern: \"Phone number must be 10 digits\"",
      "    }",
      "});",
      "",
      "$(\"#txtBargeExTradingPartnerNum\").rules(\"add\", {",
      "    required: function() { return $(\"#chkIsBargeExEnabled\").is(\":checked\"); },",
      "    maxlength: 8,",
      "    messages: {",
      "        required: \"Both Trading partner number & Configuration required for BargeEx enabled.\"",
      "    }",
      "});",
      "",
      "$(\"#cboBargeExConfigID\").rules(\"add\", {",
      "    required: function() { return $(\"#chkIsBargeExEnabled\").is(\":checked\"); },",
      "    messages: {",
      "        required: \"Both Trading partner number & Configuration required for BargeEx enabled.\"",
      "    }",
      "});"
    ]
  },
  "validationSummary": {
    "requiredFields": [
      "Name",
      "LongName",
      "BargeExTradingPartnerNum (when IsBargeExEnabled)",
      "BargeExConfigID (when IsBargeExEnabled)",
      "VendorContact.Name",
      "VendorBusinessUnit.Name"
    ],
    "formatValidations": [
      {
        "field": "Zip",
        "format": "ZIP code with optional +4 extension",
        "pattern": "^\\d{5}(-\\d{4})?$"
      },
      {
        "field": "PhoneNumber",
        "format": "10-digit phone number",
        "pattern": "^\\d{10}$"
      },
      {
        "field": "FaxNumber",
        "format": "10-digit phone number",
        "pattern": "^\\d{10}$"
      },
      {
        "field": "EmailAddress",
        "format": "Valid email address",
        "pattern": "Standard email regex"
      },
      {
        "field": "VendorContact.PhoneNumber",
        "format": "10-digit phone number",
        "pattern": "^\\d{10}$"
      },
      {
        "field": "VendorContact.PhoneExt",
        "format": "7-digit extension",
        "pattern": "^\\d{7}$"
      },
      {
        "field": "VendorContact.FaxNumber",
        "format": "10-digit phone number",
        "pattern": "^\\d{10}$"
      },
      {
        "field": "VendorContact.EmailAddress",
        "format": "Valid email address",
        "pattern": "Standard email regex"
      },
      {
        "field": "VendorBusinessUnit.Mile",
        "format": "Decimal number",
        "pattern": "Decimal"
      },
      {
        "field": "VendorBusinessUnit.MinDiscountQty",
        "format": "Decimal number",
        "pattern": "Decimal"
      }
    ],
    "conditionalValidations": [
      {
        "field": "BargeExTradingPartnerNum",
        "condition": "IsBargeExEnabled = True",
        "rule": "Required"
      },
      {
        "field": "BargeExConfigID",
        "condition": "IsBargeExEnabled = True",
        "rule": "Required"
      },
      {
        "field": "VendorBusinessUnit.IsDefaultFuelSupplier",
        "condition": "IsFuelSupplier = False",
        "rule": "Automatically cleared"
      },
      {
        "field": "VendorBusinessUnit.MinDiscountQty",
        "condition": "IsFuelSupplier = False",
        "rule": "Automatically cleared"
      },
      {
        "field": "VendorBusinessUnit.MinDiscountFrequency",
        "condition": "IsFuelSupplier = False",
        "rule": "Automatically cleared"
      }
    ],
    "crossFieldValidations": [
      {
        "fields": ["IsBargeExEnabled", "BargeExTradingPartnerNum", "BargeExConfigID"],
        "rule": "Both Trading Partner Number and Configuration required when BargeEx is enabled"
      },
      {
        "fields": ["VendorContact.IsPrimary"],
        "rule": "Only one contact can be marked as Primary"
      },
      {
        "fields": ["VendorBusinessUnit.IsDefaultFuelSupplier"],
        "rule": "Only one VendorBusinessUnit can be marked as Default Fuel Supplier"
      }
    ]
  }
}
