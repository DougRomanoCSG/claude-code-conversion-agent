{
  "parentEntity": "ColorPair",
  "displayName": "BargeTokenColors",
  "actualTableName": "ColorPair",
  "description": "Manages barge token color pairs (text and background colors) for visual identification. ColorPair is a lookup/reference entity used by BargeTokenMap to define color combinations.",
  "relationships": [],
  "lookupRelationships": [
    {
      "property": "FleetID",
      "lookupEntity": "Fleet",
      "displayProperty": "FleetName",
      "required": true,
      "description": "Foreign key to Fleet - ColorPairs are scoped to a specific fleet"
    }
  ],
  "childEntityRelationships": [],
  "parentEntityRelationships": [
    {
      "relatedEntity": "Fleet",
      "relationshipType": "ManyToOne",
      "parentProperty": "FleetID",
      "foreignKey": "FleetID",
      "required": true,
      "description": "Each ColorPair belongs to a specific Fleet"
    }
  ],
  "usedByEntities": [
    {
      "entity": "BargeTokenMap",
      "foreignKeyProperty": "ColorPairID",
      "relationshipType": "OneToMany",
      "description": "ColorPair is referenced by BargeTokenMap to define color display for barge tokens",
      "usage": "Lookup/Reference",
      "propertyType": "string",
      "notes": "ColorPairID in BargeTokenMap is stored as string, not int FK. This is a lookup relationship where BargeTokenMap references ColorPair for color display configuration.",
      "fileReference": "C:\\Dev\\BargeOps.Admin.Mono\\OnShore\\apps\\Onshore.BusinessLogic\\Business Objects\\Base Classes\\BargeTokenMapBase.vb:27,44,61"
    }
  ],
  "entityType": "Lookup/Reference Table",
  "hasChildCollections": false,
  "hasChildGrids": false,
  "formPattern": "Master-detail on single screen",
  "gridDetails": {
    "masterGrid": {
      "gridName": "grdColorPair",
      "columns": [
        {
          "binding": "Name",
          "header": "Color Name",
          "type": "String",
          "width": 142,
          "alignment": "Left"
        },
        {
          "binding": "TextColor",
          "header": "Text Color",
          "type": "String",
          "width": 100,
          "alignment": "Left",
          "notes": "Displays System.Drawing.Color name"
        },
        {
          "binding": "BackColor",
          "header": "Back Color",
          "type": "String",
          "width": 100,
          "alignment": "Left",
          "notes": "Displays System.Drawing.Color name"
        }
      ],
      "defaultSort": "Name ASC",
      "uniqueIdentifier": "ColorPairID",
      "operations": {
        "add": "ItemAdd - Creates new ColorPair via NewColorPair()",
        "edit": "ItemModify - Loads ColorPair via GetColorPair(id)",
        "delete": "ItemRemove - Hard deletes via DeleteColorPair(id)"
      }
    },
    "childGrids": []
  },
  "editFormControls": [
    {
      "control": "txtName",
      "binding": "Name",
      "type": "TextBox",
      "maxLength": 50,
      "required": true
    },
    {
      "control": "clrTextColor",
      "binding": "TextColor",
      "type": "ColorPicker",
      "required": true,
      "notes": "Stores System.Drawing.Color.Name value",
      "validation": "Cannot be empty or '0'",
      "eventHandler": "ColorChanged updates lblSample.ForeColor"
    },
    {
      "control": "clrBackColor",
      "binding": "BackColor",
      "type": "ColorPicker",
      "required": true,
      "notes": "Stores System.Drawing.Color.Name value",
      "validation": "Cannot be empty or '0'",
      "eventHandler": "ColorChanged updates lblSample.BackColor"
    },
    {
      "control": "lblSample",
      "type": "Label",
      "purpose": "Live preview of text and background color combination"
    }
  ],
  "modernImplementationPattern": {
    "entityClass": {
      "name": "ColorPair",
      "properties": [
        {
          "name": "ColorPairID",
          "type": "int",
          "description": "Primary key"
        },
        {
          "name": "FleetID",
          "type": "int",
          "description": "Foreign key to Fleet"
        },
        {
          "name": "Name",
          "type": "string",
          "maxLength": 50,
          "required": true
        },
        {
          "name": "TextColor",
          "type": "string",
          "maxLength": 50,
          "required": true,
          "notes": "Stored as System.Drawing.Color name"
        },
        {
          "name": "BackColor",
          "type": "string",
          "maxLength": 50,
          "required": true,
          "notes": "Stored as System.Drawing.Color name"
        }
      ],
      "notes": "No child collection properties - ColorPair is a standalone lookup entity"
    },
    "repositoryPattern": {
      "interface": "IBargeTokenColorsRepository",
      "implementation": "BargeTokenColorsRepository",
      "methods": [
        {
          "name": "GetByIdAsync",
          "returnType": "Task<BargeTokenColorsDto?>",
          "parameters": ["int id"]
        },
        {
          "name": "SearchAsync",
          "returnType": "Task<PagedResult<BargeTokenColorsDto>>",
          "parameters": ["BargeTokenColorsSearchRequest request"],
          "notes": "Filters by FleetID and Name"
        },
        {
          "name": "CreateAsync",
          "returnType": "Task<BargeTokenColorsDto>",
          "parameters": ["BargeTokenColorsDto colorPair"]
        },
        {
          "name": "UpdateAsync",
          "returnType": "Task<BargeTokenColorsDto>",
          "parameters": ["BargeTokenColorsDto colorPair"]
        },
        {
          "name": "DeleteAsync",
          "returnType": "Task<bool>",
          "parameters": ["int id"],
          "notes": "Hard delete - no soft delete pattern"
        }
      ],
      "notes": "No methods for loading child collections - ColorPair has no children"
    },
    "serviceLayerPattern": {
      "service": "BargeTokenColorsService",
      "methods": [
        {
          "name": "GetByIdAsync",
          "description": "Load single ColorPair by ID",
          "notes": "No child entity loading required"
        },
        {
          "name": "SearchAsync",
          "description": "Search ColorPairs with filtering",
          "notes": "Returns flat list - no related entity composition needed"
        },
        {
          "name": "CreateAsync",
          "description": "Create new ColorPair"
        },
        {
          "name": "UpdateAsync",
          "description": "Update existing ColorPair"
        },
        {
          "name": "DeleteAsync",
          "description": "Hard delete ColorPair",
          "notes": "Should check if ColorPair is referenced by BargeTokenMap before deletion"
        }
      ]
    }
  },
  "dataIntegrityConsiderations": [
    {
      "issue": "ColorPair referenced by BargeTokenMap",
      "impact": "Deleting a ColorPair that is in use by BargeTokenMap could break token display",
      "recommendation": "Add referential integrity check before delete - query BargeTokenMap for ColorPairID usage",
      "implementation": "In DeleteAsync, check if ColorPairID exists in BargeTokenMap.ColorPairID before allowing deletion"
    },
    {
      "issue": "FleetID scope",
      "impact": "ColorPairs are fleet-specific",
      "recommendation": "Ensure users can only see/edit ColorPairs for their authorized fleets",
      "implementation": "Filter by FleetID based on user's fleet access in service layer"
    }
  ],
  "migrationNotes": [
    "ColorPair has NO child collections - it is a pure lookup/reference entity",
    "ColorPair is used BY BargeTokenMap (ColorPair is the 'one' in one-to-many)",
    "No child grids to migrate - single master grid only",
    "Form pattern: Master grid with inline edit panel (all on one screen)",
    "No cascade delete to child entities - ColorPair has no children",
    "Color values stored as System.Drawing.Color names - require conversion to/from hex for web UI",
    "BargeTokenMap.ColorPairID is stored as string, not int FK - weak reference pattern",
    "Live preview (lblSample) updates on color picker change events",
    "FleetID is required but set at save time, not at object creation"
  ],
  "commonMistakes": [
    "❌ Looking for child collections that don't exist - ColorPair has no children",
    "❌ Treating this as a parent entity - ColorPair is a lookup entity referenced BY other entities",
    "❌ Not checking BargeTokenMap references before allowing delete",
    "❌ Not implementing color name to hex conversion for web UI",
    "❌ Forgetting to filter by FleetID for multi-tenant security",
    "❌ Not validating that TextColor and BackColor are not '0' or empty"
  ],
  "relatedEntityAnalysis": {
    "isParentEntity": false,
    "isChildEntity": false,
    "isLookupEntity": true,
    "hasOneToManyRelationships": false,
    "hasManyToOneRelationships": true,
    "hasManyToManyRelationships": false,
    "childCollectionCount": 0,
    "parentReferenceCount": 1,
    "usageAsLookupCount": 1
  },
  "sqlSchema": {
    "tableName": "ColorPair",
    "primaryKey": "ColorPairID",
    "foreignKeys": [
      {
        "column": "FleetID",
        "referencesTable": "Fleet",
        "referencesColumn": "FleetID",
        "required": true
      }
    ],
    "indexes": [
      {
        "type": "Clustered",
        "columns": ["ColorPairID"]
      },
      {
        "type": "NonClustered",
        "columns": ["FleetID", "Name"],
        "purpose": "Search and filtering"
      }
    ],
    "referencedBy": [
      {
        "table": "BargeTokenMap",
        "column": "ColorPairID",
        "type": "string",
        "notes": "Weak reference - stored as string, not enforced FK"
      }
    ]
  }
}
