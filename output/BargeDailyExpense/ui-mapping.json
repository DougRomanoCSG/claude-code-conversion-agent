{
  "entity": "BargeDailyExpense",
  "description": "UI component mapping for barge daily expense tracking and management",
  "controlMappings": [
    {
      "legacyControl": "UltraTextEditor (Text)",
      "modernEquivalent": "Bootstrap Text Input",
      "html": "<input type=\"text\" class=\"form-control\" placeholder=\"Enter value...\" />",
      "usage": "Description, notes, reference fields",
      "accessibility": "Use asp-for tag helper for label association"
    },
    {
      "legacyControl": "UltraTextEditor (Numeric - Currency)",
      "modernEquivalent": "Bootstrap Number Input with Currency Format",
      "html": "<div class=\"input-group\">\n  <span class=\"input-group-text\">$</span>\n  <input type=\"number\" class=\"form-control\" step=\"0.01\" min=\"0\" placeholder=\"0.00\" />\n</div>",
      "usage": "Amount, cost, price fields",
      "validation": "jquery.validate with min: 0, step: 0.01",
      "javascript": "// Format display as currency\nfunction formatCurrency(value) {\n  return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(value);\n}"
    },
    {
      "legacyControl": "UltraTextEditor (Numeric - Quantity)",
      "modernEquivalent": "Bootstrap Number Input",
      "html": "<input type=\"number\" class=\"form-control\" step=\"1\" min=\"0\" placeholder=\"0\" />",
      "usage": "Quantity, count fields",
      "validation": "jquery.validate with min: 0, integer validation"
    },
    {
      "legacyControl": "UltraDateTimeEditor (Date Only)",
      "modernEquivalent": "Bootstrap Date Input",
      "html": "<input type=\"date\" class=\"form-control\" id=\"expenseDate\" />",
      "usage": "Expense date, transaction date",
      "displayFormat": "MM/dd/yyyy",
      "javascript": "// Initialize with today's date\n$('#expenseDate').val(new Date().toISOString().split('T')[0]);"
    },
    {
      "legacyControl": "UltraDateTimeEditor (Date and Time)",
      "modernEquivalent": "SPLIT Date + Time Inputs (24-hour)",
      "html": "<div class=\"row\">\n  <div class=\"col-md-6\">\n    <label asp-for=\"TransactionDateTime\" class=\"form-label\">Transaction Date</label>\n    <input asp-for=\"TransactionDateTime\" class=\"form-control\" type=\"date\" id=\"dtTransactionDate\" />\n  </div>\n  <div class=\"col-md-6\">\n    <label class=\"form-label\">Transaction Time (24-hour)</label>\n    <input type=\"time\" class=\"form-control\" id=\"dtTransactionTime\" />\n  </div>\n</div>",
      "displayFormat": "MM/dd/yyyy HH:mm (military time)",
      "javascript": "function splitDateTime(dateTimeValue, dateFieldId, timeFieldId) {\n  if (dateTimeValue) {\n    var date = new Date(dateTimeValue);\n    if (!isNaN(date.getTime())) {\n      $('#' + dateFieldId).val(date.toISOString().split('T')[0]);\n      var hours = ('0' + date.getHours()).slice(-2);\n      var minutes = ('0' + date.getMinutes()).slice(-2);\n      $('#' + timeFieldId).val(hours + ':' + minutes);\n    }\n  }\n}\n\nfunction combineDateTime(dateFieldId, timeFieldId) {\n  var date = $('#' + dateFieldId).val();\n  var time = $('#' + timeFieldId).val();\n  return (date && time) ? date + 'T' + time + ':00' : (date ? date + 'T00:00:00' : '');\n}\n\n$(function() {\n  var transactionDateTime = '@Model.TransactionDateTime?.ToString(\"o\")';\n  if (transactionDateTime) {\n    splitDateTime(transactionDateTime, 'dtTransactionDate', 'dtTransactionTime');\n  }\n  $('form').on('submit', function() {\n    var combined = combineDateTime('dtTransactionDate', 'dtTransactionTime');\n    if (combined) $('#dtTransactionDate').val(combined);\n  });\n});"
    },
    {
      "legacyControl": "UltraComboEditor (Expense Category)",
      "modernEquivalent": "Select2 Dropdown",
      "html": "<select class=\"form-select\" data-select2=\"true\" id=\"ExpenseCategoryId\">\n  <option value=\"\">-- Select Expense Category --</option>\n</select>",
      "javascript": "$('#ExpenseCategoryId').select2({\n  placeholder: '-- Select Expense Category --',\n  allowClear: true,\n  width: '100%'\n});",
      "usage": "Expense category, type classification"
    },
    {
      "legacyControl": "UltraComboEditor (Barge)",
      "modernEquivalent": "Select2 Dropdown with AJAX",
      "html": "<select class=\"form-select\" data-select2=\"true\" id=\"BargeId\">\n  <option value=\"\">-- Select Barge --</option>\n</select>",
      "javascript": "$('#BargeId').select2({\n  placeholder: '-- Select Barge --',\n  allowClear: true,\n  width: '100%',\n  ajax: {\n    url: '/api/barges',\n    dataType: 'json',\n    delay: 250,\n    data: function(params) {\n      return {\n        search: params.term,\n        page: params.page || 1\n      };\n    },\n    processResults: function(data, params) {\n      params.page = params.page || 1;\n      return {\n        results: data.results,\n        pagination: {\n          more: (params.page * 30) < data.total_count\n        }\n      };\n    },\n    cache: true\n  },\n  minimumInputLength: 2\n});",
      "usage": "Barge selection with search capability"
    },
    {
      "legacyControl": "UltraComboEditor (Vendor/Supplier)",
      "modernEquivalent": "Select2 Dropdown with AJAX",
      "html": "<select class=\"form-select\" data-select2=\"true\" id=\"VendorId\">\n  <option value=\"\">-- Select Vendor --</option>\n</select>",
      "javascript": "$('#VendorId').select2({\n  placeholder: '-- Select Vendor --',\n  allowClear: true,\n  width: '100%',\n  ajax: {\n    url: '/api/vendors',\n    dataType: 'json',\n    delay: 250,\n    data: function(params) {\n      return {\n        search: params.term,\n        page: params.page || 1\n      };\n    },\n    processResults: function(data) {\n      return { results: data.results };\n    },\n    cache: true\n  },\n  minimumInputLength: 1\n});",
      "usage": "Vendor/supplier selection"
    },
    {
      "legacyControl": "UltraCheckEditor",
      "modernEquivalent": "Bootstrap Checkbox",
      "html": "<div class=\"form-check\">\n  <input type=\"checkbox\" class=\"form-check-input\" id=\"IsPaid\" />\n  <label class=\"form-check-label\" for=\"IsPaid\">Paid</label>\n</div>",
      "usage": "IsPaid, IsApproved, IsReconciled flags"
    },
    {
      "legacyControl": "UltraPanel (Search Criteria)",
      "modernEquivalent": "Bootstrap Card",
      "html": "<div class=\"card mb-3\">\n  <div class=\"card-header\">\n    <h5 class=\"card-title mb-0\">\n      <i class=\"fas fa-search\"></i> Search Criteria\n    </h5>\n  </div>\n  <div class=\"card-body\">\n    <form id=\"searchForm\">\n      <!-- Search controls here -->\n    </form>\n  </div>\n</div>",
      "usage": "Group search controls in a card container"
    },
    {
      "legacyControl": "UltraPanel (Expense Details)",
      "modernEquivalent": "Bootstrap Card",
      "html": "<div class=\"card mb-3\">\n  <div class=\"card-header\">\n    <h5 class=\"card-title mb-0\">\n      <i class=\"fas fa-dollar-sign\"></i> Expense Details\n    </h5>\n  </div>\n  <div class=\"card-body\">\n    <!-- Expense detail controls -->\n  </div>\n</div>",
      "usage": "Group expense detail controls"
    },
    {
      "legacyControl": "UltraGrid (Expense List)",
      "modernEquivalent": "DataTables with Server-Side Processing",
      "html": "<div class=\"card\">\n  <div class=\"card-header\">\n    <h5 class=\"card-title mb-0\">\n      <i class=\"fas fa-receipt\"></i> Daily Expenses\n    </h5>\n  </div>\n  <div class=\"card-body\">\n    <div class=\"table-responsive\">\n      <table id=\"bargeDailyExpenseTable\" class=\"table table-striped table-bordered dt-responsive nowrap\" style=\"width:100%\">\n        <thead>\n          <tr>\n            <th>Actions</th>\n            <th>Date</th>\n            <th>Barge</th>\n            <th>Category</th>\n            <th>Description</th>\n            <th>Vendor</th>\n            <th>Amount</th>\n            <th>Paid</th>\n            <th>Approved</th>\n          </tr>\n        </thead>\n        <tbody></tbody>\n      </table>\n    </div>\n  </div>\n</div>",
      "javascript": "$('#bargeDailyExpenseTable').DataTable({\n  processing: true,\n  serverSide: true,\n  stateSave: true,\n  responsive: true,\n  ajax: {\n    url: '/BargeDailyExpense/BargeDailyExpenseTable',\n    type: 'POST',\n    data: function(d) {\n      d.bargeId = $('#BargeId').val();\n      d.expenseCategoryId = $('#ExpenseCategoryId').val();\n      d.vendorId = $('#VendorId').val();\n      d.startDate = $('#StartDate').val();\n      d.endDate = $('#EndDate').val();\n      d.isPaidOnly = $('#IsPaidOnly').is(':checked');\n      d.isApprovedOnly = $('#IsApprovedOnly').is(':checked');\n    }\n  },\n  columns: [\n    {\n      data: null,\n      name: 'actions',\n      orderable: false,\n      searchable: false,\n      className: 'text-center',\n      width: '80px',\n      render: function(data, type, row) {\n        return '<div class=\"btn-group btn-group-sm\" role=\"group\">' +\n               '<a href=\"/BargeDailyExpense/Edit/' + row.expenseId + '\" class=\"btn btn-sm btn-primary\" title=\"Edit\">' +\n               '<i class=\"fas fa-edit\"></i></a>' +\n               '</div>';\n      }\n    },\n    { \n      data: 'expenseDate',\n      name: 'expenseDate',\n      render: function(data) {\n        return data ? moment(data).format('MM/DD/YYYY') : '';\n      }\n    },\n    { data: 'bargeName', name: 'bargeName', defaultContent: '' },\n    { data: 'categoryName', name: 'categoryName', defaultContent: '' },\n    { data: 'description', name: 'description', defaultContent: '' },\n    { data: 'vendorName', name: 'vendorName', defaultContent: '' },\n    {\n      data: 'amount',\n      name: 'amount',\n      className: 'text-end',\n      render: function(data) {\n        return data ? '$' + parseFloat(data).toFixed(2) : '$0.00';\n      }\n    },\n    {\n      data: 'isPaid',\n      name: 'isPaid',\n      className: 'text-center',\n      render: function(data) {\n        return '<input type=\"checkbox\" ' + (data ? 'checked' : '') + ' disabled />';\n      }\n    },\n    {\n      data: 'isApproved',\n      name: 'isApproved',\n      className: 'text-center',\n      render: function(data) {\n        return '<input type=\"checkbox\" ' + (data ? 'checked' : '') + ' disabled />';\n      }\n    }\n  ],\n  order: [[1, 'desc']],\n  pageLength: 25,\n  lengthMenu: [[10, 25, 50, 100], [10, 25, 50, 100]],\n  language: {\n    processing: '<i class=\"fas fa-spinner fa-spin\"></i> Loading...'\n  },\n  drawCallback: function(settings) {\n    $('[data-bs-toggle=\"tooltip\"]').tooltip();\n  }\n});",
      "usage": "Display and search daily expenses"
    },
    {
      "legacyControl": "UltraTabControl",
      "modernEquivalent": "Bootstrap Nav Tabs",
      "html": "<ul class=\"nav nav-tabs\" id=\"expenseTabs\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"details-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#details-panel\" type=\"button\" role=\"tab\">Expense Details</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"attachments-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#attachments-panel\" type=\"button\" role=\"tab\">Attachments</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"history-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#history-panel\" type=\"button\" role=\"tab\">History</button>\n  </li>\n</ul>\n<div class=\"tab-content\" id=\"expenseTabContent\">\n  <div class=\"tab-pane fade show active\" id=\"details-panel\" role=\"tabpanel\">...</div>\n  <div class=\"tab-pane fade\" id=\"attachments-panel\" role=\"tabpanel\">...</div>\n  <div class=\"tab-pane fade\" id=\"history-panel\" role=\"tabpanel\">...</div>\n</div>",
      "usage": "Organize expense details, attachments, and history into tabs"
    },
    {
      "legacyControl": "Button (Standard)",
      "modernEquivalent": "Bootstrap Button",
      "html": "<button type=\"button\" id=\"btnSearch\" class=\"btn btn-primary\">\n  <i class=\"fas fa-search\"></i> Find\n</button>\n<button type=\"button\" id=\"btnReset\" class=\"btn btn-secondary\">\n  <i class=\"fas fa-undo\"></i> Reset\n</button>\n<button type=\"submit\" id=\"btnSave\" class=\"btn btn-success\">\n  <i class=\"fas fa-save\"></i> Save\n</button>\n<button type=\"button\" id=\"btnCancel\" class=\"btn btn-secondary\">\n  <i class=\"fas fa-times\"></i> Cancel\n</button>",
      "usage": "Action buttons for search, save, cancel operations"
    },
    {
      "legacyControl": "UltraTextEditor (Multiline/Memo)",
      "modernEquivalent": "Bootstrap Textarea",
      "html": "<textarea class=\"form-control\" rows=\"3\" placeholder=\"Enter description or notes...\"></textarea>",
      "usage": "Description, notes, comments fields"
    }
  ],
  "formPatterns": {
    "searchForm": {
      "layout": "Bootstrap card with row/col grid",
      "controls": [
        "Barge (Select2 dropdown with AJAX search)",
        "Expense Category (Select2 dropdown)",
        "Vendor (Select2 dropdown with AJAX search)",
        "Date Range (date inputs: Start Date, End Date)",
        "Amount Range (number inputs: Min Amount, Max Amount)",
        "Filter Options (checkboxes: Paid Only, Approved Only)"
      ],
      "submitButton": "btn btn-primary with search icon",
      "resetButton": "btn btn-secondary with undo icon",
      "addNewButton": "btn btn-success float-end with plus icon"
    },
    "editForm": {
      "layout": "Bootstrap cards with tab navigation",
      "sections": [
        {
          "name": "Expense Details",
          "controls": [
            "Expense Date (date input)",
            "Barge (Select2 dropdown with AJAX)",
            "Expense Category (Select2 dropdown)",
            "Vendor (Select2 dropdown with AJAX)",
            "Amount (currency number input)",
            "Quantity (number input)",
            "Description (textarea)",
            "IsPaid (checkbox)",
            "IsApproved (checkbox)",
            "Reference Number (text input)"
          ]
        },
        {
          "name": "Attachments",
          "controls": "File upload control with preview grid"
        },
        {
          "name": "History",
          "controls": "DataTables grid showing audit trail"
        }
      ]
    },
    "gridPattern": {
      "library": "DataTables",
      "serverSide": true,
      "responsive": true,
      "stateSave": true,
      "features": [
        "Sorting",
        "Filtering",
        "Pagination",
        "Column visibility toggle",
        "Export (CSV, Excel, PDF)",
        "Custom date range filtering",
        "Amount range filtering",
        "Checkbox status filtering"
      ],
      "actions": "Edit button in actions column (first column)"
    }
  },
  "javascriptPatterns": {
    "dataTablesInitialization": {
      "file": "bargeDailyExpenseSearch.js",
      "description": "Initialize DataTables grid with server-side processing",
      "code": "$(document).ready(function() {\n  const STORAGE_KEYS = {\n    CURRENT_STATE: 'bargeDailyExpenseTable_v1',\n    ACTIONS_FIRST: 'dataTable_actionsFirst',\n    VIEW_BUTTON: 'dataTable_showViewButton'\n  };\n\n  if ($.fn.DataTable.isDataTable('#bargeDailyExpenseTable')) {\n    $('#bargeDailyExpenseTable').DataTable().destroy();\n  }\n\n  if (typeof Storage !== 'undefined') {\n    localStorage.setItem(STORAGE_KEYS.ACTIONS_FIRST, 'true');\n    localStorage.setItem(STORAGE_KEYS.VIEW_BUTTON, 'false');\n  }\n\n  var dataTable = $('#bargeDailyExpenseTable').DataTable({\n    processing: true,\n    serverSide: true,\n    stateSave: true,\n    stateKey: STORAGE_KEYS.CURRENT_STATE,\n    responsive: true,\n    autoWidth: false,\n    columnDefs: [\n      { targets: '_all', defaultContent: '' }\n    ],\n    ajax: {\n      url: '/BargeDailyExpense/BargeDailyExpenseTable',\n      type: 'POST',\n      data: function(d) {\n        d.bargeId = $('#BargeId').val();\n        d.expenseCategoryId = $('#ExpenseCategoryId').val();\n        d.vendorId = $('#VendorId').val();\n        d.startDate = $('#StartDate').val();\n        d.endDate = $('#EndDate').val();\n        d.minAmount = $('#MinAmount').val();\n        d.maxAmount = $('#MaxAmount').val();\n        d.isPaidOnly = $('#IsPaidOnly').is(':checked');\n        d.isApprovedOnly = $('#IsApprovedOnly').is(':checked');\n      }\n    },\n    columns: [\n      { \n        data: null,\n        name: 'actions',\n        orderable: false,\n        searchable: false,\n        className: 'text-center',\n        width: '80px',\n        render: function(data, type, row) {\n          return '<a href=\"/BargeDailyExpense/Edit/' + row.expenseId + '\" class=\"btn btn-sm btn-primary\"><i class=\"fas fa-edit\"></i></a>';\n        }\n      },\n      { data: 'expenseDate', name: 'expenseDate', render: function(data) { return data ? moment(data).format('MM/DD/YYYY') : ''; } },\n      { data: 'bargeName', name: 'bargeName', defaultContent: '' },\n      { data: 'categoryName', name: 'categoryName', defaultContent: '' },\n      { data: 'description', name: 'description', defaultContent: '' },\n      { data: 'vendorName', name: 'vendorName', defaultContent: '' },\n      { data: 'amount', name: 'amount', className: 'text-end', render: function(data) { return data ? '$' + parseFloat(data).toFixed(2) : '$0.00'; } },\n      { data: 'isPaid', name: 'isPaid', className: 'text-center', render: function(data) { return '<input type=\"checkbox\" ' + (data ? 'checked' : '') + ' disabled />'; } },\n      { data: 'isApproved', name: 'isApproved', className: 'text-center', render: function(data) { return '<input type=\"checkbox\" ' + (data ? 'checked' : '') + ' disabled />'; } }\n    ],\n    order: [[1, 'desc']],\n    pageLength: 25,\n    lengthMenu: [[10, 25, 50, 100], [10, 25, 50, 100]],\n    language: {\n      processing: '<i class=\"fas fa-spinner fa-spin\"></i> Loading...'\n    }\n  });\n\n  $('#btnSearch').click(function() {\n    dataTable.ajax.reload();\n  });\n  \n  $('#btnReset').click(function() {\n    $('#searchForm')[0].reset();\n    $('#BargeId').val('').trigger('change');\n    $('#ExpenseCategoryId').val('').trigger('change');\n    $('#VendorId').val('').trigger('change');\n    dataTable.ajax.reload();\n  });\n  \n  $('#searchForm input[type=\"text\"], #searchForm input[type=\"date\"], #searchForm input[type=\"number\"]').keypress(function(e) {\n    if (e.which == 13) {\n      e.preventDefault();\n      $('#btnSearch').click();\n    }\n  });\n  \n  $('#BargeId, #ExpenseCategoryId, #VendorId').on('change', function() {\n    dataTable.ajax.reload();\n  });\n  \n  $('#IsPaidOnly, #IsApprovedOnly').on('change', function() {\n    dataTable.ajax.reload();\n  });\n});"
    },
    "select2Initialization": {
      "file": "bargeDailyExpenseSearch.js / bargeDailyExpenseEdit.js",
      "description": "Initialize Select2 on all dropdowns",
      "code": "$(function() {\n  // Simple Select2 for categories (small list)\n  $('#ExpenseCategoryId').select2({\n    placeholder: '-- Select Expense Category --',\n    allowClear: true,\n    width: '100%'\n  });\n\n  // AJAX Select2 for barges (large list with search)\n  $('#BargeId').select2({\n    placeholder: '-- Select Barge --',\n    allowClear: true,\n    width: '100%',\n    ajax: {\n      url: '/api/barges',\n      dataType: 'json',\n      delay: 250,\n      data: function(params) {\n        return {\n          search: params.term,\n          page: params.page || 1\n        };\n      },\n      processResults: function(data, params) {\n        params.page = params.page || 1;\n        return {\n          results: data.results,\n          pagination: {\n            more: (params.page * 30) < data.total_count\n          }\n        };\n      },\n      cache: true\n    },\n    minimumInputLength: 2\n  });\n\n  // AJAX Select2 for vendors (large list with search)\n  $('#VendorId').select2({\n    placeholder: '-- Select Vendor --',\n    allowClear: true,\n    width: '100%',\n    ajax: {\n      url: '/api/vendors',\n      dataType: 'json',\n      delay: 250,\n      data: function(params) {\n        return {\n          search: params.term,\n          page: params.page || 1\n        };\n      },\n      processResults: function(data) {\n        return { results: data.results };\n      },\n      cache: true\n    },\n    minimumInputLength: 1\n  });\n});"
    },
    "dateTimeHandling": {
      "file": "bargeDailyExpenseEdit.js",
      "description": "Handle date/time splitting and combining for military time format",
      "code": "function splitDateTime(dateTimeValue, dateFieldId, timeFieldId) {\n  if (dateTimeValue) {\n    var date = new Date(dateTimeValue);\n    if (!isNaN(date.getTime())) {\n      $('#' + dateFieldId).val(date.toISOString().split('T')[0]);\n      var hours = ('0' + date.getHours()).slice(-2);\n      var minutes = ('0' + date.getMinutes()).slice(-2);\n      $('#' + timeFieldId).val(hours + ':' + minutes);\n    }\n  }\n}\n\nfunction combineDateTime(dateFieldId, timeFieldId) {\n  var date = $('#' + dateFieldId).val();\n  var time = $('#' + timeFieldId).val();\n  return (date && time) ? date + 'T' + time + ':00' : (date ? date + 'T00:00:00' : '');\n}\n\n$(function() {\n  var transactionDateTime = '@Model.TransactionDateTime?.ToString(\"o\")';\n  if (transactionDateTime) {\n    splitDateTime(transactionDateTime, 'dtTransactionDate', 'dtTransactionTime');\n  }\n  $('form').on('submit', function() {\n    var combined = combineDateTime('dtTransactionDate', 'dtTransactionTime');\n    if (combined) $('#dtTransactionDate').val(combined);\n  });\n});"
    },
    "validation": {
      "library": "jquery.validate",
      "description": "Client-side validation rules",
      "rules": {
        "ExpenseDate": {
          "required": true
        },
        "BargeId": {
          "required": true
        },
        "ExpenseCategoryId": {
          "required": true
        },
        "Amount": {
          "required": true,
          "min": 0,
          "number": true
        },
        "Quantity": {
          "min": 0,
          "digits": true
        },
        "Description": {
          "maxlength": 500
        }
      },
      "code": "$('#expenseForm').validate({\n  rules: {\n    ExpenseDate: { required: true },\n    BargeId: { required: true },\n    ExpenseCategoryId: { required: true },\n    Amount: { required: true, min: 0, number: true },\n    Quantity: { min: 0, digits: true },\n    Description: { maxlength: 500 }\n  },\n  messages: {\n    ExpenseDate: 'Expense date is required',\n    BargeId: 'Please select a barge',\n    ExpenseCategoryId: 'Please select an expense category',\n    Amount: {\n      required: 'Amount is required',\n      min: 'Amount must be greater than or equal to 0',\n      number: 'Please enter a valid number'\n    }\n  },\n  errorElement: 'div',\n  errorClass: 'invalid-feedback',\n  highlight: function(element) {\n    $(element).addClass('is-invalid').removeClass('is-valid');\n  },\n  unhighlight: function(element) {\n    $(element).removeClass('is-invalid').addClass('is-valid');\n  }\n});"
    },
    "currencyFormatting": {
      "description": "Format currency values for display",
      "code": "function formatCurrency(value) {\n  if (!value) return '$0.00';\n  return new Intl.NumberFormat('en-US', { \n    style: 'currency', \n    currency: 'USD',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2\n  }).format(value);\n}\n\n// Apply to readonly display fields\n$('.currency-display').each(function() {\n  var value = $(this).data('value');\n  $(this).text(formatCurrency(value));\n});\n\n// Real-time formatting on blur\n$('input.currency-input').on('blur', function() {\n  var value = parseFloat($(this).val());\n  if (!isNaN(value)) {\n    $(this).val(value.toFixed(2));\n  }\n});"
    },
    "totalCalculation": {
      "description": "Calculate totals when quantity or unit price changes",
      "code": "function calculateTotal() {\n  var quantity = parseFloat($('#Quantity').val()) || 0;\n  var unitPrice = parseFloat($('#UnitPrice').val()) || 0;\n  var total = quantity * unitPrice;\n  $('#Amount').val(total.toFixed(2));\n}\n\n$('#Quantity, #UnitPrice').on('change blur', function() {\n  calculateTotal();\n});"
    }
  },
  "stylingGuidance": {
    "framework": "Bootstrap 5",
    "colorScheme": {
      "primary": "btn-primary for main actions (Search, Save)",
      "secondary": "btn-secondary for cancel/reset",
      "success": "btn-success for add new, successful operations",
      "info": "btn-info for informational actions",
      "warning": "btn-warning for warnings",
      "danger": "btn-danger for delete operations"
    },
    "spacing": {
      "cards": "mb-3 (margin-bottom)",
      "formGroups": "mb-3",
      "rows": "row with col-md-* for responsive layout"
    },
    "customCSS": [
      "/* Currency input alignment */\n.currency-input {\n  text-align: right;\n}",
      "/* Readonly fields styling */\ninput[readonly] {\n  background-color: #e9ecef;\n  cursor: not-allowed;\n}",
      "/* Checkbox column center alignment */\ntd.checkbox-column {\n  text-align: center;\n  vertical-align: middle;\n}",
      "/* Amount column right alignment */\ntd.amount-column {\n  text-align: right;\n  font-weight: 600;\n}",
      "/* Highlight unpaid/unapproved rows */\ntr.unpaid {\n  background-color: #fff3cd;\n}\n\ntr.unapproved {\n  background-color: #f8d7da;\n}",
      "/* Card header icons */\n.card-header i {\n  margin-right: 0.5rem;\n}",
      "/* Form label required indicator */\nlabel.required::after {\n  content: ' *';\n  color: #dc3545;\n}"
    ]
  },
  "accessibilityConsiderations": [
    "All form inputs have associated <label> elements with asp-for tag helper",
    "Required fields marked with aria-required=\"true\" and visual indicator (*)",
    "Readonly fields have aria-readonly=\"true\" attribute",
    "Validation errors displayed with aria-describedby linking to error messages",
    "Tab navigation follows logical order: date, barge, category, vendor, amount, description, flags, actions",
    "Select2 dropdowns maintain keyboard accessibility (arrow keys, Enter to select, Escape to close)",
    "DataTables grid supports keyboard navigation (Tab, arrow keys, Enter) and screen readers",
    "Icon buttons have title attributes for tooltips and aria-label for screen readers",
    "Checkbox inputs have proper label associations with for attribute",
    "Currency inputs have aria-label for screen reader clarity (e.g., 'Amount in US dollars')",
    "Date inputs use type=\"date\" for native accessibility support"
  ],
  "viewModelStructure": {
    "namespace": "BargeOpsAdmin.ViewModels",
    "searchViewModel": {
      "name": "BargeDailyExpenseSearchViewModel",
      "properties": [
        "int? BargeId",
        "SelectList Barges",
        "int? ExpenseCategoryId",
        "SelectList ExpenseCategories",
        "int? VendorId",
        "SelectList Vendors",
        "DateTime? StartDate",
        "DateTime? EndDate",
        "decimal? MinAmount",
        "decimal? MaxAmount",
        "bool IsPaidOnly",
        "bool IsApprovedOnly"
      ]
    },
    "editViewModel": {
      "name": "BargeDailyExpenseEditViewModel",
      "properties": [
        "int ExpenseId",
        "DateTime ExpenseDate",
        "int BargeId",
        "SelectList Barges",
        "int ExpenseCategoryId",
        "SelectList ExpenseCategories",
        "int? VendorId",
        "SelectList Vendors",
        "decimal Amount",
        "int? Quantity",
        "decimal? UnitPrice",
        "string Description",
        "string ReferenceNumber",
        "bool IsPaid",
        "DateTime? PaidDate",
        "bool IsApproved",
        "DateTime? ApprovedDate",
        "int? ApprovedByUserId",
        "bool IsReconciled",
        "DateTime? ReconciledDate",
        "DateTime? TransactionDateTime",
        "string CreatedBy",
        "DateTime CreatedDate",
        "string ModifiedBy",
        "DateTime? ModifiedDate"
      ]
    }
  },
  "controllerStructure": {
    "namespace": "BargeOpsAdmin.Controllers",
    "name": "BargeDailyExpenseController",
    "baseClass": "AppController",
    "actions": [
      {
        "name": "Index",
        "returnType": "IActionResult",
        "httpMethod": "GET",
        "purpose": "Display search page with initialized ViewModel"
      },
      {
        "name": "BargeDailyExpenseTable",
        "returnType": "IActionResult",
        "httpMethod": "POST",
        "purpose": "Server-side DataTables data source with filtering and pagination"
      },
      {
        "name": "Create",
        "returnType": "IActionResult",
        "httpMethod": "GET",
        "purpose": "Display create form with initialized ViewModel"
      },
      {
        "name": "Create",
        "returnType": "IActionResult",
        "httpMethod": "POST",
        "parameters": ["BargeDailyExpenseEditViewModel model"],
        "purpose": "Handle create form submission with validation"
      },
      {
        "name": "Edit",
        "returnType": "IActionResult",
        "httpMethod": "GET",
        "parameters": ["int id"],
        "purpose": "Display edit form with populated ViewModel"
      },
      {
        "name": "Edit",
        "returnType": "IActionResult",
        "httpMethod": "POST",
        "parameters": ["BargeDailyExpenseEditViewModel model"],
        "purpose": "Handle edit form submission with validation"
      },
      {
        "name": "Delete",
        "returnType": "IActionResult",
        "httpMethod": "POST",
        "parameters": ["int id"],
        "purpose": "Handle delete operation (soft delete recommended)"
      },
      {
        "name": "GetExpenseCategories",
        "returnType": "JsonResult",
        "httpMethod": "GET",
        "purpose": "AJAX endpoint for expense category dropdown"
      },
      {
        "name": "GetBarges",
        "returnType": "JsonResult",
        "httpMethod": "GET",
        "parameters": ["string search", "int page"],
        "purpose": "AJAX endpoint for barge Select2 search"
      },
      {
        "name": "GetVendors",
        "returnType": "JsonResult",
        "httpMethod": "GET",
        "parameters": ["string search", "int page"],
        "purpose": "AJAX endpoint for vendor Select2 search"
      },
      {
        "name": "Export",
        "returnType": "IActionResult",
        "httpMethod": "GET",
        "purpose": "Export filtered expenses to Excel/CSV"
      }
    ]
  },
  "viewStructure": {
    "path": "src/BargeOps.UI/Views/BargeDailyExpense/",
    "files": [
      {
        "name": "Index.cshtml",
        "purpose": "Main search page",
        "includes": [
          "_Search.cshtml partial",
          "_SearchResults.cshtml partial",
          "bargeDailyExpenseSearch.js script"
        ]
      },
      {
        "name": "_Search.cshtml",
        "purpose": "Search form partial",
        "controls": [
          "Barge Select2 (AJAX search)",
          "Expense Category Select2",
          "Vendor Select2 (AJAX search)",
          "Date Range inputs (Start Date, End Date)",
          "Amount Range inputs (Min Amount, Max Amount)",
          "Filter checkboxes (Paid Only, Approved Only)",
          "Search and Reset buttons"
        ]
      },
      {
        "name": "_SearchResults.cshtml",
        "purpose": "DataTables grid container",
        "structure": "Bootstrap card with table-responsive div containing table element"
      },
      {
        "name": "Edit.cshtml",
        "purpose": "Edit form with tabs",
        "sections": [
          "Expense Details tab (date, barge, category, vendor, amount, description)",
          "Attachments tab (file uploads)",
          "History tab (audit trail grid)"
        ]
      },
      {
        "name": "_ExpenseDetails.cshtml",
        "purpose": "Expense details form partial",
        "controls": [
          "Expense Date (date input)",
          "Barge (Select2 dropdown with AJAX)",
          "Expense Category (Select2 dropdown)",
          "Vendor (Select2 dropdown with AJAX)",
          "Quantity (number input)",
          "Unit Price (currency number input)",
          "Amount (currency number input, auto-calculated)",
          "Description (textarea)",
          "Reference Number (text input)",
          "IsPaid (checkbox)",
          "IsApproved (checkbox)",
          "IsReconciled (checkbox)"
        ]
      },
      {
        "name": "_BottomToolbar.cshtml",
        "purpose": "Save, Cancel, Delete buttons"
      }
    ]
  },
  "technicalNotes": [
    "DateTime controls MUST be split into separate date and time inputs using 24-hour format (HH:mm)",
    "Display format for datetime MUST be MM/dd/yyyy HH:mm (military time)",
    "Currency amounts MUST use step=\"0.01\" for two decimal precision",
    "Select2 AJAX endpoints should implement server-side pagination for large datasets",
    "DataTables server-side processing improves performance for large expense lists",
    "Use localStorage for DataTables state persistence across sessions",
    "Implement soft delete instead of hard delete for audit trail preservation",
    "Amount field can be auto-calculated from Quantity × Unit Price if both are present",
    "Search form should auto-reload grid when dropdowns or checkboxes change",
    "Export functionality should respect current search filters",
    "Date range validation: End Date must be >= Start Date",
    "Amount range validation: Max Amount must be >= Min Amount",
    "Consider adding expense approval workflow if IsApproved flag is used",
    "Consider adding payment tracking if IsPaid flag is used with PaidDate"
  ],
  "commonMistakes": [
    "❌ Using datetime-local instead of split date and time inputs",
    "❌ Using 12-hour time format (hh:mm tt) instead of 24-hour (HH:mm)",
    "❌ Not using Select2 for dropdowns with large datasets",
    "❌ Not using DataTables server-side processing for large datasets",
    "❌ Not formatting currency values with two decimal places",
    "❌ Not right-aligning currency/numeric columns in grids",
    "❌ Not implementing AJAX search for Barge and Vendor dropdowns",
    "❌ Forgetting to clear Select2 values on form reset",
    "❌ Not validating date range (End Date >= Start Date)",
    "❌ Not validating amount range (Max Amount >= Min Amount)",
    "❌ Using inline styles instead of Bootstrap utility classes",
    "❌ Not implementing auto-calculation for Amount from Quantity × Unit Price",
    "❌ Not preserving DataTables state across page refreshes",
    "❌ Not handling null/empty values in currency rendering (show $0.00 instead of blank)"
  ],
  "implementationChecklist": [
    "✓ Create BargeDailyExpenseSearchViewModel with search criteria properties",
    "✓ Create BargeDailyExpenseEditViewModel with all expense properties",
    "✓ Create BargeDailyExpenseController inheriting from AppController",
    "✓ Implement Index action (GET) returning search view",
    "✓ Implement BargeDailyExpenseTable action (POST) for DataTables server-side processing",
    "✓ Implement Create actions (GET/POST) with validation",
    "✓ Implement Edit actions (GET/POST) with validation",
    "✓ Implement Delete action (POST) with soft delete",
    "✓ Implement GetBarges AJAX endpoint with pagination",
    "✓ Implement GetVendors AJAX endpoint with pagination",
    "✓ Implement GetExpenseCategories AJAX endpoint",
    "✓ Create Index.cshtml with partials and script reference",
    "✓ Create _Search.cshtml partial with search form",
    "✓ Create _SearchResults.cshtml partial with DataTables table",
    "✓ Create Edit.cshtml with tabbed layout",
    "✓ Create _ExpenseDetails.cshtml partial with form controls",
    "✓ Create bargeDailyExpenseSearch.js with DataTables initialization",
    "✓ Create bargeDailyExpenseEdit.js with Select2, validation, calculations",
    "✓ Add Select2 initialization for all dropdowns",
    "✓ Add DataTables initialization with server-side processing and state save",
    "✓ Add jquery.validate validation rules",
    "✓ Add date/time split handling for datetime fields",
    "✓ Add currency formatting for amount display",
    "✓ Add auto-calculation for Amount from Quantity × Unit Price",
    "✓ Add auto-reload for grid when filters change",
    "✓ Add keyboard shortcuts (Enter to search, Tab navigation)",
    "✓ Test date range validation (End >= Start)",
    "✓ Test amount range validation (Max >= Min)",
    "✓ Test Select2 AJAX search for Barges and Vendors",
    "✓ Test DataTables filtering, sorting, pagination",
    "✓ Test form validation and error display",
    "✓ Test accessibility with screen reader",
    "✓ Test responsive layout on mobile devices"
  ]
}
