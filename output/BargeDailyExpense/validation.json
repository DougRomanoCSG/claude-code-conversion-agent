{
  "entity": "BargeDailyExpense",
  "extractionDate": "2025-12-22",
  "sourceFiles": [
    "BargeDailyExpense.vb:38-49",
    "BargeDailyExpenseBase.vb:244-267",
    "BargeDailyExpenseDate.vb:38-44",
    "BargeDailyExpenseDateBase.vb:178-189"
  ],
  "parentEntity": {
    "name": "BargeDailyExpenseDate",
    "relationship": "OneToMany",
    "foreignKey": "BargeDailyExpenseDateID"
  },
  "formValidation": {
    "method": "Not found - no UI form validation detected",
    "rules": [],
    "notes": "No ASPX or ASCX files found for this entity. Validation appears to be server-side only through business objects."
  },
  "businessValidation": {
    "method": "CheckBusinessRules",
    "baseClassFile": "BargeDailyExpenseBase.vb:244-267",
    "rules": [
      {
        "ruleName": "DailyExpenseRequired",
        "property": "DailyExpense",
        "field": "p_DailyExpense",
        "condition": "String.IsNullOrEmpty(p_DailyExpense)",
        "message": "Daily Expense is required.",
        "severity": "Error",
        "alwaysApplies": true,
        "validationType": "Required",
        "sourceLocation": "BargeDailyExpenseBase.vb:249-252",
        "trigger": "OnPropertyChange",
        "notes": "Triggered when DailyExpense property is set or on Initialize. Uses BrokenRules.Assert with cIsRequiredName and cIsRequiredDesc constants."
      },
      {
        "ruleName": "SizeCategoryMaxLength",
        "property": "SizeCategory",
        "field": "p_SizeCategory",
        "condition": "p_SizeCategory.Length > MaxLength.SizeCategory",
        "message": "Size Category maximum length is 15.",
        "severity": "Error",
        "alwaysApplies": true,
        "validationType": "MaxLength",
        "maxLength": 15,
        "sourceLocation": "BargeDailyExpenseBase.vb:254-258",
        "trigger": "OnPropertyChange",
        "notes": "MaxLength constant defined in MaxLength.SizeCategory = 15 (line 354)"
      },
      {
        "ruleName": "CoverTypeMaxLength",
        "property": "CoverType",
        "field": "p_CoverType",
        "condition": "p_CoverType.Length > MaxLength.CoverType",
        "message": "Cover Type maximum length is 3.",
        "severity": "Error",
        "alwaysApplies": true,
        "validationType": "MaxLength",
        "maxLength": 3,
        "sourceLocation": "BargeDailyExpenseBase.vb:260-264",
        "trigger": "OnPropertyChange",
        "notes": "MaxLength constant defined in MaxLength.CoverType = 3 (line 355)"
      }
    ]
  },
  "parentValidation": {
    "entity": "BargeDailyExpenseDate",
    "method": "CheckBusinessRules",
    "baseClassFile": "BargeDailyExpenseDateBase.vb:178-189",
    "rules": [
      {
        "ruleName": "EffectiveDateRequired",
        "property": "EffectiveDate",
        "field": "p_EffectiveDate",
        "condition": "p_EffectiveDate.IsEmpty",
        "message": "Effective date is required.",
        "severity": "Error",
        "alwaysApplies": true,
        "validationType": "Required",
        "sourceLocation": "BargeDailyExpenseDateBase.vb:183-186",
        "trigger": "OnPropertyChange",
        "notes": "Parent entity validation. Display name customized in BargeDailyExpenseDate.vb:26"
      }
    ]
  },
  "fieldConstraints": [
    {
      "field": "BargeDailyExpenseID",
      "propertyName": "BargeDailyExpenseID",
      "dataType": "Int32",
      "isPrimaryKey": true,
      "isNullable": false,
      "isReadOnly": true,
      "defaultValue": 0,
      "dbType": "SqlDbType.Int",
      "validations": []
    },
    {
      "field": "BargeDailyExpenseDateID",
      "propertyName": "BargeDailyExpenseDateID",
      "dataType": "Int32",
      "isForeignKey": true,
      "isNullable": false,
      "isReadOnly": false,
      "defaultValue": 0,
      "dbType": "SqlDbType.Int",
      "validations": [],
      "notes": "Foreign key to parent BargeDailyExpenseDate. Updated via UpdateParentKeys method."
    },
    {
      "field": "DailyExpense",
      "propertyName": "DailyExpense",
      "displayName": "Daily Expense",
      "dataType": "String",
      "underlyingType": "Currency/Money",
      "isNullable": false,
      "isReadOnly": false,
      "defaultValue": "String.Empty",
      "dbType": "SqlDbType.Money",
      "validations": [
        "Required"
      ],
      "propertyHandler": "GetCurrencyProp/SetCurrencyProp",
      "notes": "Currency field handled via GetCurrencyProp and SetCurrencyProp methods. Stored as string in business layer but maps to Money in database."
    },
    {
      "field": "SizeCategory",
      "propertyName": "SizeCategory",
      "displayName": "Size Category",
      "dataType": "String",
      "isNullable": true,
      "isReadOnly": false,
      "defaultValue": "String.Empty",
      "maxLength": 15,
      "dbType": "SqlDbType.VarChar",
      "validations": [
        "MaxLength(15)"
      ],
      "propertyHandler": "SetStringProp",
      "notes": "Display name customized in BargeDailyExpense.vb:28"
    },
    {
      "field": "CoverType",
      "propertyName": "CoverType",
      "displayName": "Cover Type",
      "dataType": "String",
      "isNullable": true,
      "isReadOnly": false,
      "defaultValue": "String.Empty",
      "maxLength": 3,
      "dbType": "SqlDbType.VarChar",
      "validations": [
        "MaxLength(3)"
      ],
      "propertyHandler": "SetStringProp",
      "notes": "Display name customized in BargeDailyExpense.vb:29. Short max length suggests code/abbreviation field."
    },
    {
      "field": "CoverSubTypeID",
      "propertyName": "CoverSubTypeID",
      "displayName": "Sub Type",
      "dataType": "String",
      "underlyingType": "Int32",
      "isNullable": true,
      "isReadOnly": false,
      "defaultValue": "String.Empty",
      "dbType": "SqlDbType.Int",
      "validations": [],
      "propertyHandler": "SetInt32Prop",
      "notes": "Display name customized in BargeDailyExpense.vb:30. Stored as string but converts to Int32. Likely references another lookup table."
    },
    {
      "field": "IsCharteredIn",
      "propertyName": "IsCharteredIn",
      "displayName": "Chartered-In",
      "dataType": "Boolean",
      "isNullable": false,
      "isReadOnly": false,
      "defaultValue": false,
      "dbType": "SqlDbType.Bit",
      "validations": [],
      "propertyHandler": "SetBooleanProp",
      "notes": "Display name customized in BargeDailyExpense.vb:31"
    }
  ],
  "validationPatterns": [
    {
      "pattern": "RequiredField",
      "fields": ["DailyExpense"],
      "implementation": "BrokenRules.Assert with String.IsNullOrEmpty check",
      "errorFormat": "{DisplayName} is required.",
      "notes": "Standard required field pattern used across framework"
    },
    {
      "pattern": "MaxLengthValidation",
      "fields": ["SizeCategory", "CoverType"],
      "implementation": "BrokenRules.Assert with Length > MaxLength check",
      "errorFormat": "{DisplayName} maximum length is {MaxLength}.",
      "notes": "Uses MaxLength nested class constants for length values"
    },
    {
      "pattern": "CurrencyField",
      "fields": ["DailyExpense"],
      "implementation": "GetCurrencyProp/SetCurrencyProp handlers",
      "notes": "Currency fields use special property handlers for formatting and validation"
    },
    {
      "pattern": "TypedStringField",
      "fields": ["CoverSubTypeID"],
      "implementation": "SetInt32Prop handler",
      "notes": "String property that converts to Int32 internally using SetInt32Prop"
    }
  ],
  "modernValidationMapping": {
    "dataAnnotations": [
      {
        "property": "DailyExpense",
        "annotations": [
          "[Required(ErrorMessage = \"Daily Expense is required.\")]",
          "[DataType(DataType.Currency)]",
          "[DisplayName(\"Daily Expense\")]"
        ]
      },
      {
        "property": "SizeCategory",
        "annotations": [
          "[StringLength(15, ErrorMessage = \"Size Category maximum length is 15.\")]",
          "[DisplayName(\"Size Category\")]"
        ]
      },
      {
        "property": "CoverType",
        "annotations": [
          "[StringLength(3, ErrorMessage = \"Cover Type maximum length is 3.\")]",
          "[DisplayName(\"Cover Type\")]"
        ]
      },
      {
        "property": "CoverSubTypeID",
        "annotations": [
          "[DisplayName(\"Sub Type\")]"
        ]
      },
      {
        "property": "IsCharteredIn",
        "annotations": [
          "[DisplayName(\"Chartered-In\")]"
        ]
      }
    ],
    "fluentValidation": {
      "className": "BargeDailyExpenseValidator",
      "rules": [
        "RuleFor(x => x.DailyExpense)",
        "    .NotEmpty().WithMessage(\"Daily Expense is required.\")",
        "    .Must(BeValidCurrency).WithMessage(\"Daily Expense must be a valid currency value.\");",
        "",
        "RuleFor(x => x.SizeCategory)",
        "    .MaximumLength(15).WithMessage(\"Size Category maximum length is 15.\");",
        "",
        "RuleFor(x => x.CoverType)",
        "    .MaximumLength(3).WithMessage(\"Cover Type maximum length is 3.\");",
        "",
        "RuleFor(x => x.BargeDailyExpenseDateID)",
        "    .GreaterThan(0).WithMessage(\"A valid Daily Expense Date is required.\");"
      ],
      "customValidators": [
        {
          "method": "BeValidCurrency",
          "implementation": "private bool BeValidCurrency(string value) => decimal.TryParse(value, out _);"
        }
      ]
    },
    "clientSideValidation": {
      "jQueryValidate": [
        {
          "field": "DailyExpense",
          "rules": {
            "required": true,
            "number": true
          },
          "messages": {
            "required": "Daily Expense is required.",
            "number": "Daily Expense must be a valid number."
          }
        },
        {
          "field": "SizeCategory",
          "rules": {
            "maxlength": 15
          },
          "messages": {
            "maxlength": "Size Category maximum length is 15."
          }
        },
        {
          "field": "CoverType",
          "rules": {
            "maxlength": 3
          },
          "messages": {
            "maxlength": "Cover Type maximum length is 3."
          }
        }
      ]
    }
  },
  "validationTriggers": [
    {
      "event": "OnInitialize",
      "description": "CheckBusinessRules called with empty string to validate all properties",
      "location": "BargeDailyExpenseBase.vb:233"
    },
    {
      "event": "OnPropertyChange",
      "description": "CheckBusinessRules called with specific property name when property value changes",
      "properties": [
        "BargeDailyExpenseDateID",
        "DailyExpense",
        "SizeCategory",
        "CoverType",
        "CoverSubTypeID",
        "IsCharteredIn"
      ],
      "notes": "Each property setter calls CheckBusinessRules and FieldAudit when value changes"
    },
    {
      "event": "OnSave",
      "description": "IsValid property checked before allowing save operation",
      "notes": "Parent BargeDailyExpenseDate.IsValid includes child collection validation"
    }
  ],
  "crossEntityValidation": [
    {
      "description": "Parent-Child Validation",
      "rule": "BargeDailyExpenseDate must be valid before children can be valid",
      "implementation": "BargeDailyExpenseDateBase.IsValid checks MyBase.IsValid AndAlso p_BargeDailyExpenses.IsValid",
      "location": "BargeDailyExpenseDateBase.vb:130-136"
    }
  ],
  "databaseConstraints": {
    "primaryKey": "BargeDailyExpenseID",
    "foreignKeys": [
      {
        "column": "BargeDailyExpenseDateID",
        "referencedTable": "BargeDailyExpenseDate",
        "referencedColumn": "BargeDailyExpenseDateID"
      }
    ],
    "notNullColumns": [
      "BargeDailyExpenseID",
      "BargeDailyExpenseDateID",
      "DailyExpense",
      "IsCharteredIn"
    ],
    "storedProcedures": {
      "select": "BargeDailyExpenseSelect",
      "selectAll": "BargeDailyExpensesSelect",
      "insert": "BargeDailyExpenseInsert",
      "update": "BargeDailyExpenseUpdate",
      "delete": "BargeDailyExpenseDelete"
    }
  },
  "auditingConfiguration": {
    "enabled": true,
    "auditedFields": [
      "BargeDailyExpenseID",
      "BargeDailyExpenseDateID",
      "DailyExpense",
      "SizeCategory",
      "CoverType",
      "CoverSubTypeID",
      "IsCharteredIn"
    ],
    "notes": "All fields tracked for auditing via SaveOriginalAuditValues and FieldAudit methods",
    "implementation": "AuditFieldEvent objects created on field changes and persisted via UpdateChildObjects"
  },
  "conversionNotes": {
    "frameworkDifferences": [
      "Legacy VB.NET uses BrokenRules.Assert pattern for validation",
      "Modern approach should use Data Annotations for simple rules and FluentValidation for complex scenarios",
      "Currency handling via GetCurrencyProp/SetCurrencyProp should map to [DataType(DataType.Currency)] and decimal type",
      "String-stored integers (CoverSubTypeID) should be converted to actual Int32? nullable types in modern implementation"
    ],
    "recommendedApproach": [
      "Use Data Annotations for basic validations (Required, MaxLength, Display)",
      "Implement FluentValidation for business rule validation layer",
      "Add client-side validation using jquery.validate or modern JavaScript framework validation",
      "Convert currency string handling to proper decimal types with appropriate formatting",
      "Maintain parent-child validation pattern in modern MVVM approach"
    ],
    "potentialIssues": [
      "No UI form validation found - may need to be implemented during conversion",
      "Currency stored as string internally may cause formatting/parsing issues",
      "CoverSubTypeID stored as string but used as integer - type safety concern",
      "Validation messages are hardcoded - consider externalization for localization",
      "No range validation on DailyExpense - may want to add min/max constraints"
    ],
    "testingConsiderations": [
      "Test required field validation for DailyExpense",
      "Test max length enforcement for SizeCategory (15) and CoverType (3)",
      "Test currency parsing and formatting for DailyExpense",
      "Test parent-child validation cascade",
      "Test that validation fires on property change and on save",
      "Verify field auditing captures all changes correctly"
    ]
  }
}
