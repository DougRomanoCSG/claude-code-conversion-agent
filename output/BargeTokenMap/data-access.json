{
  "entity": "BargeTokenMap",
  "softDelete": false,
  "hasIsActive": false,
  "deleteType": "hard",
  "architecture": {
    "dtoNamespace": "BargeOps.Shared.Dto",
    "repositoryInterfaceNamespace": "Admin.Infrastructure.Abstractions",
    "repositoryImplementationNamespace": "Admin.Infrastructure.Repositories",
    "sqlFilesPath": "src/BargeOps.API/src/Admin.Infrastructure/DataAccess/Sql/BargeTokenMap",
    "sqlResourcePattern": "SqlText.Get(\"BargeTokenMap.{OperationName}\")"
  },
  "legacyStoredProcedures": [
    {
      "name": "BargeTokenMapSearch",
      "operation": "Search",
      "usedBy": "BargeTokenMapList.vb:56",
      "parameters": [
        {
          "name": "@FieldName",
          "dbType": "VarChar",
          "clrType": "string",
          "required": true,
          "source": "BargeTokenMapList.vb:67"
        },
        {
          "name": "@DisplayType",
          "dbType": "VarChar",
          "clrType": "string",
          "required": true,
          "source": "BargeTokenMapList.vb:68"
        },
        {
          "name": "@FleetID",
          "dbType": "Int",
          "clrType": "int",
          "required": true,
          "source": "BargeTokenMapList.vb:69"
        }
      ],
      "resultColumns": [
        {
          "column": "BargeTokenMapID",
          "property": "BargeTokenMapID",
          "type": "int",
          "source": "BargeTokenMapList.vb:91"
        },
        {
          "column": "FieldValue",
          "property": "FieldValue",
          "type": "string",
          "source": "BargeTokenMapList.vb:92"
        },
        {
          "column": "SymbolValue",
          "property": "SymbolValue",
          "type": "string",
          "source": "BargeTokenMapList.vb:93"
        },
        {
          "column": "ColorPairID",
          "property": "ColorPairID",
          "type": "int",
          "source": "BargeTokenMapList.vb:94"
        },
        {
          "column": "ColorName",
          "property": "ColorName",
          "type": "string",
          "source": "BargeTokenMapList.vb:95"
        },
        {
          "column": "TextColor",
          "property": "TextColor",
          "type": "string",
          "transformation": "System.Drawing.Color.FromName()",
          "source": "BargeTokenMapList.vb:96"
        },
        {
          "column": "BackColor",
          "property": "BackColor",
          "type": "string",
          "transformation": "System.Drawing.Color.FromName()",
          "source": "BargeTokenMapList.vb:97"
        },
        {
          "column": "PictureID",
          "property": "PictureID",
          "type": "int",
          "source": "BargeTokenMapList.vb:98"
        },
        {
          "column": "Picture",
          "property": "Picture",
          "type": "byte[]",
          "transformation": "Binary to System.Drawing.Image via MemoryStream",
          "source": "BargeTokenMapList.vb:99-106"
        }
      ]
    },
    {
      "name": "BargeTokenMapFieldValueSelect",
      "operation": "GetFieldValues",
      "usedBy": "BargeTokenMapFieldValueList.vb:54",
      "parameters": [
        {
          "name": "@FieldName",
          "dbType": "VarChar",
          "clrType": "string",
          "required": true,
          "source": "BargeTokenMapFieldValueList.vb:65"
        },
        {
          "name": "@FleetID",
          "dbType": "Int",
          "clrType": "int",
          "required": true,
          "source": "BargeTokenMapFieldValueList.vb:66"
        }
      ],
      "resultColumns": [
        {
          "column": "FieldValue",
          "property": "FieldValue",
          "type": "string",
          "source": "BargeTokenMapFieldValueList.vb:82"
        }
      ]
    },
    {
      "name": "BargeTokenMapSelect",
      "operation": "GetById",
      "usedBy": "BargeTokenMapBase.vb:274",
      "parameters": [
        {
          "name": "@BargeTokenMapID",
          "dbType": "Int",
          "clrType": "int",
          "required": true,
          "source": "BargeTokenMapBase.vb:463"
        }
      ],
      "resultColumns": [
        {
          "column": "BargeTokenMapID",
          "property": "BargeTokenMapID",
          "type": "int",
          "source": "BargeTokenMapBase.vb:587"
        },
        {
          "column": "FleetID",
          "property": "FleetID",
          "type": "int",
          "source": "BargeTokenMapBase.vb:588"
        },
        {
          "column": "FieldName",
          "property": "FieldName",
          "type": "string",
          "source": "BargeTokenMapBase.vb:589"
        },
        {
          "column": "FieldValue",
          "property": "FieldValue",
          "type": "string",
          "source": "BargeTokenMapBase.vb:590"
        },
        {
          "column": "DisplayType",
          "property": "DisplayType",
          "type": "string",
          "source": "BargeTokenMapBase.vb:591"
        },
        {
          "column": "SymbolValue",
          "property": "SymbolValue",
          "type": "string",
          "source": "BargeTokenMapBase.vb:592"
        },
        {
          "column": "ColorPairID",
          "property": "ColorPairID",
          "type": "string",
          "transformation": "Stored as string, represents int",
          "source": "BargeTokenMapBase.vb:593"
        },
        {
          "column": "PictureID",
          "property": "PictureID",
          "type": "string",
          "transformation": "Stored as string, represents int",
          "source": "BargeTokenMapBase.vb:594"
        },
        {
          "column": "IsGenerated",
          "property": "IsGenerated",
          "type": "bool",
          "source": "BargeTokenMapBase.vb:595"
        },
        {
          "column": "LocationType",
          "property": "LocationType",
          "type": "string",
          "source": "BargeTokenMap.vb:171",
          "note": "Additional field loaded in custom class"
        }
      ]
    },
    {
      "name": "BargeTokenMapsSelect",
      "operation": "GetAll",
      "usedBy": "BargeTokenMapBase.vb:275",
      "parameters": [],
      "resultColumns": "Same as BargeTokenMapSelect"
    },
    {
      "name": "BargeTokenMapInsert",
      "operation": "Insert",
      "usedBy": "BargeTokenMapBase.vb:276",
      "parameters": [
        {
          "name": "@BargeTokenMapID",
          "dbType": "Int",
          "direction": "InputOutput",
          "clrType": "int",
          "source": "BargeTokenMapBase.vb:472-473"
        },
        {
          "name": "@FleetID",
          "dbType": "Int",
          "clrType": "int",
          "source": "BargeTokenMapBase.vb:486"
        },
        {
          "name": "@FieldName",
          "dbType": "VarChar",
          "clrType": "string",
          "source": "BargeTokenMapBase.vb:487"
        },
        {
          "name": "@FieldValue",
          "dbType": "VarChar",
          "clrType": "string",
          "source": "BargeTokenMapBase.vb:488"
        },
        {
          "name": "@DisplayType",
          "dbType": "VarChar",
          "clrType": "string",
          "source": "BargeTokenMapBase.vb:489"
        },
        {
          "name": "@SymbolValue",
          "dbType": "NChar",
          "clrType": "string",
          "maxLength": 1,
          "source": "BargeTokenMapBase.vb:490"
        },
        {
          "name": "@ColorPairID",
          "dbType": "Int",
          "clrType": "int",
          "nullable": true,
          "source": "BargeTokenMapBase.vb:491"
        },
        {
          "name": "@PictureID",
          "dbType": "Int",
          "clrType": "int",
          "nullable": true,
          "source": "BargeTokenMapBase.vb:492"
        },
        {
          "name": "@IsGenerated",
          "dbType": "Bit",
          "clrType": "bool",
          "source": "BargeTokenMapBase.vb:493"
        }
      ],
      "outputParameters": [
        {
          "name": "@BargeTokenMapID",
          "description": "Returns generated primary key",
          "source": "BargeTokenMapBase.vb:555-556"
        }
      ]
    },
    {
      "name": "BargeTokenMapUpdate",
      "operation": "Update",
      "usedBy": "BargeTokenMapBase.vb:277",
      "parameters": [
        {
          "name": "@BargeTokenMapID",
          "dbType": "Int",
          "clrType": "int",
          "source": "BargeTokenMapBase.vb:502"
        },
        {
          "name": "@FleetID",
          "dbType": "Int",
          "clrType": "int",
          "source": "BargeTokenMapBase.vb:515"
        },
        {
          "name": "@FieldName",
          "dbType": "VarChar",
          "clrType": "string",
          "source": "BargeTokenMapBase.vb:516"
        },
        {
          "name": "@FieldValue",
          "dbType": "VarChar",
          "clrType": "string",
          "source": "BargeTokenMapBase.vb:517"
        },
        {
          "name": "@DisplayType",
          "dbType": "VarChar",
          "clrType": "string",
          "source": "BargeTokenMapBase.vb:518"
        },
        {
          "name": "@SymbolValue",
          "dbType": "NChar",
          "clrType": "string",
          "maxLength": 1,
          "source": "BargeTokenMapBase.vb:519"
        },
        {
          "name": "@ColorPairID",
          "dbType": "Int",
          "clrType": "int",
          "nullable": true,
          "source": "BargeTokenMapBase.vb:520"
        },
        {
          "name": "@PictureID",
          "dbType": "Int",
          "clrType": "int",
          "nullable": true,
          "source": "BargeTokenMapBase.vb:521"
        },
        {
          "name": "@IsGenerated",
          "dbType": "Bit",
          "clrType": "bool",
          "source": "BargeTokenMapBase.vb:522"
        }
      ]
    },
    {
      "name": "BargeTokenMapDelete",
      "operation": "Delete",
      "usedBy": "BargeTokenMapBase.vb:278",
      "deleteType": "Hard Delete",
      "parameters": [
        {
          "name": "@BargeTokenMapID",
          "dbType": "Int",
          "clrType": "int",
          "source": "BargeTokenMapBase.vb:542"
        }
      ]
    }
  ],
  "modernSqlFiles": [
    {
      "fileName": "BargeTokenMap_Search.sql",
      "operation": "Search",
      "description": "Search BargeTokenMap by FieldName, DisplayType, and FleetID with color and picture data",
      "legacyStoredProcedure": "BargeTokenMapSearch",
      "returnType": "IEnumerable<BargeTokenMapDto>",
      "parameters": ["string fieldName", "string displayType", "int fleetId"],
      "embeddedResource": true
    },
    {
      "fileName": "BargeTokenMap_GetFieldValues.sql",
      "operation": "GetFieldValues",
      "description": "Get distinct field values for a given FieldName and FleetID",
      "legacyStoredProcedure": "BargeTokenMapFieldValueSelect",
      "returnType": "IEnumerable<string>",
      "parameters": ["string fieldName", "int fleetId"],
      "embeddedResource": true
    },
    {
      "fileName": "BargeTokenMap_GetById.sql",
      "operation": "GetById",
      "description": "Fetch single BargeTokenMap record by ID",
      "legacyStoredProcedure": "BargeTokenMapSelect",
      "returnType": "Task<BargeTokenMapDto>",
      "parameters": ["int bargeTokenMapId"],
      "embeddedResource": true
    },
    {
      "fileName": "BargeTokenMap_GetAll.sql",
      "operation": "GetAll",
      "description": "Fetch all BargeTokenMap records",
      "legacyStoredProcedure": "BargeTokenMapsSelect",
      "returnType": "Task<IEnumerable<BargeTokenMapDto>>",
      "parameters": [],
      "embeddedResource": true
    },
    {
      "fileName": "BargeTokenMap_Insert.sql",
      "operation": "Insert",
      "description": "Create new BargeTokenMap record",
      "legacyStoredProcedure": "BargeTokenMapInsert",
      "returnType": "Task<int>",
      "returns": "New BargeTokenMapID",
      "parameters": ["BargeTokenMapDto bargeTokenMap"],
      "embeddedResource": true
    },
    {
      "fileName": "BargeTokenMap_Update.sql",
      "operation": "Update",
      "description": "Update existing BargeTokenMap record",
      "legacyStoredProcedure": "BargeTokenMapUpdate",
      "returnType": "Task",
      "parameters": ["BargeTokenMapDto bargeTokenMap"],
      "embeddedResource": true
    },
    {
      "fileName": "BargeTokenMap_Delete.sql",
      "operation": "Delete",
      "description": "Hard delete BargeTokenMap record (no IsActive field)",
      "legacyStoredProcedure": "BargeTokenMapDelete",
      "returnType": "Task<bool>",
      "parameters": ["int bargeTokenMapId"],
      "embeddedResource": true,
      "note": "HARD DELETE - No soft delete support"
    }
  ],
  "dtoDefinition": {
    "name": "BargeTokenMapDto",
    "namespace": "BargeOps.Shared.Dto",
    "properties": [
      {
        "name": "BargeTokenMapID",
        "type": "int",
        "required": false,
        "description": "Primary key, auto-generated on insert"
      },
      {
        "name": "FleetID",
        "type": "int",
        "required": true
      },
      {
        "name": "FieldName",
        "type": "string",
        "maxLength": 50,
        "required": true
      },
      {
        "name": "FieldValue",
        "type": "string",
        "maxLength": 200,
        "required": true
      },
      {
        "name": "DisplayType",
        "type": "string",
        "maxLength": 20,
        "required": true,
        "values": ["Color", "Picture", "Symbol"]
      },
      {
        "name": "SymbolValue",
        "type": "string",
        "maxLength": 1,
        "required": false,
        "requiredWhen": "DisplayType = 'Symbol'"
      },
      {
        "name": "ColorPairID",
        "type": "int?",
        "required": false,
        "requiredWhen": "DisplayType = 'Color'"
      },
      {
        "name": "ColorName",
        "type": "string",
        "required": false,
        "description": "Joined from ColorPair table in search"
      },
      {
        "name": "TextColor",
        "type": "string",
        "required": false,
        "description": "Color name for text (e.g., 'Black', 'White')"
      },
      {
        "name": "BackColor",
        "type": "string",
        "required": false,
        "description": "Color name for background (e.g., 'Red', 'Blue')"
      },
      {
        "name": "PictureID",
        "type": "int?",
        "required": false,
        "requiredWhen": "DisplayType = 'Picture'"
      },
      {
        "name": "Picture",
        "type": "byte[]",
        "required": false,
        "description": "Binary image data, loaded from Picture table"
      },
      {
        "name": "IsGenerated",
        "type": "bool",
        "required": true,
        "default": false
      },
      {
        "name": "LocationType",
        "type": "string",
        "required": false,
        "description": "Additional field loaded in GetById operation"
      }
    ],
    "listQueryAttributes": {
      "filterable": true,
      "sortable": true
    }
  },
  "repositoryInterface": {
    "name": "IBargeTokenMapRepository",
    "namespace": "Admin.Infrastructure.Abstractions",
    "filePath": "src/BargeOps.API/src/Admin.Infrastructure/Abstractions/IBargeTokenMapRepository.cs",
    "methods": [
      {
        "name": "SearchAsync",
        "returnType": "Task<IEnumerable<BargeTokenMapDto>>",
        "parameters": [
          "string fieldName",
          "string displayType",
          "int fleetId",
          "CancellationToken cancellationToken = default"
        ],
        "description": "Search for BargeTokenMap records with color and picture data"
      },
      {
        "name": "GetFieldValuesAsync",
        "returnType": "Task<IEnumerable<string>>",
        "parameters": [
          "string fieldName",
          "int fleetId",
          "CancellationToken cancellationToken = default"
        ],
        "description": "Get distinct field values for dropdown population"
      },
      {
        "name": "GetByIdAsync",
        "returnType": "Task<BargeTokenMapDto>",
        "parameters": [
          "int bargeTokenMapId",
          "CancellationToken cancellationToken = default"
        ],
        "description": "Get single BargeTokenMap by ID"
      },
      {
        "name": "GetAllAsync",
        "returnType": "Task<IEnumerable<BargeTokenMapDto>>",
        "parameters": [
          "CancellationToken cancellationToken = default"
        ],
        "description": "Get all BargeTokenMap records"
      },
      {
        "name": "InsertAsync",
        "returnType": "Task<int>",
        "parameters": [
          "BargeTokenMapDto bargeTokenMap",
          "CancellationToken cancellationToken = default"
        ],
        "description": "Create new BargeTokenMap and return generated ID"
      },
      {
        "name": "UpdateAsync",
        "returnType": "Task",
        "parameters": [
          "BargeTokenMapDto bargeTokenMap",
          "CancellationToken cancellationToken = default"
        ],
        "description": "Update existing BargeTokenMap"
      },
      {
        "name": "DeleteAsync",
        "returnType": "Task<bool>",
        "parameters": [
          "int bargeTokenMapId",
          "CancellationToken cancellationToken = default"
        ],
        "description": "Hard delete BargeTokenMap (no soft delete)"
      }
    ]
  },
  "repositoryImplementation": {
    "name": "BargeTokenMapRepository",
    "namespace": "Admin.Infrastructure.Repositories",
    "filePath": "src/BargeOps.API/src/Admin.Infrastructure/Repositories/BargeTokenMapRepository.cs",
    "dependencies": [
      "IDbConnectionFactory",
      "IDbHelper"
    ],
    "sqlTextEntries": [
      "GetBargeTokenMapSearch => Get(\"BargeTokenMap.Search\")",
      "GetBargeTokenMapFieldValues => Get(\"BargeTokenMap.GetFieldValues\")",
      "GetBargeTokenMapById => Get(\"BargeTokenMap.GetById\")",
      "GetBargeTokenMapAll => Get(\"BargeTokenMap.GetAll\")",
      "InsertBargeTokenMap => Get(\"BargeTokenMap.Insert\")",
      "UpdateBargeTokenMap => Get(\"BargeTokenMap.Update\")",
      "DeleteBargeTokenMap => Get(\"BargeTokenMap.Delete\")"
    ],
    "pattern": "Dapper with SqlText.Get() for embedded SQL resources"
  },
  "businessRules": [
    {
      "rule": "FieldName is required",
      "maxLength": 50,
      "source": "BargeTokenMapBase.vb:287-293"
    },
    {
      "rule": "FieldValue is required (except when DeferredDelete = true)",
      "maxLength": 200,
      "source": "BargeTokenMapBase.vb:295-301, BargeTokenMap.vb:134-141"
    },
    {
      "rule": "DisplayType is required",
      "maxLength": 20,
      "values": ["Color", "Picture", "Symbol"],
      "source": "BargeTokenMapBase.vb:303-309"
    },
    {
      "rule": "SymbolValue required when DisplayType = 'Symbol'",
      "maxLength": 1,
      "source": "BargeTokenMap.vb:115-118"
    },
    {
      "rule": "ColorPairID required when DisplayType = 'Color' and not DeferredDelete",
      "source": "BargeTokenMap.vb:120-127"
    },
    {
      "rule": "PictureID required when DisplayType = 'Picture'",
      "source": "BargeTokenMap.vb:129-132"
    },
    {
      "rule": "SymbolValue max length 1 character",
      "source": "BargeTokenMapBase.vb:311-315"
    }
  ],
  "dataTransformations": [
    {
      "field": "TextColor",
      "legacyPattern": "System.Drawing.Color.FromName(dr.GetStringValue('TextColor'))",
      "modernPattern": "Store as string, transform to hex or RGB on client side",
      "source": "BargeTokenMapList.vb:96"
    },
    {
      "field": "BackColor",
      "legacyPattern": "System.Drawing.Color.FromName(dr.GetStringValue('BackColor'))",
      "modernPattern": "Store as string, transform to hex or RGB on client side",
      "source": "BargeTokenMapList.vb:97"
    },
    {
      "field": "Picture",
      "legacyPattern": "Binary data -> MemoryStream -> System.Drawing.Image",
      "modernPattern": "Return byte[] directly, client converts to image",
      "source": "BargeTokenMapList.vb:99-106"
    },
    {
      "field": "ColorPairID",
      "legacyPattern": "Stored as string in legacy, represents int",
      "modernPattern": "Use int? (nullable int)",
      "source": "BargeTokenMapBase.vb:185-198"
    },
    {
      "field": "PictureID",
      "legacyPattern": "Stored as string in legacy, represents int",
      "modernPattern": "Use int? (nullable int)",
      "source": "BargeTokenMapBase.vb:200-213"
    }
  ],
  "specialFeatures": [
    {
      "feature": "DeferredDelete",
      "description": "Custom deletion pattern that allows marking for deletion without immediate deletion",
      "implementation": "Friend property that marks object for deletion on Save, not on MarkDeleted call",
      "source": "BargeTokenMap.vb:64-72, 184-191",
      "modernEquivalent": "Not needed - use standard repository Delete pattern"
    },
    {
      "feature": "Color Integration",
      "description": "Joins to ColorPair table to get TextColor, BackColor, and ColorName",
      "tables": ["ColorPair"],
      "source": "BargeTokenMapList.vb:94-97"
    },
    {
      "feature": "Picture Binary Data",
      "description": "Stores and retrieves binary image data from Picture table",
      "tables": ["Picture"],
      "source": "BargeTokenMapList.vb:98-106"
    },
    {
      "feature": "DisplayType-based Validation",
      "description": "Different required fields based on DisplayType (Symbol, Color, Picture)",
      "values": {
        "Symbol": "SymbolValue required",
        "Color": "ColorPairID required",
        "Picture": "PictureID required"
      },
      "source": "BargeTokenMap.vb:115-132"
    }
  ],
  "relatedEntities": [
    {
      "entity": "Fleet",
      "relationship": "Many-to-One",
      "foreignKey": "FleetID",
      "description": "BargeTokenMap belongs to a Fleet"
    },
    {
      "entity": "ColorPair",
      "relationship": "Many-to-One",
      "foreignKey": "ColorPairID",
      "nullable": true,
      "description": "Optional color configuration when DisplayType = 'Color'"
    },
    {
      "entity": "Picture",
      "relationship": "Many-to-One",
      "foreignKey": "PictureID",
      "nullable": true,
      "description": "Optional picture when DisplayType = 'Picture'"
    }
  ],
  "migrationNotes": [
    "Hard delete - no IsActive field",
    "Color fields (TextColor, BackColor) stored as string color names, not hex codes",
    "Picture data stored as byte[] in database, joined in search queries",
    "DisplayType acts as discriminator for which additional fields are required",
    "DeferredDelete pattern not needed in modern implementation - use standard Delete",
    "ColorPairID and PictureID stored as string in legacy but should be int? in modern DTO",
    "SymbolValue is a single character (NChar(1) in database)",
    "LocationType is an additional field loaded in GetById, may come from a join",
    "FieldValue max length is 200 characters",
    "IsGenerated flag indicates auto-generated records vs. manually created"
  ],
  "csprojConfiguration": {
    "embeddedResourcePattern": "**/*.sql",
    "itemGroup": "<EmbeddedResource Include=\"DataAccess\\Sql\\BargeTokenMap\\*.sql\" />"
  }
}
