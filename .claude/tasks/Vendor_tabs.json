{
  "formName": "frmVendorDetail",
  "tabControl": "tabMain",
  "tabs": [
    {
      "tabName": "Details",
      "tabText": "&1 - Details",
      "order": 1,
      "defaultActive": true,
      "purpose": "Primary vendor information and contacts",
      "controls": [
        {
          "name": "txtName",
          "type": "UltraTextEditor",
          "label": "Name",
          "required": true,
          "section": "Vendor Information"
        },
        {
          "name": "txtLongName",
          "type": "UltraTextEditor",
          "label": "Long Name",
          "required": false,
          "section": "Vendor Information"
        },
        {
          "name": "txtAccountingCode",
          "type": "UltraTextEditor",
          "label": "Accounting Code",
          "required": false,
          "section": "Vendor Information"
        },
        {
          "name": "chkIsActive",
          "type": "UltraCheckEditor",
          "label": "Is Active",
          "required": false,
          "section": "Vendor Information"
        },
        {
          "name": "txtAddress",
          "type": "UltraTextEditor",
          "label": "Address",
          "required": false,
          "section": "Address Information"
        },
        {
          "name": "txtCity",
          "type": "UltraTextEditor",
          "label": "City",
          "required": false,
          "section": "Address Information"
        },
        {
          "name": "cboState",
          "type": "UltraCombo",
          "label": "State",
          "required": false,
          "section": "Address Information"
        },
        {
          "name": "txtZip",
          "type": "UltraTextEditor",
          "label": "Zip",
          "required": false,
          "section": "Address Information",
          "validationType": "ZipCodeOptionalExtention"
        },
        {
          "name": "txtPhoneNumber",
          "type": "UltraTextEditor",
          "label": "Phone Number",
          "required": false,
          "section": "Contact Information",
          "validationType": "Phone10"
        },
        {
          "name": "txtFaxNumber",
          "type": "UltraTextEditor",
          "label": "Fax Number",
          "required": false,
          "section": "Contact Information",
          "validationType": "Phone10"
        },
        {
          "name": "txtEmailAddress",
          "type": "UltraTextEditor",
          "label": "Email Address",
          "required": false,
          "section": "Contact Information",
          "validationType": "Email"
        },
        {
          "name": "chkIsLiquidBroker",
          "type": "UltraCheckEditor",
          "label": "Is Liquid Broker",
          "required": false,
          "section": "Vendor Flags",
          "visibilityCondition": "LicenseComponent.UnitTow"
        },
        {
          "name": "chkIsTankerman",
          "type": "UltraCheckEditor",
          "label": "Is Tankerman",
          "required": false,
          "section": "Vendor Flags",
          "visibilityCondition": "LicenseComponent.UnitTow"
        },
        {
          "name": "chkIsInternalVendor",
          "type": "UltraCheckEditor",
          "label": "Is Internal Vendor",
          "required": false,
          "section": "Vendor Flags"
        },
        {
          "name": "cboTermsCode",
          "type": "UltraCombo",
          "label": "Payment Terms",
          "required": false,
          "section": "Billing Information",
          "validationListType": "VendorBillTermsCode"
        }
      ],
      "sections": [
        {
          "name": "Vendor Information",
          "controls": ["txtName", "txtLongName", "txtAccountingCode", "chkIsActive"]
        },
        {
          "name": "Address Information",
          "controls": ["txtAddress", "txtCity", "cboState", "txtZip"]
        },
        {
          "name": "Contact Information",
          "controls": ["txtPhoneNumber", "txtFaxNumber", "txtEmailAddress"]
        },
        {
          "name": "Vendor Flags",
          "controls": ["chkIsLiquidBroker", "chkIsTankerman", "chkIsInternalVendor"]
        },
        {
          "name": "Billing Information",
          "controls": ["cboTermsCode"]
        }
      ],
      "hasGrid": true,
      "grid": {
        "name": "grdContacts",
        "childEntity": "VendorContact",
        "parentKey": "VendorID",
        "operations": ["Add", "Modify", "Remove", "Export"],
        "toolbar": "ContactsToolbarManager",
        "columns": [
          {
            "key": "Name",
            "header": "Name",
            "type": "String"
          },
          {
            "key": "IsPrimary",
            "header": "Primary",
            "type": "Boolean"
          },
          {
            "key": "IsDispatcher",
            "header": "Dispatcher",
            "type": "Boolean"
          },
          {
            "key": "IsLiquidBroker",
            "header": "Liquid Broker",
            "type": "Boolean",
            "visibilityCondition": "LicenseComponent.UnitTow"
          },
          {
            "key": "PhoneNumber",
            "header": "Phone",
            "type": "String"
          },
          {
            "key": "PhoneExt",
            "header": "Ext",
            "type": "String"
          },
          {
            "key": "EmailAddress",
            "header": "Email",
            "type": "String"
          }
        ],
        "detailSection": {
          "groupName": "grpContact",
          "controls": [
            {
              "name": "txtContactName",
              "type": "UltraTextEditor",
              "label": "Name",
              "required": true,
              "validationType": "String"
            },
            {
              "name": "txtContactPhoneNumber",
              "type": "UltraTextEditor",
              "label": "Phone Number",
              "required": false,
              "validationType": "Phone10"
            },
            {
              "name": "txtContactPhoneExt",
              "type": "UltraTextEditor",
              "label": "Ext",
              "required": false,
              "validationType": "String"
            },
            {
              "name": "txtContactEmailAddress",
              "type": "UltraTextEditor",
              "label": "Email",
              "required": false,
              "validationType": "Email"
            },
            {
              "name": "txtContactFaxNumber",
              "type": "UltraTextEditor",
              "label": "Fax Number",
              "required": false,
              "validationType": "Phone10"
            },
            {
              "name": "chkIsPrimary",
              "type": "UltraCheckEditor",
              "label": "Primary contact",
              "required": false
            },
            {
              "name": "chkContactIsDispatcher",
              "type": "UltraCheckEditor",
              "label": "Dispatcher",
              "required": false
            },
            {
              "name": "chkContactIsLiquidBroker",
              "type": "UltraCheckEditor",
              "label": "Liquid broker",
              "required": false,
              "visibilityCondition": "LicenseComponent.UnitTow"
            }
          ],
          "buttons": [
            {
              "name": "btnSet",
              "text": "S&et",
              "action": "Save contact"
            },
            {
              "name": "btnCancelEdit",
              "text": "Ca&ncel",
              "action": "Cancel contact edit"
            }
          ]
        }
      }
    },
    {
      "tabName": "Portal",
      "tabText": "&2 - Portal",
      "order": 2,
      "purpose": "Vendor portal configuration and user groups",
      "controls": [
        {
          "name": "chkEnablePortal",
          "type": "UltraCheckEditor",
          "label": "Enable Portal",
          "required": false,
          "section": "Portal Settings"
        }
      ],
      "sections": [
        {
          "name": "Portal Settings",
          "controls": ["chkEnablePortal"]
        }
      ],
      "hasGrid": true,
      "grid": {
        "name": "grdPortalGroups",
        "childEntity": "VendorPortalGroup",
        "parentKey": "VendorID",
        "operations": ["Add", "Modify", "Remove", "Copy", "Export"],
        "toolbar": "PortalToolbarManager",
        "columns": [
          {
            "key": "Name",
            "header": "Name",
            "type": "String"
          },
          {
            "key": "EventHistoryDays",
            "header": "Event History Days",
            "type": "Integer"
          },
          {
            "key": "LimitBargeEvents",
            "header": "Limit Events",
            "type": "Boolean"
          },
          {
            "key": "LimitDestinations",
            "header": "Limit Destinations",
            "type": "Boolean"
          },
          {
            "key": "LimitCustomers",
            "header": "Limit Customers",
            "type": "Boolean"
          },
          {
            "key": "IsActive",
            "header": "Active",
            "type": "Boolean"
          }
        ],
        "notes": "Opens frmVendorPortalGroup modal dialog for Add/Modify/Copy operations"
      },
      "tabLogic": {
        "visibilityCondition": "LicenseComponent.Portal is active",
        "enabledCondition": "chkEnablePortal.Checked"
      }
    },
    {
      "tabName": "VendorBusinessUnits",
      "tabText": "&3 - Vendor Business Units",
      "order": 3,
      "purpose": "Track vendor business unit locations and fuel supplier information",
      "controls": [],
      "sections": [],
      "hasGrid": true,
      "grid": {
        "name": "grdVendorBusinessUnits",
        "childEntity": "VendorBusinessUnit",
        "parentKey": "VendorID",
        "operations": ["Add", "Modify", "Remove", "Export"],
        "toolbar": "VendorBusinessUnitsToolbarManager",
        "columns": [
          {
            "key": "Name",
            "header": "Name",
            "type": "String"
          },
          {
            "key": "AccountingCode",
            "header": "Accounting #",
            "type": "String"
          },
          {
            "key": "River",
            "header": "River",
            "type": "String"
          },
          {
            "key": "Mile",
            "header": "Mile",
            "type": "Decimal"
          },
          {
            "key": "Bank",
            "header": "Bank",
            "type": "String"
          },
          {
            "key": "IsFuelSupplier",
            "header": "Fuel Supplier",
            "type": "Boolean"
          },
          {
            "key": "IsDefaultFuelSupplier",
            "header": "Default",
            "type": "Boolean"
          },
          {
            "key": "IsBoatAssistSupplier",
            "header": "Boat Assist",
            "type": "Boolean"
          },
          {
            "key": "IsActive",
            "header": "Active",
            "type": "Boolean"
          }
        ],
        "detailSection": {
          "groupName": "grpVendorBusinessUnit",
          "controls": [
            {
              "name": "txtVbuName",
              "type": "UltraTextEditor",
              "label": "Name",
              "required": true,
              "validationType": "String"
            },
            {
              "name": "txtVbuAccountingCode",
              "type": "UltraTextEditor",
              "label": "Accounting Code",
              "required": false,
              "validationType": "String"
            },
            {
              "name": "chkVbuIsActive",
              "type": "UltraCheckEditor",
              "label": "Is Active",
              "required": false
            },
            {
              "name": "cboRiver",
              "type": "UltraCombo",
              "label": "River",
              "required": false,
              "dataSource": "RiverList"
            },
            {
              "name": "txtMile",
              "type": "UltraTextEditor",
              "label": "Mile",
              "required": false,
              "validationType": "Decimal"
            },
            {
              "name": "cboBank",
              "type": "UltraCombo",
              "label": "Bank",
              "required": false,
              "validationListType": "RiverBank"
            },
            {
              "name": "chkIsFuelSupplier",
              "type": "UltraCheckEditor",
              "label": "Fuel Supplier",
              "required": false
            },
            {
              "name": "chkIsDefaultFuelSupplier",
              "type": "UltraCheckEditor",
              "label": "Default Fuel Supplier",
              "required": false,
              "enabledCondition": "chkIsFuelSupplier.Checked"
            },
            {
              "name": "txtMinDiscountQty",
              "type": "UltraTextEditor",
              "label": "Min Discount Qty",
              "required": false,
              "enabledCondition": "chkIsFuelSupplier.Checked"
            },
            {
              "name": "cboMinDiscountFrequency",
              "type": "UltraCombo",
              "label": "Min Discount Frequency",
              "required": false,
              "dataSource": "GetFrequencyList (Weekly, Monthly, Quarterly, Yearly)",
              "enabledCondition": "chkIsFuelSupplier.Checked"
            },
            {
              "name": "chkIsBoatAssistSupplier",
              "type": "UltraCheckEditor",
              "label": "Boat Assist Supplier",
              "required": false
            }
          ],
          "buttons": [
            {
              "name": "btnVbuSet",
              "text": "S&et",
              "action": "Save vendor business unit"
            },
            {
              "name": "btnVbuCancel",
              "text": "Ca&ncel",
              "action": "Cancel vendor business unit edit"
            }
          ]
        }
      }
    },
    {
      "tabName": "BargeExSettings",
      "tabText": "&4 - BargeEx Settings",
      "order": 4,
      "purpose": "BargeEx integration configuration",
      "controls": [
        {
          "name": "chkIsBargeExEnabled",
          "type": "UltraCheckEditor",
          "label": "BargeEx Enabled",
          "required": false,
          "section": "BargeEx Configuration"
        },
        {
          "name": "txtBargeExTradingPartnerNum",
          "type": "UltraTextEditor",
          "label": "Trading Partner Number",
          "required": false,
          "section": "BargeEx Configuration",
          "enabledCondition": "chkIsBargeExEnabled.Checked"
        },
        {
          "name": "cboBargeExConfigID",
          "type": "UltraCombo",
          "label": "Config ID",
          "required": false,
          "section": "BargeEx Configuration",
          "enabledCondition": "chkIsBargeExEnabled.Checked",
          "dataSource": "BargeExConfigSearch"
        }
      ],
      "sections": [
        {
          "name": "BargeEx Configuration",
          "controls": ["chkIsBargeExEnabled", "txtBargeExTradingPartnerNum", "cboBargeExConfigID"]
        }
      ],
      "tabLogic": {
        "visibilityCondition": "GlobalSettingList.EnableBargeExBargeLineSupport is true"
      }
    }
  ],
  "sharedControls": {
    "location": "Bottom of form (outside tabs)",
    "controls": [
      {
        "name": "chkIsActive",
        "type": "UltraCheckEditor",
        "text": "Is Active",
        "action": "Toggle vendor active status"
      },
      {
        "name": "btnSubmit",
        "type": "Button",
        "text": "Submit",
        "action": "Save all changes and close form"
      },
      {
        "name": "btnCancel",
        "type": "Button",
        "text": "Cancel",
        "action": "Cancel all changes and close form"
      }
    ]
  },
  "tabLogic": {
    "conditionalVisibility": [
      {
        "tab": "Portal",
        "condition": "LicenseList(Licenses.LicenseComponent.Portal).Active",
        "reason": "Portal functionality requires Portal license"
      },
      {
        "tab": "BargeExSettings",
        "condition": "Lists.GlobalSettingList.EnableBargeExBargeLineSupport",
        "reason": "BargeEx settings only visible when global setting enabled"
      }
    ],
    "conditionalEnabling": [
      {
        "tab": "Portal",
        "condition": "Not isEditing (child entity)",
        "reason": "Portal tab disabled while editing child entities on other tabs"
      },
      {
        "tab": "Details",
        "condition": "Not isEditing (VendorBusinessUnit)",
        "reason": "Details tab disabled while editing VendorBusinessUnit"
      },
      {
        "tab": "VendorBusinessUnits",
        "condition": "Not isEditing (VendorContact)",
        "reason": "VendorBusinessUnits tab disabled while editing VendorContact"
      },
      {
        "tab": "BargeExSettings",
        "condition": "Not isEditing (child entity)",
        "reason": "BargeEx tab disabled while editing child entities"
      }
    ],
    "loadSequence": [
      {
        "order": 1,
        "tab": "All tabs",
        "action": "Load primary Vendor entity data on form load"
      },
      {
        "order": 2,
        "tab": "Details",
        "action": "Load VendorContacts collection into grdContacts"
      },
      {
        "order": 3,
        "tab": "Portal",
        "action": "Load VendorPortalGroups via VendorPortalGroupSearch.GetList"
      },
      {
        "order": 4,
        "tab": "VendorBusinessUnits",
        "action": "Load VendorBusinessUnits collection into grdVendorBusinessUnits"
      }
    ],
    "businessRules": [
      {
        "rule": "Only one VendorContact can have IsPrimary = true",
        "enforcement": "When setting IsPrimary, all other contacts are set to false"
      },
      {
        "rule": "Only one VendorBusinessUnit can have IsDefaultFuelSupplier = true",
        "enforcement": "When setting IsDefaultFuelSupplier, all other business units are set to false"
      },
      {
        "rule": "Portal groups require saved vendor",
        "enforcement": "Prompt to save unsaved changes before opening portal group modal"
      },
      {
        "rule": "Deleting contact with PortalUserID deletes portal account",
        "enforcement": "Show warning dialog before allowing deletion"
      },
      {
        "rule": "BargeEx fields cleared when disabled",
        "enforcement": "ClearUnusedFields() method clears BargeEx fields when chkIsBargeExEnabled is false"
      }
    ]
  },
  "toolbarButtons": [
    {
      "toolbar": "ContactsToolbarManager",
      "buttons": [
        {
          "key": "Add",
          "caption": "Add",
          "buttonType": "Add",
          "action": "ItemAdd(grdContacts, False)"
        },
        {
          "key": "Modify",
          "caption": "Modify",
          "buttonType": "Open",
          "action": "ItemModify(grdContacts)",
          "enabledCondition": "Row selected"
        },
        {
          "key": "Remove",
          "caption": "Remove",
          "buttonType": "Remove",
          "action": "ItemRemove(grdContacts)",
          "enabledCondition": "Row selected"
        },
        {
          "key": "ExportContacts",
          "caption": "Export",
          "buttonType": "Open",
          "action": "Main.ExportGrid(grdContacts)",
          "enabledCondition": "At least one row"
        }
      ]
    },
    {
      "toolbar": "PortalToolbarManager",
      "buttons": [
        {
          "key": "AddPortalGroup",
          "caption": "Add",
          "buttonType": "Add",
          "action": "ItemAdd(grdPortalGroups, False) - Opens frmVendorPortalGroup"
        },
        {
          "key": "ModifyPortalGroup",
          "caption": "Modify",
          "buttonType": "Open",
          "action": "ItemModify(grdPortalGroups) - Opens frmVendorPortalGroup",
          "enabledCondition": "Row selected"
        },
        {
          "key": "RemovePortalGroup",
          "caption": "Remove",
          "buttonType": "Remove",
          "action": "VendorPortalGroup.DeleteVendorPortalGroup",
          "enabledCondition": "Row selected"
        },
        {
          "key": "CopyPortalGroup",
          "caption": "Copy",
          "buttonType": "Add",
          "action": "ItemAdd(grdPortalGroups, True) - Opens frmVendorPortalGroup with copy flag",
          "enabledCondition": "Row selected"
        },
        {
          "key": "ExportPortalGroup",
          "caption": "Export",
          "buttonType": "Open",
          "action": "Main.ExportGrid(grdPortalGroups)",
          "enabledCondition": "At least one row"
        }
      ]
    },
    {
      "toolbar": "VendorBusinessUnitsToolbarManager",
      "buttons": [
        {
          "key": "AddVbu",
          "caption": "Add",
          "buttonType": "Add",
          "action": "ItemAdd(grdVendorBusinessUnits, False)"
        },
        {
          "key": "ModifyVbu",
          "caption": "Modify",
          "buttonType": "Open",
          "action": "ItemModify(grdVendorBusinessUnits)",
          "enabledCondition": "Row selected"
        },
        {
          "key": "RemoveVbu",
          "caption": "Remove",
          "buttonType": "Remove",
          "action": "ItemRemove(grdVendorBusinessUnits)",
          "enabledCondition": "Row selected"
        },
        {
          "key": "ExportVbu",
          "caption": "Export",
          "buttonType": "Open",
          "action": "Main.ExportGrid(grdVendorBusinessUnits)",
          "enabledCondition": "At least one row"
        }
      ]
    }
  ]
}
