{
  "entity": "River",
  "formValidation": {
    "method": "ValidatorExtender",
    "description": "River form uses ValidatorExtender for client-side validation instead of AreFieldsValid method",
    "rules": [
      {
        "field": "txtName",
        "property": "Name",
        "validationType": "String",
        "rule": "String validation",
        "maxLength": 40,
        "severity": "Error",
        "clientSide": true
      },
      {
        "field": "txtCode",
        "property": "Code",
        "validationType": "Custom",
        "rule": "Custom RegEx",
        "regex": "\\w{3}",
        "message": "Abbreviation must be exactly 3 characters long.",
        "maxLength": 3,
        "severity": "Error",
        "clientSide": true
      },
      {
        "field": "txtBargeExCode",
        "property": "BargeExCode",
        "validationType": "String",
        "rule": "String validation",
        "maxLength": 10,
        "severity": "Error",
        "clientSide": true
      },
      {
        "field": "txtStartMile",
        "property": "StartMile",
        "validationType": "Decimal",
        "rule": "Decimal validation",
        "decimalPlaces": 2,
        "roundingMethod": "Nearest",
        "precision": 0.01,
        "severity": "Error",
        "clientSide": true
      },
      {
        "field": "txtEndMile",
        "property": "EndMile",
        "validationType": "Decimal",
        "rule": "Decimal validation",
        "decimalPlaces": 2,
        "roundingMethod": "Nearest",
        "precision": 0.01,
        "severity": "Error",
        "clientSide": true
      },
      {
        "field": "txtUpLabel",
        "property": "UpLabel",
        "validationType": "String",
        "rule": "String validation",
        "maxLength": 20,
        "severity": "Error",
        "clientSide": true
      },
      {
        "field": "txtDownLabel",
        "property": "DownLabel",
        "validationType": "String",
        "rule": "String validation",
        "maxLength": 20,
        "severity": "Error",
        "clientSide": true
      }
    ]
  },
  "businessValidation": {
    "method": "CheckBusinessRules",
    "location": "River.vb:162-203, RiverBase.vb:345-389",
    "rules": [
      {
        "ruleName": "NameRequired",
        "property": "Name",
        "displayName": "Waterway name",
        "condition": "String.IsNullOrEmpty(p_Name)",
        "message": "Waterway name is required.",
        "severity": "Error",
        "alwaysApplies": true,
        "source": "RiverBase.vb:350-352"
      },
      {
        "ruleName": "NameMaxLength",
        "property": "Name",
        "displayName": "Waterway name",
        "condition": "(p_Name.Length > MaxLength.Name)",
        "message": "Waterway name cannot exceed 40 characters.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 40,
        "source": "RiverBase.vb:353-355"
      },
      {
        "ruleName": "CodeRequired",
        "property": "Code",
        "displayName": "Code",
        "condition": "String.IsNullOrEmpty(p_Code)",
        "message": "Code is required.",
        "severity": "Error",
        "alwaysApplies": true,
        "source": "RiverBase.vb:359-360"
      },
      {
        "ruleName": "CodeMaxLength",
        "property": "Code",
        "displayName": "Code",
        "condition": "(p_Code.Length > MaxLength.Code)",
        "message": "Code cannot exceed 3 characters.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 3,
        "source": "RiverBase.vb:361-363"
      },
      {
        "ruleName": "CodeMinLength",
        "property": "Code",
        "displayName": "Code",
        "condition": "(p_Code.Length <> 3)",
        "message": "Code must be exactly 3 characters.",
        "severity": "Error",
        "alwaysApplies": true,
        "exactLength": 3,
        "source": "River.vb:198-200"
      },
      {
        "ruleName": "BargeExCodeMaxLength",
        "property": "BargeExCode",
        "displayName": "BargeExCode",
        "condition": "(p_BargeExCode.Length > MaxLength.BargeExCode)",
        "message": "BargeExCode cannot exceed 10 characters.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 10,
        "source": "RiverBase.vb:366-369"
      },
      {
        "ruleName": "StartMileEndMileComparison",
        "property": "IsLowToHighDirection",
        "displayName": "Direction",
        "relatedProperties": ["StartMile", "EndMile"],
        "condition": "((p_StartMile <> String.Empty) AndAlso (p_EndMile <> String.Empty) AndAlso (CType(p_StartMile, Decimal) > CType(p_EndMile, Decimal)))",
        "message": "Start mile must be less than or equal to End mile",
        "severity": "Error",
        "alwaysApplies": false,
        "appliesWhen": "Both StartMile and EndMile have values",
        "source": "River.vb:169-175"
      },
      {
        "ruleName": "StartMileNonnegative",
        "property": "StartMile",
        "displayName": "Start mile",
        "condition": "(Not String.IsNullOrEmpty(p_StartMile) AndAlso CInt(p_StartMile) < 0)",
        "message": "Start mile must be greater than or equal to 0.",
        "severity": "Error",
        "alwaysApplies": false,
        "appliesWhen": "StartMile has a value",
        "source": "River.vb:178-182"
      },
      {
        "ruleName": "StartMileReasonableNumber",
        "property": "StartMile",
        "displayName": "Start Mile",
        "condition": "(p_StartMile <> String.Empty) AndAlso (CType(p_StartMile, Decimal) > 5000.0)",
        "message": "[value] is not a reasonable value for Start mile",
        "severity": "Error",
        "alwaysApplies": false,
        "appliesWhen": "StartMile has a value",
        "maxValue": 5000.0,
        "source": "River.vb:185-187"
      },
      {
        "ruleName": "EndMileReasonableNumber",
        "property": "EndMile",
        "displayName": "End Mile",
        "condition": "(p_EndMile <> String.Empty) AndAlso (CType(p_EndMile, Decimal) > 5000.0)",
        "message": "[value] is not a reasonable value for End mile",
        "severity": "Error",
        "alwaysApplies": false,
        "appliesWhen": "EndMile has a value",
        "maxValue": 5000.0,
        "source": "River.vb:190-194"
      },
      {
        "ruleName": "UpLabelRequired",
        "property": "UpLabel",
        "displayName": "Upstream",
        "condition": "String.IsNullOrEmpty(p_UpLabel)",
        "message": "Upstream is required.",
        "severity": "Error",
        "alwaysApplies": true,
        "source": "RiverBase.vb:373-374"
      },
      {
        "ruleName": "UpLabelMaxLength",
        "property": "UpLabel",
        "displayName": "Upstream",
        "condition": "(p_UpLabel.Length > MaxLength.UpLabel)",
        "message": "Upstream cannot exceed 20 characters.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 20,
        "source": "RiverBase.vb:375-377"
      },
      {
        "ruleName": "DownLabelRequired",
        "property": "DownLabel",
        "displayName": "Downstream",
        "condition": "String.IsNullOrEmpty(p_DownLabel)",
        "message": "Downstream is required.",
        "severity": "Error",
        "alwaysApplies": true,
        "source": "RiverBase.vb:381-382"
      },
      {
        "ruleName": "DownLabelMaxLength",
        "property": "DownLabel",
        "displayName": "Downstream",
        "condition": "(p_DownLabel.Length > MaxLength.DownLabel)",
        "message": "Downstream cannot exceed 20 characters.",
        "severity": "Error",
        "alwaysApplies": true,
        "maxLength": 20,
        "source": "RiverBase.vb:383-385"
      }
    ]
  },
  "modernValidationMapping": {
    "dataAnnotations": {
      "description": "Basic validation rules using Data Annotations",
      "examples": [
        {
          "property": "Name",
          "annotations": [
            "[Required(ErrorMessage = \"Waterway name is required.\")]",
            "[StringLength(40, ErrorMessage = \"Waterway name cannot exceed 40 characters.\")]",
            "[Display(Name = \"Waterway name\")]"
          ]
        },
        {
          "property": "Code",
          "annotations": [
            "[Required(ErrorMessage = \"Code is required.\")]",
            "[StringLength(3, MinimumLength = 3, ErrorMessage = \"Code must be exactly 3 characters.\")]",
            "[RegularExpression(@\"\\w{3}\", ErrorMessage = \"Abbreviation must be exactly 3 characters long.\")]",
            "[Display(Name = \"Code\")]"
          ]
        },
        {
          "property": "BargeExCode",
          "annotations": [
            "[StringLength(10, ErrorMessage = \"BargeExCode cannot exceed 10 characters.\")]",
            "[Display(Name = \"BargeEx Code\")]"
          ]
        },
        {
          "property": "StartMile",
          "annotations": [
            "[Range(0, 5000, ErrorMessage = \"Start mile must be between 0 and 5000.\")]",
            "[Display(Name = \"Start mile\")]"
          ]
        },
        {
          "property": "EndMile",
          "annotations": [
            "[Range(0, 5000, ErrorMessage = \"End mile must be between 0 and 5000.\")]",
            "[Display(Name = \"End mile\")]"
          ]
        },
        {
          "property": "UpLabel",
          "annotations": [
            "[Required(ErrorMessage = \"Upstream is required.\")]",
            "[StringLength(20, ErrorMessage = \"Upstream cannot exceed 20 characters.\")]",
            "[Display(Name = \"Upstream\")]"
          ]
        },
        {
          "property": "DownLabel",
          "annotations": [
            "[Required(ErrorMessage = \"Downstream is required.\")]",
            "[StringLength(20, ErrorMessage = \"Downstream cannot exceed 20 characters.\")]",
            "[Display(Name = \"Downstream\")]"
          ]
        }
      ]
    },
    "fluentValidation": {
      "description": "Complex validation rules using FluentValidation",
      "validatorClass": "RiverValidator",
      "examples": [
        {
          "rule": "Name validation",
          "code": "RuleFor(x => x.Name)\n    .NotEmpty()\n    .WithMessage(\"Waterway name is required.\")\n    .MaximumLength(40)\n    .WithMessage(\"Waterway name cannot exceed 40 characters.\");"
        },
        {
          "rule": "Code validation",
          "code": "RuleFor(x => x.Code)\n    .NotEmpty()\n    .WithMessage(\"Code is required.\")\n    .Length(3, 3)\n    .WithMessage(\"Code must be exactly 3 characters.\")\n    .Matches(@\"\\w{3}\")\n    .WithMessage(\"Abbreviation must be exactly 3 characters long.\");"
        },
        {
          "rule": "BargeExCode validation",
          "code": "RuleFor(x => x.BargeExCode)\n    .MaximumLength(10)\n    .WithMessage(\"BargeExCode cannot exceed 10 characters.\")\n    .When(x => !string.IsNullOrEmpty(x.BargeExCode));"
        },
        {
          "rule": "StartMile validation",
          "code": "RuleFor(x => x.StartMile)\n    .GreaterThanOrEqualTo(0)\n    .WithMessage(\"Start mile must be greater than or equal to 0.\")\n    .LessThanOrEqualTo(5000)\n    .WithMessage(\"{PropertyValue} is not a reasonable value for Start mile\")\n    .When(x => x.StartMile.HasValue);"
        },
        {
          "rule": "EndMile validation",
          "code": "RuleFor(x => x.EndMile)\n    .LessThanOrEqualTo(5000)\n    .WithMessage(\"{PropertyValue} is not a reasonable value for End mile\")\n    .When(x => x.EndMile.HasValue);"
        },
        {
          "rule": "StartMile/EndMile comparison",
          "code": "RuleFor(x => x.StartMile)\n    .LessThanOrEqualTo(x => x.EndMile)\n    .WithMessage(\"Start mile must be less than or equal to End mile\")\n    .When(x => x.StartMile.HasValue && x.EndMile.HasValue);"
        },
        {
          "rule": "UpLabel validation",
          "code": "RuleFor(x => x.UpLabel)\n    .NotEmpty()\n    .WithMessage(\"Upstream is required.\")\n    .MaximumLength(20)\n    .WithMessage(\"Upstream cannot exceed 20 characters.\");"
        },
        {
          "rule": "DownLabel validation",
          "code": "RuleFor(x => x.DownLabel)\n    .NotEmpty()\n    .WithMessage(\"Downstream is required.\")\n    .MaximumLength(20)\n    .WithMessage(\"Downstream cannot exceed 20 characters.\");"
        }
      ]
    },
    "jqueryValidate": {
      "description": "Client-side validation using jquery.validate",
      "examples": [
        {
          "field": "Name",
          "rules": {
            "required": true,
            "maxlength": 40
          },
          "messages": {
            "required": "Waterway name is required.",
            "maxlength": "Waterway name cannot exceed 40 characters."
          }
        },
        {
          "field": "Code",
          "rules": {
            "required": true,
            "minlength": 3,
            "maxlength": 3,
            "pattern": "\\w{3}"
          },
          "messages": {
            "required": "Code is required.",
            "minlength": "Code must be exactly 3 characters.",
            "maxlength": "Code must be exactly 3 characters.",
            "pattern": "Abbreviation must be exactly 3 characters long."
          }
        },
        {
          "field": "BargeExCode",
          "rules": {
            "maxlength": 10
          },
          "messages": {
            "maxlength": "BargeExCode cannot exceed 10 characters."
          }
        },
        {
          "field": "StartMile",
          "rules": {
            "number": true,
            "min": 0,
            "max": 5000
          },
          "messages": {
            "number": "Start mile must be a valid number.",
            "min": "Start mile must be greater than or equal to 0.",
            "max": "Start mile is not a reasonable value."
          }
        },
        {
          "field": "EndMile",
          "rules": {
            "number": true,
            "max": 5000
          },
          "messages": {
            "number": "End mile must be a valid number.",
            "max": "End mile is not a reasonable value."
          }
        },
        {
          "field": "UpLabel",
          "rules": {
            "required": true,
            "maxlength": 20
          },
          "messages": {
            "required": "Upstream is required.",
            "maxlength": "Upstream cannot exceed 20 characters."
          }
        },
        {
          "field": "DownLabel",
          "rules": {
            "required": true,
            "maxlength": 20
          },
          "messages": {
            "required": "Downstream is required.",
            "maxlength": "Downstream cannot exceed 20 characters."
          }
        }
      ],
      "customValidation": {
        "startMileEndMileComparison": "Custom validator to ensure StartMile <= EndMile when both have values"
      }
    }
  },
  "validationPatterns": {
    "requiredFields": [
      "Name (Waterway name)",
      "Code (3 characters exactly)",
      "UpLabel (Upstream)",
      "DownLabel (Downstream)"
    ],
    "optionalFields": [
      "BargeExCode",
      "StartMile",
      "EndMile",
      "IsLowToHighDirection",
      "IsActive"
    ],
    "formatValidations": [
      {
        "field": "Code",
        "format": "Exactly 3 alphanumeric characters",
        "regex": "\\w{3}"
      },
      {
        "field": "StartMile",
        "format": "Decimal with 2 decimal places, rounded to nearest 0.01",
        "type": "Decimal"
      },
      {
        "field": "EndMile",
        "format": "Decimal with 2 decimal places, rounded to nearest 0.01",
        "type": "Decimal"
      }
    ],
    "rangeValidations": [
      {
        "field": "StartMile",
        "min": 0,
        "max": 5000,
        "message": "Must be between 0 and 5000"
      },
      {
        "field": "EndMile",
        "max": 5000,
        "message": "Must not exceed 5000"
      }
    ],
    "crossFieldValidations": [
      {
        "fields": ["StartMile", "EndMile"],
        "rule": "StartMile must be less than or equal to EndMile",
        "condition": "Only when both fields have values"
      }
    ],
    "defaultValues": [
      {
        "field": "IsLowToHighDirection",
        "defaultValue": true,
        "description": "Direction checkbox defaults to checked"
      },
      {
        "field": "IsActive",
        "defaultValue": true,
        "description": "Active checkbox defaults to checked"
      }
    ]
  },
  "validationTriggers": {
    "clientSide": [
      "ValidatorExtender triggers validation on control validated events",
      "Custom regex validation for Code field",
      "Type validation (String, Decimal) on input fields"
    ],
    "serverSide": [
      "CheckBusinessRules called on property setter (when value changes)",
      "CheckBusinessRules called on Initialize (validates entire object)",
      "Validation occurs before Save operations"
    ]
  },
  "notes": [
    "River form does not use AreFieldsValid method - validation is handled through ValidatorExtender and business object CheckBusinessRules",
    "Code field has dual validation: client-side regex and server-side exact length check",
    "StartMile and EndMile are formatted with 2 decimal places and rounded to nearest 0.01",
    "Cross-field validation between StartMile and EndMile only applies when both have values",
    "Default values are set in Initialize method for IsLowToHighDirection (true) and IsActive (true)",
    "Display names are overridden in Initialize method for user-friendly error messages",
    "Code field is converted to uppercase on validated event (line 158 in frmRiverDetail.vb)"
  ]
}
